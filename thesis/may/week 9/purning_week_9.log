nohup: ignoring input
Could not save font_manager cache [Errno 122] Disk quota exceeded
Device running: cuda
Namespace(n_neurons=150, n_layers=6, epochs=200, batchsize=2048, lr=5e-05, no_decay=False, decay_rate=0.8, decay_at_interval=True, decay_interval=15, datapath='Teardrop_Gaussian.vti', outpath='./models/', exp_path='../logs/', modified_data_path='./data/', dataset_name='3d_data', vti_name='predicted.vti', vti_path='./data/')

Learning Rate: 5e-05
Batch Size: 2048
Decay Rate: 0.8
Max Epochs: 200
Number of Neurons per Layer: 150
Number of Layers (including input/output): 8
Data Path: Teardrop_Gaussian.vti
Output Path: ./models/
Dataset Name: 3d_data
Vti Name: predicted.vti
train_3d_data_6rb_150n_2048bs_5e-05lr_Truedecay_0.8dr_decayingAtInterval15
Decay: True
Extracting variables from path: Teardrop_Gaussian.vti

n_pts: 262144 dim: (64, 64, 64) n_dim: 3 total_arr: 2
Total Variables: 2
Univariate: False
Coordinates Shape: (262144, 3)
Values Shape: (262144, 2)
161.9956817626953
Dataset Name: 3d_data
Total Variables: 2
Variables Name: ['Average', 'Standard_Deviation']

Total Points in Data: 262144
Dimension of the Dataset: (64, 64, 64)
Number of Dimensions: 3
Coordinate Tensor Shape: torch.Size([262144, 3])
Scalar means Values Tensor Shape: torch.Size([262144])
Scalar stds Values Tensor Shape: torch.Size([262144])

###### Data setup is complete, now starting training ######

MyResidualSirenNet(
  (net_layers): ModuleList(
    (0): SineLayer(
      (linear): Linear(in_features=3, out_features=150, bias=True)
    )
    (1-6): 6 x ResidualSineLayer(
      (linear_1): Linear(in_features=150, out_features=150, bias=True)
      (linear_2): Linear(in_features=150, out_features=150, bias=True)
    )
    (7): Linear(in_features=150, out_features=1, bias=True)
  )
)
Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 5e-05
    maximize: False
    weight_decay: 0
)
MSELoss()

Learning Rate: 5e-05
Max Epochs: 200
Batch Size: 2048
Number of Hidden Layers: 6
Number of Neurons per Layer: 150
Decay Rate: 0.8
Rate decays every 15 epochs.

mean 72.78109930426976
RMSE: 0.0004591716122299443
Loading original model from 150_neurons_mean.pth
Initial PSNR (Mean Model): 72.7811
Original model parameters: 272551

--- Starting Iterative Pruning ---

Attempting to prune with ratio: 5%
Original hidden neurons: 150, New hidden neurons: 143 (Pruning 7 neurons)
New pruned model architecture:
MyResidualSirenNet(
  (net_layers): ModuleList(
    (0): SineLayer(
      (linear): Linear(in_features=3, out_features=143, bias=True)
    )
    (1-6): 6 x ResidualSineLayer(
      (linear_1): Linear(in_features=143, out_features=143, bias=True)
      (linear_2): Linear(in_features=143, out_features=143, bias=True)
    )
    (7): Linear(in_features=143, out_features=1, bias=True)
  )
)
New pruned model parameters: 247820
Parameter reduction: 9.07%

--- Fine-tuning pruned model for 100 epochs ---
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:02<04:23,  2.66s/it]Fine-tune Epoch 1/100, Loss: 9.961014e-04, LR: 5.00e-06
  2%|▏         | 2/100 [00:05<04:20,  2.65s/it]Fine-tune Epoch 2/100, Loss: 1.230350e-04, LR: 5.00e-06
  3%|▎         | 3/100 [00:08<04:30,  2.78s/it]Fine-tune Epoch 3/100, Loss: 6.374926e-05, LR: 5.00e-06
  4%|▍         | 4/100 [00:10<04:23,  2.74s/it]Fine-tune Epoch 4/100, Loss: 4.169229e-05, LR: 5.00e-06
  5%|▌         | 5/100 [00:13<04:22,  2.76s/it]Fine-tune Epoch 5/100, Loss: 3.030947e-05, LR: 5.00e-06
  6%|▌         | 6/100 [00:16<04:22,  2.80s/it]Fine-tune Epoch 6/100, Loss: 2.341445e-05, LR: 5.00e-06
  7%|▋         | 7/100 [00:19<04:14,  2.74s/it]Fine-tune Epoch 7/100, Loss: 1.884879e-05, LR: 5.00e-06
  8%|▊         | 8/100 [00:21<04:10,  2.72s/it]Fine-tune Epoch 8/100, Loss: 1.561795e-05, LR: 5.00e-06
  9%|▉         | 9/100 [00:24<04:08,  2.73s/it]Fine-tune Epoch 9/100, Loss: 1.323489e-05, LR: 5.00e-06
 10%|█         | 10/100 [00:27<04:06,  2.74s/it]Fine-tune Epoch 10/100, Loss: 1.142268e-05, LR: 5.00e-06
 11%|█         | 11/100 [00:30<04:02,  2.73s/it]Fine-tune Epoch 11/100, Loss: 9.963357e-06, LR: 5.00e-06
 12%|█▏        | 12/100 [00:32<03:59,  2.72s/it]Fine-tune Epoch 12/100, Loss: 8.794244e-06, LR: 5.00e-06
 13%|█▎        | 13/100 [00:35<03:57,  2.73s/it]Fine-tune Epoch 13/100, Loss: 7.876783e-06, LR: 5.00e-06
 14%|█▍        | 14/100 [00:38<03:56,  2.75s/it]Fine-tune Epoch 14/100, Loss: 7.033710e-06, LR: 5.00e-06
 15%|█▌        | 15/100 [00:41<03:53,  2.75s/it]Fine-tune Epoch 15/100, Loss: 6.398111e-06, LR: 5.00e-06
 16%|█▌        | 16/100 [00:43<03:52,  2.76s/it]Fine-tune Epoch 16/100, Loss: 5.793555e-06, LR: 5.00e-06
 17%|█▋        | 17/100 [00:46<03:50,  2.78s/it]Fine-tune Epoch 17/100, Loss: 5.302020e-06, LR: 5.00e-06
 18%|█▊        | 18/100 [00:49<03:44,  2.73s/it]Fine-tune Epoch 18/100, Loss: 4.858784e-06, LR: 5.00e-06
 19%|█▉        | 19/100 [00:52<03:42,  2.75s/it]Fine-tune Epoch 19/100, Loss: 4.461520e-06, LR: 5.00e-06
 20%|██        | 20/100 [00:54<03:39,  2.74s/it]Fine-tune Epoch 20/100, Loss: 4.153534e-06, LR: 5.00e-06
 21%|██        | 21/100 [00:57<03:38,  2.77s/it]Fine-tune Epoch 21/100, Loss: 3.858591e-06, LR: 5.00e-06
 22%|██▏       | 22/100 [01:00<03:26,  2.65s/it]Fine-tune Epoch 22/100, Loss: 3.595495e-06, LR: 5.00e-06
 23%|██▎       | 23/100 [01:02<03:26,  2.68s/it]Fine-tune Epoch 23/100, Loss: 3.334463e-06, LR: 5.00e-06
 24%|██▍       | 24/100 [01:05<03:25,  2.71s/it]Fine-tune Epoch 24/100, Loss: 3.093949e-06, LR: 5.00e-06
 25%|██▌       | 25/100 [01:08<03:28,  2.78s/it]Fine-tune Epoch 25/100, Loss: 2.947948e-06, LR: 5.00e-06
 26%|██▌       | 26/100 [01:11<03:29,  2.83s/it]Fine-tune Epoch 26/100, Loss: 2.764730e-06, LR: 5.00e-06
 27%|██▋       | 27/100 [01:14<03:27,  2.84s/it]Fine-tune Epoch 27/100, Loss: 2.570702e-06, LR: 5.00e-06
 28%|██▊       | 28/100 [01:17<03:26,  2.87s/it]Fine-tune Epoch 28/100, Loss: 2.442499e-06, LR: 5.00e-06
 29%|██▉       | 29/100 [01:20<03:24,  2.87s/it]Fine-tune Epoch 29/100, Loss: 2.371358e-06, LR: 5.00e-06
 30%|███       | 30/100 [01:22<03:19,  2.85s/it]Fine-tune Epoch 30/100, Loss: 2.224584e-06, LR: 5.00e-06
 31%|███       | 31/100 [01:25<03:16,  2.85s/it]Fine-tune Epoch 31/100, Loss: 2.159584e-06, LR: 5.00e-06
 32%|███▏      | 32/100 [01:28<03:11,  2.81s/it]Fine-tune Epoch 32/100, Loss: 2.017865e-06, LR: 5.00e-06
 33%|███▎      | 33/100 [01:31<03:10,  2.84s/it]Fine-tune Epoch 33/100, Loss: 1.909046e-06, LR: 5.00e-06
 34%|███▍      | 34/100 [01:34<03:02,  2.76s/it]Fine-tune Epoch 34/100, Loss: 1.870879e-06, LR: 5.00e-06
 35%|███▌      | 35/100 [01:36<03:02,  2.80s/it]Fine-tune Epoch 35/100, Loss: 1.910469e-06, LR: 5.00e-06
 36%|███▌      | 36/100 [01:39<02:56,  2.75s/it]Fine-tune Epoch 36/100, Loss: 1.882885e-06, LR: 5.00e-06
 37%|███▋      | 37/100 [01:42<02:56,  2.80s/it]Fine-tune Epoch 37/100, Loss: 1.727000e-06, LR: 5.00e-06
 38%|███▊      | 38/100 [01:45<02:50,  2.74s/it]Fine-tune Epoch 38/100, Loss: 1.698408e-06, LR: 5.00e-06
 39%|███▉      | 39/100 [01:47<02:49,  2.77s/it]Fine-tune Epoch 39/100, Loss: 1.748717e-06, LR: 5.00e-06
 40%|████      | 40/100 [01:50<02:46,  2.77s/it]Fine-tune Epoch 40/100, Loss: 1.596263e-06, LR: 5.00e-06
 41%|████      | 41/100 [01:53<02:45,  2.80s/it]Fine-tune Epoch 41/100, Loss: 1.668807e-06, LR: 5.00e-06
 42%|████▏     | 42/100 [01:56<02:41,  2.79s/it]Fine-tune Epoch 42/100, Loss: 1.485286e-06, LR: 5.00e-06
 43%|████▎     | 43/100 [01:59<02:39,  2.80s/it]Fine-tune Epoch 43/100, Loss: 1.513675e-06, LR: 5.00e-06
 44%|████▍     | 44/100 [02:01<02:34,  2.76s/it]Fine-tune Epoch 44/100, Loss: 1.383358e-06, LR: 5.00e-06
 45%|████▌     | 45/100 [02:04<02:31,  2.76s/it]Fine-tune Epoch 45/100, Loss: 1.456126e-06, LR: 5.00e-06
 46%|████▌     | 46/100 [02:07<02:26,  2.71s/it]Fine-tune Epoch 46/100, Loss: 1.341347e-06, LR: 5.00e-06
 47%|████▋     | 47/100 [02:10<02:26,  2.76s/it]Fine-tune Epoch 47/100, Loss: 1.338600e-06, LR: 5.00e-06
 48%|████▊     | 48/100 [02:12<02:24,  2.77s/it]Fine-tune Epoch 48/100, Loss: 1.283049e-06, LR: 5.00e-06
 49%|████▉     | 49/100 [02:15<02:20,  2.75s/it]Fine-tune Epoch 49/100, Loss: 1.400497e-06, LR: 5.00e-06
 50%|█████     | 50/100 [02:18<02:18,  2.76s/it]Fine-tune Epoch 50/100, Loss: 1.212747e-06, LR: 5.00e-06
 51%|█████     | 51/100 [02:20<02:13,  2.72s/it]Fine-tune Epoch 51/100, Loss: 1.224296e-06, LR: 5.00e-06
 52%|█████▏    | 52/100 [02:23<02:10,  2.73s/it]Fine-tune Epoch 52/100, Loss: 1.397046e-06, LR: 5.00e-06
 53%|█████▎    | 53/100 [02:26<02:09,  2.75s/it]Fine-tune Epoch 53/100, Loss: 1.084623e-06, LR: 5.00e-06
 54%|█████▍    | 54/100 [02:29<02:04,  2.70s/it]Fine-tune Epoch 54/100, Loss: 1.084357e-06, LR: 5.00e-06
 55%|█████▌    | 55/100 [02:31<02:02,  2.71s/it]Fine-tune Epoch 55/100, Loss: 1.171196e-06, LR: 5.00e-06
 56%|█████▌    | 56/100 [02:34<02:00,  2.74s/it]Fine-tune Epoch 56/100, Loss: 1.221524e-06, LR: 5.00e-06
 57%|█████▋    | 57/100 [02:37<01:59,  2.79s/it]Fine-tune Epoch 57/100, Loss: 1.031750e-06, LR: 5.00e-06
 58%|█████▊    | 58/100 [02:40<01:58,  2.82s/it]Fine-tune Epoch 58/100, Loss: 1.106592e-06, LR: 5.00e-06
 59%|█████▉    | 59/100 [02:43<01:57,  2.86s/it]Fine-tune Epoch 59/100, Loss: 1.070564e-06, LR: 5.00e-06
 60%|██████    | 60/100 [02:46<01:54,  2.87s/it]Fine-tune Epoch 60/100, Loss: 9.788023e-07, LR: 5.00e-06
 61%|██████    | 61/100 [02:49<01:50,  2.84s/it]Fine-tune Epoch 61/100, Loss: 1.033604e-06, LR: 5.00e-06
 62%|██████▏   | 62/100 [02:51<01:47,  2.84s/it]Fine-tune Epoch 62/100, Loss: 1.210153e-06, LR: 5.00e-06
 63%|██████▎   | 63/100 [02:54<01:44,  2.81s/it]Fine-tune Epoch 63/100, Loss: 9.420354e-07, LR: 5.00e-06
 64%|██████▍   | 64/100 [02:57<01:40,  2.79s/it]Fine-tune Epoch 64/100, Loss: 1.004577e-06, LR: 5.00e-06
 65%|██████▌   | 65/100 [03:00<01:37,  2.80s/it]Fine-tune Epoch 65/100, Loss: 1.007627e-06, LR: 5.00e-06
 66%|██████▌   | 66/100 [03:02<01:34,  2.79s/it]Fine-tune Epoch 66/100, Loss: 9.247525e-07, LR: 5.00e-06
 67%|██████▋   | 67/100 [03:05<01:31,  2.78s/it]Fine-tune Epoch 67/100, Loss: 8.227535e-07, LR: 5.00e-06
 68%|██████▊   | 68/100 [03:08<01:28,  2.78s/it]Fine-tune Epoch 68/100, Loss: 1.097904e-06, LR: 5.00e-06
 69%|██████▉   | 69/100 [03:11<01:25,  2.77s/it]Fine-tune Epoch 69/100, Loss: 9.058297e-07, LR: 5.00e-06
 70%|███████   | 70/100 [03:13<01:22,  2.74s/it]Fine-tune Epoch 70/100, Loss: 9.684757e-07, LR: 5.00e-06
 71%|███████   | 71/100 [03:16<01:20,  2.77s/it]Fine-tune Epoch 71/100, Loss: 8.074026e-07, LR: 5.00e-06
 72%|███████▏  | 72/100 [03:19<01:16,  2.75s/it]Fine-tune Epoch 72/100, Loss: 9.616967e-07, LR: 5.00e-06
 73%|███████▎  | 73/100 [03:22<01:14,  2.76s/it]Fine-tune Epoch 73/100, Loss: 8.567615e-07, LR: 5.00e-06
 74%|███████▍  | 74/100 [03:25<01:12,  2.77s/it]Fine-tune Epoch 74/100, Loss: 8.065356e-07, LR: 5.00e-06
 75%|███████▌  | 75/100 [03:27<01:08,  2.74s/it]Fine-tune Epoch 75/100, Loss: 9.660035e-07, LR: 5.00e-06
 76%|███████▌  | 76/100 [03:30<01:05,  2.74s/it]Fine-tune Epoch 76/100, Loss: 8.705993e-07, LR: 5.00e-06
 77%|███████▋  | 77/100 [03:33<01:03,  2.74s/it]Fine-tune Epoch 77/100, Loss: 8.050002e-07, LR: 5.00e-06
 78%|███████▊  | 78/100 [03:35<01:00,  2.73s/it]Fine-tune Epoch 78/100, Loss: 9.273508e-07, LR: 5.00e-06
 79%|███████▉  | 79/100 [03:38<00:58,  2.77s/it]Fine-tune Epoch 79/100, Loss: 9.412514e-07, LR: 5.00e-06
 80%|████████  | 80/100 [03:41<00:54,  2.71s/it]Fine-tune Epoch 80/100, Loss: 6.685114e-07, LR: 5.00e-06
 81%|████████  | 81/100 [03:44<00:51,  2.72s/it]Fine-tune Epoch 81/100, Loss: 8.260017e-07, LR: 5.00e-06
 82%|████████▏ | 82/100 [03:46<00:48,  2.71s/it]Fine-tune Epoch 82/100, Loss: 7.794854e-07, LR: 5.00e-06
 83%|████████▎ | 83/100 [03:49<00:45,  2.70s/it]Fine-tune Epoch 83/100, Loss: 7.588825e-07, LR: 5.00e-06
 84%|████████▍ | 84/100 [03:52<00:43,  2.70s/it]Fine-tune Epoch 84/100, Loss: 8.869105e-07, LR: 5.00e-06
 85%|████████▌ | 85/100 [03:54<00:40,  2.72s/it]Fine-tune Epoch 85/100, Loss: 7.383159e-07, LR: 5.00e-06
 86%|████████▌ | 86/100 [03:57<00:38,  2.76s/it]Fine-tune Epoch 86/100, Loss: 8.574273e-07, LR: 5.00e-06
 87%|████████▋ | 87/100 [04:00<00:36,  2.78s/it]Fine-tune Epoch 87/100, Loss: 6.229481e-07, LR: 5.00e-06
 88%|████████▊ | 88/100 [04:03<00:33,  2.77s/it]Fine-tune Epoch 88/100, Loss: 8.515842e-07, LR: 5.00e-06
 89%|████████▉ | 89/100 [04:06<00:30,  2.80s/it]Fine-tune Epoch 89/100, Loss: 9.571752e-07, LR: 5.00e-06
 90%|█████████ | 90/100 [04:08<00:27,  2.77s/it]Fine-tune Epoch 90/100, Loss: 5.758531e-07, LR: 5.00e-06
 91%|█████████ | 91/100 [04:11<00:24,  2.77s/it]Fine-tune Epoch 91/100, Loss: 7.260024e-07, LR: 5.00e-06
 92%|█████████▏| 92/100 [04:14<00:21,  2.72s/it]Fine-tune Epoch 92/100, Loss: 1.007435e-06, LR: 5.00e-06
 93%|█████████▎| 93/100 [04:17<00:19,  2.75s/it]Fine-tune Epoch 93/100, Loss: 5.993851e-07, LR: 5.00e-06
 94%|█████████▍| 94/100 [04:19<00:16,  2.70s/it]Fine-tune Epoch 94/100, Loss: 7.396179e-07, LR: 5.00e-06
 95%|█████████▌| 95/100 [04:22<00:13,  2.74s/it]Fine-tune Epoch 95/100, Loss: 6.837442e-07, LR: 5.00e-06
 96%|█████████▌| 96/100 [04:25<00:10,  2.73s/it]Fine-tune Epoch 96/100, Loss: 7.225171e-07, LR: 5.00e-06
 97%|█████████▋| 97/100 [04:27<00:08,  2.72s/it]Fine-tune Epoch 97/100, Loss: 7.761983e-07, LR: 5.00e-06
 98%|█████████▊| 98/100 [04:30<00:05,  2.74s/it]Fine-tune Epoch 98/100, Loss: 6.293552e-07, LR: 5.00e-06
 99%|█████████▉| 99/100 [04:33<00:02,  2.76s/it]Fine-tune Epoch 99/100, Loss: 7.132531e-07, LR: 5.00e-06
100%|██████████| 100/100 [04:35<00:00,  2.67s/it]100%|██████████| 100/100 [04:35<00:00,  2.76s/it]
Fine-tune Epoch 100/100, Loss: 8.399562e-07, LR: 5.00e-06

Final PSNR after pruning and fine-tuning: 68.9910
Pruning successful! Achieved 68.99 PSNR with 143 hidden neurons.

Attempting to prune with ratio: 10%
Original hidden neurons: 150, New hidden neurons: 135 (Pruning 15 neurons)
New pruned model architecture:
MyResidualSirenNet(
  (net_layers): ModuleList(
    (0): SineLayer(
      (linear): Linear(in_features=3, out_features=135, bias=True)
    )
    (1-6): 6 x ResidualSineLayer(
      (linear_1): Linear(in_features=135, out_features=135, bias=True)
      (linear_2): Linear(in_features=135, out_features=135, bias=True)
    )
    (7): Linear(in_features=135, out_features=1, bias=True)
  )
)
New pruned model parameters: 220996
Parameter reduction: 18.92%

--- Fine-tuning pruned model for 100 epochs ---
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:02<04:35,  2.78s/it]Fine-tune Epoch 1/100, Loss: 6.357610e-03, LR: 5.00e-06
  2%|▏         | 2/100 [00:05<04:29,  2.75s/it]Fine-tune Epoch 2/100, Loss: 7.582369e-04, LR: 5.00e-06
  3%|▎         | 3/100 [00:08<04:32,  2.81s/it]Fine-tune Epoch 3/100, Loss: 3.332787e-04, LR: 5.00e-06
  4%|▍         | 4/100 [00:11<04:26,  2.77s/it]Fine-tune Epoch 4/100, Loss: 2.055212e-04, LR: 5.00e-06
  5%|▌         | 5/100 [00:13<04:17,  2.71s/it]Fine-tune Epoch 5/100, Loss: 1.451847e-04, LR: 5.00e-06
  6%|▌         | 6/100 [00:16<04:14,  2.71s/it]Fine-tune Epoch 6/100, Loss: 1.101711e-04, LR: 5.00e-06
  7%|▋         | 7/100 [00:19<04:13,  2.73s/it]Fine-tune Epoch 7/100, Loss: 8.734458e-05, LR: 5.00e-06
  8%|▊         | 8/100 [00:21<04:11,  2.73s/it]Fine-tune Epoch 8/100, Loss: 7.123232e-05, LR: 5.00e-06
  9%|▉         | 9/100 [00:24<04:09,  2.74s/it]Fine-tune Epoch 9/100, Loss: 5.933788e-05, LR: 5.00e-06
 10%|█         | 10/100 [00:27<04:03,  2.71s/it]Fine-tune Epoch 10/100, Loss: 5.025552e-05, LR: 5.00e-06
 11%|█         | 11/100 [00:30<04:00,  2.71s/it]Fine-tune Epoch 11/100, Loss: 4.307144e-05, LR: 5.00e-06
 12%|█▏        | 12/100 [00:32<03:58,  2.71s/it]Fine-tune Epoch 12/100, Loss: 3.735990e-05, LR: 5.00e-06
 13%|█▎        | 13/100 [00:35<03:57,  2.73s/it]Fine-tune Epoch 13/100, Loss: 3.272131e-05, LR: 5.00e-06
 14%|█▍        | 14/100 [00:38<03:53,  2.72s/it]Fine-tune Epoch 14/100, Loss: 2.885106e-05, LR: 5.00e-06
 15%|█▌        | 15/100 [00:41<04:06,  2.90s/it]Fine-tune Epoch 15/100, Loss: 2.559284e-05, LR: 5.00e-06
 16%|█▌        | 16/100 [00:45<04:36,  3.29s/it]Fine-tune Epoch 16/100, Loss: 2.295399e-05, LR: 5.00e-06
 17%|█▋        | 17/100 [00:50<05:00,  3.62s/it]Fine-tune Epoch 17/100, Loss: 2.058673e-05, LR: 5.00e-06
 18%|█▊        | 18/100 [00:54<05:08,  3.76s/it]Fine-tune Epoch 18/100, Loss: 1.864393e-05, LR: 5.00e-06
 19%|█▉        | 19/100 [00:58<05:15,  3.90s/it]Fine-tune Epoch 19/100, Loss: 1.690354e-05, LR: 5.00e-06
 20%|██        | 20/100 [01:02<05:15,  3.94s/it]Fine-tune Epoch 20/100, Loss: 1.539796e-05, LR: 5.00e-06
 21%|██        | 21/100 [01:06<05:13,  3.97s/it]Fine-tune Epoch 21/100, Loss: 1.411332e-05, LR: 5.00e-06
 22%|██▏       | 22/100 [01:10<05:06,  3.93s/it]Fine-tune Epoch 22/100, Loss: 1.294189e-05, LR: 5.00e-06
 23%|██▎       | 23/100 [01:14<05:00,  3.90s/it]Fine-tune Epoch 23/100, Loss: 1.192628e-05, LR: 5.00e-06
 24%|██▍       | 24/100 [01:18<04:55,  3.89s/it]Fine-tune Epoch 24/100, Loss: 1.099190e-05, LR: 5.00e-06
 25%|██▌       | 25/100 [01:22<04:55,  3.94s/it]Fine-tune Epoch 25/100, Loss: 1.020319e-05, LR: 5.00e-06
 26%|██▌       | 26/100 [01:25<04:50,  3.92s/it]Fine-tune Epoch 26/100, Loss: 9.427969e-06, LR: 5.00e-06
 27%|██▋       | 27/100 [01:29<04:47,  3.93s/it]Fine-tune Epoch 27/100, Loss: 8.767818e-06, LR: 5.00e-06
 28%|██▊       | 28/100 [01:33<04:39,  3.88s/it]Fine-tune Epoch 28/100, Loss: 8.184526e-06, LR: 5.00e-06
 29%|██▉       | 29/100 [01:37<04:33,  3.85s/it]Fine-tune Epoch 29/100, Loss: 7.624702e-06, LR: 5.00e-06
 30%|███       | 30/100 [01:41<04:33,  3.91s/it]Fine-tune Epoch 30/100, Loss: 7.216315e-06, LR: 5.00e-06
 31%|███       | 31/100 [01:45<04:32,  3.95s/it]Fine-tune Epoch 31/100, Loss: 6.711120e-06, LR: 5.00e-06
 32%|███▏      | 32/100 [01:49<04:33,  4.03s/it]Fine-tune Epoch 32/100, Loss: 6.251897e-06, LR: 5.00e-06
 33%|███▎      | 33/100 [01:53<04:24,  3.94s/it]Fine-tune Epoch 33/100, Loss: 5.923073e-06, LR: 5.00e-06
 34%|███▍      | 34/100 [01:57<04:24,  4.01s/it]Fine-tune Epoch 34/100, Loss: 5.586927e-06, LR: 5.00e-06
 35%|███▌      | 35/100 [02:01<04:19,  4.00s/it]Fine-tune Epoch 35/100, Loss: 5.254399e-06, LR: 5.00e-06
 36%|███▌      | 36/100 [02:05<04:15,  4.00s/it]Fine-tune Epoch 36/100, Loss: 4.926518e-06, LR: 5.00e-06
 37%|███▋      | 37/100 [02:09<04:00,  3.81s/it]Fine-tune Epoch 37/100, Loss: 4.767947e-06, LR: 5.00e-06
 38%|███▊      | 38/100 [02:12<03:55,  3.80s/it]Fine-tune Epoch 38/100, Loss: 4.522455e-06, LR: 5.00e-06
 39%|███▉      | 39/100 [02:16<03:55,  3.86s/it]Fine-tune Epoch 39/100, Loss: 4.315438e-06, LR: 5.00e-06
 40%|████      | 40/100 [02:20<03:53,  3.88s/it]Fine-tune Epoch 40/100, Loss: 4.083913e-06, LR: 5.00e-06
 41%|████      | 41/100 [02:24<03:50,  3.91s/it]Fine-tune Epoch 41/100, Loss: 3.924772e-06, LR: 5.00e-06
 42%|████▏     | 42/100 [02:28<03:53,  4.03s/it]Fine-tune Epoch 42/100, Loss: 3.682991e-06, LR: 5.00e-06
 43%|████▎     | 43/100 [02:32<03:48,  4.00s/it]Fine-tune Epoch 43/100, Loss: 3.698937e-06, LR: 5.00e-06
 44%|████▍     | 44/100 [02:37<03:45,  4.02s/it]Fine-tune Epoch 44/100, Loss: 3.393041e-06, LR: 5.00e-06
 45%|████▌     | 45/100 [02:40<03:37,  3.95s/it]Fine-tune Epoch 45/100, Loss: 3.244832e-06, LR: 5.00e-06
 46%|████▌     | 46/100 [02:44<03:33,  3.95s/it]Fine-tune Epoch 46/100, Loss: 3.187997e-06, LR: 5.00e-06
 47%|████▋     | 47/100 [02:49<03:34,  4.05s/it]Fine-tune Epoch 47/100, Loss: 3.325037e-06, LR: 5.00e-06
 48%|████▊     | 48/100 [02:52<03:27,  3.98s/it]Fine-tune Epoch 48/100, Loss: 3.044853e-06, LR: 5.00e-06
 49%|████▉     | 49/100 [02:56<03:22,  3.97s/it]Fine-tune Epoch 49/100, Loss: 2.865013e-06, LR: 5.00e-06
 50%|█████     | 50/100 [03:00<03:17,  3.96s/it]Fine-tune Epoch 50/100, Loss: 2.811106e-06, LR: 5.00e-06
 51%|█████     | 51/100 [03:04<03:14,  3.97s/it]Fine-tune Epoch 51/100, Loss: 2.816661e-06, LR: 5.00e-06
 52%|█████▏    | 52/100 [03:08<03:09,  3.94s/it]Fine-tune Epoch 52/100, Loss: 2.513781e-06, LR: 5.00e-06
 53%|█████▎    | 53/100 [03:12<03:07,  3.99s/it]Fine-tune Epoch 53/100, Loss: 2.564817e-06, LR: 5.00e-06
 54%|█████▍    | 54/100 [03:16<03:07,  4.07s/it]Fine-tune Epoch 54/100, Loss: 2.255997e-06, LR: 5.00e-06
 55%|█████▌    | 55/100 [03:21<03:04,  4.10s/it]Fine-tune Epoch 55/100, Loss: 2.668081e-06, LR: 5.00e-06
 56%|█████▌    | 56/100 [03:25<03:00,  4.11s/it]Fine-tune Epoch 56/100, Loss: 2.195007e-06, LR: 5.00e-06
 57%|█████▋    | 57/100 [03:29<02:53,  4.02s/it]Fine-tune Epoch 57/100, Loss: 2.286200e-06, LR: 5.00e-06
 58%|█████▊    | 58/100 [03:32<02:45,  3.94s/it]Fine-tune Epoch 58/100, Loss: 2.210426e-06, LR: 5.00e-06
 59%|█████▉    | 59/100 [03:36<02:33,  3.74s/it]Fine-tune Epoch 59/100, Loss: 2.098430e-06, LR: 5.00e-06
 60%|██████    | 60/100 [03:39<02:21,  3.53s/it]Fine-tune Epoch 60/100, Loss: 2.620497e-06, LR: 5.00e-06
 61%|██████    | 61/100 [03:41<02:08,  3.29s/it]Fine-tune Epoch 61/100, Loss: 1.809951e-06, LR: 5.00e-06
 62%|██████▏   | 62/100 [03:44<02:01,  3.21s/it]Fine-tune Epoch 62/100, Loss: 1.813302e-06, LR: 5.00e-06
 63%|██████▎   | 63/100 [03:47<01:55,  3.11s/it]Fine-tune Epoch 63/100, Loss: 1.820013e-06, LR: 5.00e-06
 64%|██████▍   | 64/100 [03:50<01:49,  3.05s/it]Fine-tune Epoch 64/100, Loss: 2.038589e-06, LR: 5.00e-06
 65%|██████▌   | 65/100 [03:53<01:43,  2.95s/it]Fine-tune Epoch 65/100, Loss: 1.710580e-06, LR: 5.00e-06
 66%|██████▌   | 66/100 [03:56<01:39,  2.91s/it]Fine-tune Epoch 66/100, Loss: 2.115226e-06, LR: 5.00e-06
 67%|██████▋   | 67/100 [03:58<01:33,  2.85s/it]Fine-tune Epoch 67/100, Loss: 1.893910e-06, LR: 5.00e-06
 68%|██████▊   | 68/100 [04:01<01:30,  2.84s/it]Fine-tune Epoch 68/100, Loss: 1.528424e-06, LR: 5.00e-06
 69%|██████▉   | 69/100 [04:04<01:26,  2.80s/it]Fine-tune Epoch 69/100, Loss: 1.813634e-06, LR: 5.00e-06
 70%|███████   | 70/100 [04:07<01:24,  2.82s/it]Fine-tune Epoch 70/100, Loss: 1.481475e-06, LR: 5.00e-06
 71%|███████   | 71/100 [04:10<01:21,  2.81s/it]Fine-tune Epoch 71/100, Loss: 1.889479e-06, LR: 5.00e-06
 72%|███████▏  | 72/100 [04:12<01:17,  2.77s/it]Fine-tune Epoch 72/100, Loss: 1.659477e-06, LR: 5.00e-06
 73%|███████▎  | 73/100 [04:15<01:13,  2.71s/it]Fine-tune Epoch 73/100, Loss: 1.677734e-06, LR: 5.00e-06
 74%|███████▍  | 74/100 [04:18<01:12,  2.78s/it]Fine-tune Epoch 74/100, Loss: 1.569180e-06, LR: 5.00e-06
 75%|███████▌  | 75/100 [04:21<01:09,  2.80s/it]Fine-tune Epoch 75/100, Loss: 1.414924e-06, LR: 5.00e-06
 76%|███████▌  | 76/100 [04:23<01:07,  2.81s/it]Fine-tune Epoch 76/100, Loss: 1.461982e-06, LR: 5.00e-06
 77%|███████▋  | 77/100 [04:26<01:04,  2.81s/it]Fine-tune Epoch 77/100, Loss: 1.414878e-06, LR: 5.00e-06
 78%|███████▊  | 78/100 [04:29<01:01,  2.81s/it]Fine-tune Epoch 78/100, Loss: 1.622938e-06, LR: 5.00e-06
 79%|███████▉  | 79/100 [04:32<00:58,  2.80s/it]Fine-tune Epoch 79/100, Loss: 1.285399e-06, LR: 5.00e-06
 80%|████████  | 80/100 [04:35<00:56,  2.81s/it]Fine-tune Epoch 80/100, Loss: 1.600897e-06, LR: 5.00e-06
 81%|████████  | 81/100 [04:37<00:52,  2.77s/it]Fine-tune Epoch 81/100, Loss: 1.288958e-06, LR: 5.00e-06
 82%|████████▏ | 82/100 [04:40<00:50,  2.80s/it]Fine-tune Epoch 82/100, Loss: 1.434163e-06, LR: 5.00e-06
 83%|████████▎ | 83/100 [04:43<00:46,  2.75s/it]Fine-tune Epoch 83/100, Loss: 1.464874e-06, LR: 5.00e-06
 84%|████████▍ | 84/100 [04:46<00:44,  2.81s/it]Fine-tune Epoch 84/100, Loss: 1.256113e-06, LR: 5.00e-06
 85%|████████▌ | 85/100 [04:49<00:42,  2.80s/it]Fine-tune Epoch 85/100, Loss: 1.412178e-06, LR: 5.00e-06
 86%|████████▌ | 86/100 [04:51<00:39,  2.81s/it]Fine-tune Epoch 86/100, Loss: 1.269336e-06, LR: 5.00e-06
 87%|████████▋ | 87/100 [04:54<00:37,  2.86s/it]Fine-tune Epoch 87/100, Loss: 1.299583e-06, LR: 5.00e-06
 88%|████████▊ | 88/100 [04:58<00:35,  2.93s/it]Fine-tune Epoch 88/100, Loss: 1.265548e-06, LR: 5.00e-06
 89%|████████▉ | 89/100 [05:01<00:32,  2.96s/it]Fine-tune Epoch 89/100, Loss: 1.386605e-06, LR: 5.00e-06
 90%|█████████ | 90/100 [05:04<00:29,  2.98s/it]Fine-tune Epoch 90/100, Loss: 1.104770e-06, LR: 5.00e-06
 91%|█████████ | 91/100 [05:06<00:26,  2.96s/it]Fine-tune Epoch 91/100, Loss: 1.228255e-06, LR: 5.00e-06
 92%|█████████▏| 92/100 [05:09<00:23,  2.92s/it]Fine-tune Epoch 92/100, Loss: 1.286048e-06, LR: 5.00e-06
 93%|█████████▎| 93/100 [05:12<00:20,  2.96s/it]Fine-tune Epoch 93/100, Loss: 1.251283e-06, LR: 5.00e-06
 94%|█████████▍| 94/100 [05:15<00:17,  2.95s/it]Fine-tune Epoch 94/100, Loss: 1.150439e-06, LR: 5.00e-06
 95%|█████████▌| 95/100 [05:18<00:14,  2.95s/it]Fine-tune Epoch 95/100, Loss: 1.084372e-06, LR: 5.00e-06
 96%|█████████▌| 96/100 [05:21<00:11,  2.94s/it]Fine-tune Epoch 96/100, Loss: 1.343347e-06, LR: 5.00e-06
 97%|█████████▋| 97/100 [05:24<00:08,  2.94s/it]Fine-tune Epoch 97/100, Loss: 1.087864e-06, LR: 5.00e-06
 98%|█████████▊| 98/100 [05:27<00:05,  2.95s/it]Fine-tune Epoch 98/100, Loss: 1.136118e-06, LR: 5.00e-06
 99%|█████████▉| 99/100 [05:30<00:02,  2.94s/it]Fine-tune Epoch 99/100, Loss: 1.101832e-06, LR: 5.00e-06
100%|██████████| 100/100 [05:33<00:00,  2.90s/it]100%|██████████| 100/100 [05:33<00:00,  3.33s/it]
Fine-tune Epoch 100/100, Loss: 1.052802e-06, LR: 5.00e-06

Final PSNR after pruning and fine-tuning: 66.2280
Pruning resulted in PSNR 66.23 which is below target 68.00. Consider less aggressive pruning.

Attempting to prune with ratio: 15%
Original hidden neurons: 150, New hidden neurons: 128 (Pruning 22 neurons)
New pruned model architecture:
MyResidualSirenNet(
  (net_layers): ModuleList(
    (0): SineLayer(
      (linear): Linear(in_features=3, out_features=128, bias=True)
    )
    (1-6): 6 x ResidualSineLayer(
      (linear_1): Linear(in_features=128, out_features=128, bias=True)
      (linear_2): Linear(in_features=128, out_features=128, bias=True)
    )
    (7): Linear(in_features=128, out_features=1, bias=True)
  )
)
New pruned model parameters: 198785
Parameter reduction: 27.07%

--- Fine-tuning pruned model for 100 epochs ---
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:02<04:33,  2.77s/it]Fine-tune Epoch 1/100, Loss: 1.410325e-02, LR: 5.00e-06
  2%|▏         | 2/100 [00:05<04:47,  2.93s/it]Fine-tune Epoch 2/100, Loss: 1.691434e-03, LR: 5.00e-06
  3%|▎         | 3/100 [00:08<04:41,  2.90s/it]Fine-tune Epoch 3/100, Loss: 7.310473e-04, LR: 5.00e-06
  4%|▍         | 4/100 [00:11<04:35,  2.87s/it]Fine-tune Epoch 4/100, Loss: 4.353180e-04, LR: 5.00e-06
  5%|▌         | 5/100 [00:14<04:38,  2.93s/it]Fine-tune Epoch 5/100, Loss: 2.977883e-04, LR: 5.00e-06
  6%|▌         | 6/100 [00:17<04:32,  2.90s/it]Fine-tune Epoch 6/100, Loss: 2.202974e-04, LR: 5.00e-06
  7%|▋         | 7/100 [00:20<04:30,  2.91s/it]Fine-tune Epoch 7/100, Loss: 1.716117e-04, LR: 5.00e-06
  8%|▊         | 8/100 [00:22<04:20,  2.83s/it]Fine-tune Epoch 8/100, Loss: 1.384384e-04, LR: 5.00e-06
  9%|▉         | 9/100 [00:25<04:10,  2.76s/it]Fine-tune Epoch 9/100, Loss: 1.145357e-04, LR: 5.00e-06
 10%|█         | 10/100 [00:28<04:12,  2.80s/it]Fine-tune Epoch 10/100, Loss: 9.642955e-05, LR: 5.00e-06
 11%|█         | 11/100 [00:31<04:16,  2.88s/it]Fine-tune Epoch 11/100, Loss: 8.242646e-05, LR: 5.00e-06
 12%|█▏        | 12/100 [00:34<04:18,  2.93s/it]Fine-tune Epoch 12/100, Loss: 7.117291e-05, LR: 5.00e-06
 13%|█▎        | 13/100 [00:37<04:08,  2.85s/it]Fine-tune Epoch 13/100, Loss: 6.197965e-05, LR: 5.00e-06
 14%|█▍        | 14/100 [00:40<04:10,  2.91s/it]Fine-tune Epoch 14/100, Loss: 5.470594e-05, LR: 5.00e-06
 15%|█▌        | 15/100 [00:43<04:04,  2.88s/it]Fine-tune Epoch 15/100, Loss: 4.840646e-05, LR: 5.00e-06
 16%|█▌        | 16/100 [00:46<04:04,  2.91s/it]Fine-tune Epoch 16/100, Loss: 4.320978e-05, LR: 5.00e-06
 17%|█▋        | 17/100 [00:49<04:02,  2.92s/it]Fine-tune Epoch 17/100, Loss: 3.865502e-05, LR: 5.00e-06
 18%|█▊        | 18/100 [00:52<04:01,  2.95s/it]Fine-tune Epoch 18/100, Loss: 3.493471e-05, LR: 5.00e-06
 19%|█▉        | 19/100 [00:54<03:54,  2.90s/it]Fine-tune Epoch 19/100, Loss: 3.176170e-05, LR: 5.00e-06
 20%|██        | 20/100 [00:57<03:53,  2.92s/it]Fine-tune Epoch 20/100, Loss: 2.867301e-05, LR: 5.00e-06
 21%|██        | 21/100 [01:00<03:50,  2.92s/it]Fine-tune Epoch 21/100, Loss: 2.625461e-05, LR: 5.00e-06
 22%|██▏       | 22/100 [01:03<03:47,  2.91s/it]Fine-tune Epoch 22/100, Loss: 2.390669e-05, LR: 5.00e-06
 23%|██▎       | 23/100 [01:06<03:45,  2.92s/it]Fine-tune Epoch 23/100, Loss: 2.189742e-05, LR: 5.00e-06
 24%|██▍       | 24/100 [01:09<03:42,  2.92s/it]Fine-tune Epoch 24/100, Loss: 2.013836e-05, LR: 5.00e-06
 25%|██▌       | 25/100 [01:12<03:37,  2.90s/it]Fine-tune Epoch 25/100, Loss: 1.858284e-05, LR: 5.00e-06
 26%|██▌       | 26/100 [01:14<03:29,  2.83s/it]Fine-tune Epoch 26/100, Loss: 1.719788e-05, LR: 5.00e-06
 27%|██▋       | 27/100 [01:17<03:23,  2.79s/it]Fine-tune Epoch 27/100, Loss: 1.582074e-05, LR: 5.00e-06
 28%|██▊       | 28/100 [01:20<03:22,  2.81s/it]Fine-tune Epoch 28/100, Loss: 1.475669e-05, LR: 5.00e-06
 29%|██▉       | 29/100 [01:23<03:21,  2.83s/it]Fine-tune Epoch 29/100, Loss: 1.367628e-05, LR: 5.00e-06
 30%|███       | 30/100 [01:26<03:17,  2.82s/it]Fine-tune Epoch 30/100, Loss: 1.282810e-05, LR: 5.00e-06
 31%|███       | 31/100 [01:29<03:14,  2.82s/it]Fine-tune Epoch 31/100, Loss: 1.198221e-05, LR: 5.00e-06
 32%|███▏      | 32/100 [01:31<03:14,  2.86s/it]Fine-tune Epoch 32/100, Loss: 1.120160e-05, LR: 5.00e-06
 33%|███▎      | 33/100 [01:34<03:10,  2.84s/it]Fine-tune Epoch 33/100, Loss: 1.043877e-05, LR: 5.00e-06
 34%|███▍      | 34/100 [01:37<03:07,  2.84s/it]Fine-tune Epoch 34/100, Loss: 9.783884e-06, LR: 5.00e-06
 35%|███▌      | 35/100 [01:40<03:06,  2.86s/it]Fine-tune Epoch 35/100, Loss: 9.531185e-06, LR: 5.00e-06
 36%|███▌      | 36/100 [01:43<02:59,  2.81s/it]Fine-tune Epoch 36/100, Loss: 8.784166e-06, LR: 5.00e-06
 37%|███▋      | 37/100 [01:45<02:56,  2.80s/it]Fine-tune Epoch 37/100, Loss: 8.104744e-06, LR: 5.00e-06
 38%|███▊      | 38/100 [01:48<02:53,  2.79s/it]Fine-tune Epoch 38/100, Loss: 7.739978e-06, LR: 5.00e-06
 39%|███▉      | 39/100 [01:51<02:49,  2.77s/it]Fine-tune Epoch 39/100, Loss: 7.386767e-06, LR: 5.00e-06
 40%|████      | 40/100 [01:54<02:44,  2.74s/it]Fine-tune Epoch 40/100, Loss: 7.053358e-06, LR: 5.00e-06
 41%|████      | 41/100 [01:57<02:44,  2.79s/it]Fine-tune Epoch 41/100, Loss: 6.691485e-06, LR: 5.00e-06
 42%|████▏     | 42/100 [01:59<02:39,  2.75s/it]Fine-tune Epoch 42/100, Loss: 6.508289e-06, LR: 5.00e-06
 43%|████▎     | 43/100 [02:02<02:38,  2.78s/it]Fine-tune Epoch 43/100, Loss: 6.040479e-06, LR: 5.00e-06
 44%|████▍     | 44/100 [02:05<02:36,  2.80s/it]Fine-tune Epoch 44/100, Loss: 5.540363e-06, LR: 5.00e-06
 45%|████▌     | 45/100 [02:08<02:35,  2.82s/it]Fine-tune Epoch 45/100, Loss: 5.488804e-06, LR: 5.00e-06
 46%|████▌     | 46/100 [02:11<02:30,  2.79s/it]Fine-tune Epoch 46/100, Loss: 5.347385e-06, LR: 5.00e-06
 47%|████▋     | 47/100 [02:13<02:27,  2.79s/it]Fine-tune Epoch 47/100, Loss: 5.117574e-06, LR: 5.00e-06
 48%|████▊     | 48/100 [02:16<02:24,  2.78s/it]Fine-tune Epoch 48/100, Loss: 4.863976e-06, LR: 5.00e-06
 49%|████▉     | 49/100 [02:19<02:22,  2.80s/it]Fine-tune Epoch 49/100, Loss: 4.687698e-06, LR: 5.00e-06
 50%|█████     | 50/100 [02:22<02:19,  2.80s/it]Fine-tune Epoch 50/100, Loss: 4.747538e-06, LR: 5.00e-06
 51%|█████     | 51/100 [02:25<02:18,  2.83s/it]Fine-tune Epoch 51/100, Loss: 4.335388e-06, LR: 5.00e-06
 52%|█████▏    | 52/100 [02:27<02:14,  2.81s/it]Fine-tune Epoch 52/100, Loss: 4.099327e-06, LR: 5.00e-06
 53%|█████▎    | 53/100 [02:30<02:14,  2.86s/it]Fine-tune Epoch 53/100, Loss: 4.536870e-06, LR: 5.00e-06
 54%|█████▍    | 54/100 [02:33<02:08,  2.79s/it]Fine-tune Epoch 54/100, Loss: 3.876222e-06, LR: 5.00e-06
 55%|█████▌    | 55/100 [02:36<02:07,  2.82s/it]Fine-tune Epoch 55/100, Loss: 3.631070e-06, LR: 5.00e-06
 56%|█████▌    | 56/100 [02:39<02:04,  2.84s/it]Fine-tune Epoch 56/100, Loss: 3.895654e-06, LR: 5.00e-06
 57%|█████▋    | 57/100 [02:42<02:00,  2.81s/it]Fine-tune Epoch 57/100, Loss: 3.724460e-06, LR: 5.00e-06
 58%|█████▊    | 58/100 [02:44<01:56,  2.78s/it]Fine-tune Epoch 58/100, Loss: 3.111714e-06, LR: 5.00e-06
 59%|█████▉    | 59/100 [02:47<01:54,  2.79s/it]Fine-tune Epoch 59/100, Loss: 3.416365e-06, LR: 5.00e-06
 60%|██████    | 60/100 [02:50<01:51,  2.80s/it]Fine-tune Epoch 60/100, Loss: 3.580820e-06, LR: 5.00e-06
 61%|██████    | 61/100 [02:53<01:50,  2.84s/it]Fine-tune Epoch 61/100, Loss: 3.025410e-06, LR: 5.00e-06
 62%|██████▏   | 62/100 [02:55<01:44,  2.75s/it]Fine-tune Epoch 62/100, Loss: 3.238582e-06, LR: 5.00e-06
 63%|██████▎   | 63/100 [02:58<01:43,  2.79s/it]Fine-tune Epoch 63/100, Loss: 3.004930e-06, LR: 5.00e-06
 64%|██████▍   | 64/100 [03:01<01:39,  2.76s/it]Fine-tune Epoch 64/100, Loss: 2.896612e-06, LR: 5.00e-06
 65%|██████▌   | 65/100 [03:04<01:37,  2.80s/it]Fine-tune Epoch 65/100, Loss: 2.764263e-06, LR: 5.00e-06
 66%|██████▌   | 66/100 [03:07<01:34,  2.79s/it]Fine-tune Epoch 66/100, Loss: 2.790056e-06, LR: 5.00e-06
 67%|██████▋   | 67/100 [03:09<01:30,  2.75s/it]Fine-tune Epoch 67/100, Loss: 3.058732e-06, LR: 5.00e-06
 68%|██████▊   | 68/100 [03:12<01:25,  2.68s/it]Fine-tune Epoch 68/100, Loss: 2.612795e-06, LR: 5.00e-06
 69%|██████▉   | 69/100 [03:14<01:23,  2.70s/it]Fine-tune Epoch 69/100, Loss: 2.650755e-06, LR: 5.00e-06
 70%|███████   | 70/100 [03:17<01:20,  2.69s/it]Fine-tune Epoch 70/100, Loss: 2.671626e-06, LR: 5.00e-06
 71%|███████   | 71/100 [03:20<01:18,  2.71s/it]Fine-tune Epoch 71/100, Loss: 2.190258e-06, LR: 5.00e-06
 72%|███████▏  | 72/100 [03:23<01:16,  2.73s/it]Fine-tune Epoch 72/100, Loss: 2.588532e-06, LR: 5.00e-06
 73%|███████▎  | 73/100 [03:25<01:13,  2.71s/it]Fine-tune Epoch 73/100, Loss: 2.510435e-06, LR: 5.00e-06
 74%|███████▍  | 74/100 [03:28<01:10,  2.70s/it]Fine-tune Epoch 74/100, Loss: 2.296365e-06, LR: 5.00e-06
 75%|███████▌  | 75/100 [03:31<01:07,  2.70s/it]Fine-tune Epoch 75/100, Loss: 2.032803e-06, LR: 5.00e-06
 76%|███████▌  | 76/100 [03:34<01:06,  2.77s/it]Fine-tune Epoch 76/100, Loss: 2.442570e-06, LR: 5.00e-06
 77%|███████▋  | 77/100 [03:37<01:04,  2.80s/it]Fine-tune Epoch 77/100, Loss: 2.991691e-06, LR: 5.00e-06
 78%|███████▊  | 78/100 [03:39<01:02,  2.83s/it]Fine-tune Epoch 78/100, Loss: 1.814242e-06, LR: 5.00e-06
 79%|███████▉  | 79/100 [03:42<01:00,  2.87s/it]Fine-tune Epoch 79/100, Loss: 1.915451e-06, LR: 5.00e-06
 80%|████████  | 80/100 [03:45<00:56,  2.81s/it]Fine-tune Epoch 80/100, Loss: 2.043449e-06, LR: 5.00e-06
 81%|████████  | 81/100 [03:48<00:53,  2.79s/it]Fine-tune Epoch 81/100, Loss: 2.337284e-06, LR: 5.00e-06
 82%|████████▏ | 82/100 [03:51<00:50,  2.80s/it]Fine-tune Epoch 82/100, Loss: 1.869444e-06, LR: 5.00e-06
 83%|████████▎ | 83/100 [03:54<00:48,  2.86s/it]Fine-tune Epoch 83/100, Loss: 2.060051e-06, LR: 5.00e-06
 84%|████████▍ | 84/100 [03:57<00:46,  2.88s/it]Fine-tune Epoch 84/100, Loss: 2.254935e-06, LR: 5.00e-06
 85%|████████▌ | 85/100 [03:59<00:42,  2.83s/it]Fine-tune Epoch 85/100, Loss: 1.800214e-06, LR: 5.00e-06
 86%|████████▌ | 86/100 [04:02<00:39,  2.80s/it]Fine-tune Epoch 86/100, Loss: 1.835740e-06, LR: 5.00e-06
 87%|████████▋ | 87/100 [04:05<00:36,  2.78s/it]Fine-tune Epoch 87/100, Loss: 2.018045e-06, LR: 5.00e-06
 88%|████████▊ | 88/100 [04:08<00:33,  2.79s/it]Fine-tune Epoch 88/100, Loss: 1.702586e-06, LR: 5.00e-06
 89%|████████▉ | 89/100 [04:10<00:30,  2.80s/it]Fine-tune Epoch 89/100, Loss: 2.257266e-06, LR: 5.00e-06
 90%|█████████ | 90/100 [04:13<00:28,  2.82s/it]Fine-tune Epoch 90/100, Loss: 1.443378e-06, LR: 5.00e-06
 91%|█████████ | 91/100 [04:16<00:25,  2.82s/it]Fine-tune Epoch 91/100, Loss: 1.973542e-06, LR: 5.00e-06
 92%|█████████▏| 92/100 [04:19<00:22,  2.80s/it]Fine-tune Epoch 92/100, Loss: 1.670217e-06, LR: 5.00e-06
 93%|█████████▎| 93/100 [04:22<00:19,  2.79s/it]Fine-tune Epoch 93/100, Loss: 1.666815e-06, LR: 5.00e-06
 94%|█████████▍| 94/100 [04:25<00:17,  2.84s/it]Fine-tune Epoch 94/100, Loss: 1.654478e-06, LR: 5.00e-06
 95%|█████████▌| 95/100 [04:27<00:13,  2.78s/it]Fine-tune Epoch 95/100, Loss: 1.900809e-06, LR: 5.00e-06
 96%|█████████▌| 96/100 [04:30<00:11,  2.85s/it]Fine-tune Epoch 96/100, Loss: 1.428933e-06, LR: 5.00e-06
 97%|█████████▋| 97/100 [04:33<00:08,  2.90s/it]Fine-tune Epoch 97/100, Loss: 1.653727e-06, LR: 5.00e-06
 98%|█████████▊| 98/100 [04:36<00:05,  2.88s/it]Fine-tune Epoch 98/100, Loss: 1.631604e-06, LR: 5.00e-06
 99%|█████████▉| 99/100 [04:39<00:02,  2.90s/it]Fine-tune Epoch 99/100, Loss: 2.050794e-06, LR: 5.00e-06
100%|██████████| 100/100 [04:42<00:00,  2.91s/it]100%|██████████| 100/100 [04:42<00:00,  2.82s/it]
Fine-tune Epoch 100/100, Loss: 1.372009e-06, LR: 5.00e-06

Final PSNR after pruning and fine-tuning: 62.4060
Pruning resulted in PSNR 62.41 which is below target 68.00. Consider less aggressive pruning.

Attempting to prune with ratio: 20%
Original hidden neurons: 150, New hidden neurons: 120 (Pruning 30 neurons)
New pruned model architecture:
MyResidualSirenNet(
  (net_layers): ModuleList(
    (0): SineLayer(
      (linear): Linear(in_features=3, out_features=120, bias=True)
    )
    (1-6): 6 x ResidualSineLayer(
      (linear_1): Linear(in_features=120, out_features=120, bias=True)
      (linear_2): Linear(in_features=120, out_features=120, bias=True)
    )
    (7): Linear(in_features=120, out_features=1, bias=True)
  )
)
New pruned model parameters: 174841
Parameter reduction: 35.85%

--- Fine-tuning pruned model for 100 epochs ---
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:02<04:28,  2.72s/it]Fine-tune Epoch 1/100, Loss: 2.419542e-02, LR: 5.00e-06
  2%|▏         | 2/100 [00:05<04:33,  2.79s/it]Fine-tune Epoch 2/100, Loss: 3.582763e-03, LR: 5.00e-06
  3%|▎         | 3/100 [00:08<04:38,  2.87s/it]Fine-tune Epoch 3/100, Loss: 1.452322e-03, LR: 5.00e-06
  4%|▍         | 4/100 [00:11<04:36,  2.88s/it]Fine-tune Epoch 4/100, Loss: 8.346129e-04, LR: 5.00e-06
  5%|▌         | 5/100 [00:14<04:33,  2.87s/it]Fine-tune Epoch 5/100, Loss: 5.564321e-04, LR: 5.00e-06
  6%|▌         | 6/100 [00:17<04:39,  2.97s/it]Fine-tune Epoch 6/100, Loss: 4.033367e-04, LR: 5.00e-06
  7%|▋         | 7/100 [00:20<04:40,  3.01s/it]Fine-tune Epoch 7/100, Loss: 3.082383e-04, LR: 5.00e-06
  8%|▊         | 8/100 [00:23<04:30,  2.94s/it]Fine-tune Epoch 8/100, Loss: 2.447787e-04, LR: 5.00e-06
  9%|▉         | 9/100 [00:26<04:24,  2.91s/it]Fine-tune Epoch 9/100, Loss: 1.995903e-04, LR: 5.00e-06
 10%|█         | 10/100 [00:28<04:19,  2.88s/it]Fine-tune Epoch 10/100, Loss: 1.664153e-04, LR: 5.00e-06
 11%|█         | 11/100 [00:31<04:10,  2.82s/it]Fine-tune Epoch 11/100, Loss: 1.413323e-04, LR: 5.00e-06
 12%|█▏        | 12/100 [00:34<04:05,  2.79s/it]Fine-tune Epoch 12/100, Loss: 1.212347e-04, LR: 5.00e-06
 13%|█▎        | 13/100 [00:37<04:14,  2.93s/it]Fine-tune Epoch 13/100, Loss: 1.049131e-04, LR: 5.00e-06
 14%|█▍        | 14/100 [00:40<04:11,  2.92s/it]Fine-tune Epoch 14/100, Loss: 9.191340e-05, LR: 5.00e-06
 15%|█▌        | 15/100 [00:43<04:09,  2.94s/it]Fine-tune Epoch 15/100, Loss: 8.104226e-05, LR: 5.00e-06
 16%|█▌        | 16/100 [00:46<04:06,  2.93s/it]Fine-tune Epoch 16/100, Loss: 7.184825e-05, LR: 5.00e-06
 17%|█▋        | 17/100 [00:49<04:03,  2.93s/it]Fine-tune Epoch 17/100, Loss: 6.411824e-05, LR: 5.00e-06
 18%|█▊        | 18/100 [00:52<04:01,  2.94s/it]Fine-tune Epoch 18/100, Loss: 5.743097e-05, LR: 5.00e-06
 19%|█▉        | 19/100 [00:55<03:59,  2.95s/it]Fine-tune Epoch 19/100, Loss: 5.176321e-05, LR: 5.00e-06
 20%|██        | 20/100 [00:57<03:49,  2.87s/it]Fine-tune Epoch 20/100, Loss: 4.686882e-05, LR: 5.00e-06
 21%|██        | 21/100 [01:00<03:45,  2.86s/it]Fine-tune Epoch 21/100, Loss: 4.265783e-05, LR: 5.00e-06
 22%|██▏       | 22/100 [01:03<03:44,  2.88s/it]Fine-tune Epoch 22/100, Loss: 3.875135e-05, LR: 5.00e-06
 23%|██▎       | 23/100 [01:06<03:42,  2.89s/it]Fine-tune Epoch 23/100, Loss: 3.529932e-05, LR: 5.00e-06
 24%|██▍       | 24/100 [01:09<03:38,  2.88s/it]Fine-tune Epoch 24/100, Loss: 3.237873e-05, LR: 5.00e-06
 25%|██▌       | 25/100 [01:12<03:33,  2.85s/it]Fine-tune Epoch 25/100, Loss: 2.984624e-05, LR: 5.00e-06
 26%|██▌       | 26/100 [01:15<03:32,  2.88s/it]Fine-tune Epoch 26/100, Loss: 2.731123e-05, LR: 5.00e-06
 27%|██▋       | 27/100 [01:18<03:36,  2.96s/it]Fine-tune Epoch 27/100, Loss: 2.525392e-05, LR: 5.00e-06
 28%|██▊       | 28/100 [01:21<03:33,  2.96s/it]Fine-tune Epoch 28/100, Loss: 2.330353e-05, LR: 5.00e-06
 29%|██▉       | 29/100 [01:24<03:23,  2.87s/it]Fine-tune Epoch 29/100, Loss: 2.168432e-05, LR: 5.00e-06
 30%|███       | 30/100 [01:27<03:25,  2.94s/it]Fine-tune Epoch 30/100, Loss: 2.004786e-05, LR: 5.00e-06
 31%|███       | 31/100 [01:29<03:18,  2.87s/it]Fine-tune Epoch 31/100, Loss: 1.865875e-05, LR: 5.00e-06
 32%|███▏      | 32/100 [01:32<03:17,  2.90s/it]Fine-tune Epoch 32/100, Loss: 1.763070e-05, LR: 5.00e-06
 33%|███▎      | 33/100 [01:35<03:13,  2.89s/it]Fine-tune Epoch 33/100, Loss: 1.620025e-05, LR: 5.00e-06
 34%|███▍      | 34/100 [01:38<03:11,  2.90s/it]Fine-tune Epoch 34/100, Loss: 1.527121e-05, LR: 5.00e-06
 35%|███▌      | 35/100 [01:41<03:06,  2.87s/it]Fine-tune Epoch 35/100, Loss: 1.420179e-05, LR: 5.00e-06
 36%|███▌      | 36/100 [01:44<03:03,  2.87s/it]Fine-tune Epoch 36/100, Loss: 1.366907e-05, LR: 5.00e-06
 37%|███▋      | 37/100 [01:47<03:02,  2.90s/it]Fine-tune Epoch 37/100, Loss: 1.276713e-05, LR: 5.00e-06
 38%|███▊      | 38/100 [01:50<02:59,  2.90s/it]Fine-tune Epoch 38/100, Loss: 1.192826e-05, LR: 5.00e-06
 39%|███▉      | 39/100 [01:53<02:57,  2.91s/it]Fine-tune Epoch 39/100, Loss: 1.134787e-05, LR: 5.00e-06
 40%|████      | 40/100 [01:56<02:57,  2.96s/it]Fine-tune Epoch 40/100, Loss: 1.070864e-05, LR: 5.00e-06
 41%|████      | 41/100 [01:58<02:52,  2.93s/it]Fine-tune Epoch 41/100, Loss: 1.011021e-05, LR: 5.00e-06
 42%|████▏     | 42/100 [02:02<02:52,  2.97s/it]Fine-tune Epoch 42/100, Loss: 1.031392e-05, LR: 5.00e-06
 43%|████▎     | 43/100 [02:04<02:48,  2.95s/it]Fine-tune Epoch 43/100, Loss: 9.104698e-06, LR: 5.00e-06
 44%|████▍     | 44/100 [02:07<02:43,  2.92s/it]Fine-tune Epoch 44/100, Loss: 8.783498e-06, LR: 5.00e-06
 45%|████▌     | 45/100 [02:10<02:40,  2.91s/it]Fine-tune Epoch 45/100, Loss: 8.194940e-06, LR: 5.00e-06
 46%|████▌     | 46/100 [02:13<02:33,  2.85s/it]Fine-tune Epoch 46/100, Loss: 8.021115e-06, LR: 5.00e-06
 47%|████▋     | 47/100 [02:16<02:30,  2.85s/it]Fine-tune Epoch 47/100, Loss: 7.984117e-06, LR: 5.00e-06
 48%|████▊     | 48/100 [02:19<02:28,  2.86s/it]Fine-tune Epoch 48/100, Loss: 7.035037e-06, LR: 5.00e-06
 49%|████▉     | 49/100 [02:22<02:28,  2.91s/it]Fine-tune Epoch 49/100, Loss: 7.027470e-06, LR: 5.00e-06
 50%|█████     | 50/100 [02:25<02:28,  2.97s/it]Fine-tune Epoch 50/100, Loss: 7.017806e-06, LR: 5.00e-06
 51%|█████     | 51/100 [02:28<02:26,  2.99s/it]Fine-tune Epoch 51/100, Loss: 6.557196e-06, LR: 5.00e-06
 52%|█████▏    | 52/100 [02:31<02:22,  2.96s/it]Fine-tune Epoch 52/100, Loss: 6.488116e-06, LR: 5.00e-06
 53%|█████▎    | 53/100 [02:34<02:18,  2.96s/it]Fine-tune Epoch 53/100, Loss: 5.836911e-06, LR: 5.00e-06
 54%|█████▍    | 54/100 [02:36<02:14,  2.92s/it]Fine-tune Epoch 54/100, Loss: 5.762938e-06, LR: 5.00e-06
 55%|█████▌    | 55/100 [02:39<02:12,  2.94s/it]Fine-tune Epoch 55/100, Loss: 5.460426e-06, LR: 5.00e-06
 56%|█████▌    | 56/100 [02:42<02:07,  2.90s/it]Fine-tune Epoch 56/100, Loss: 5.281932e-06, LR: 5.00e-06
 57%|█████▋    | 57/100 [02:45<02:05,  2.93s/it]Fine-tune Epoch 57/100, Loss: 5.488737e-06, LR: 5.00e-06
 58%|█████▊    | 58/100 [02:48<02:04,  2.96s/it]Fine-tune Epoch 58/100, Loss: 5.111617e-06, LR: 5.00e-06
 59%|█████▉    | 59/100 [02:51<02:01,  2.96s/it]Fine-tune Epoch 59/100, Loss: 5.472927e-06, LR: 5.00e-06
 60%|██████    | 60/100 [02:54<02:01,  3.03s/it]Fine-tune Epoch 60/100, Loss: 4.579182e-06, LR: 5.00e-06
 61%|██████    | 61/100 [02:57<01:55,  2.95s/it]Fine-tune Epoch 61/100, Loss: 4.873446e-06, LR: 5.00e-06
 62%|██████▏   | 62/100 [03:01<01:55,  3.04s/it]Fine-tune Epoch 62/100, Loss: 4.178339e-06, LR: 5.00e-06
 63%|██████▎   | 63/100 [03:03<01:50,  3.00s/it]Fine-tune Epoch 63/100, Loss: 4.068474e-06, LR: 5.00e-06
 64%|██████▍   | 64/100 [03:06<01:48,  3.02s/it]Fine-tune Epoch 64/100, Loss: 4.118439e-06, LR: 5.00e-06
 65%|██████▌   | 65/100 [03:09<01:41,  2.91s/it]Fine-tune Epoch 65/100, Loss: 4.420533e-06, LR: 5.00e-06
 66%|██████▌   | 66/100 [03:12<01:38,  2.90s/it]Fine-tune Epoch 66/100, Loss: 3.857108e-06, LR: 5.00e-06
 67%|██████▋   | 67/100 [03:15<01:36,  2.91s/it]Fine-tune Epoch 67/100, Loss: 4.040268e-06, LR: 5.00e-06
 68%|██████▊   | 68/100 [03:18<01:30,  2.83s/it]Fine-tune Epoch 68/100, Loss: 4.482219e-06, LR: 5.00e-06
 69%|██████▉   | 69/100 [03:20<01:27,  2.82s/it]Fine-tune Epoch 69/100, Loss: 3.654515e-06, LR: 5.00e-06
 70%|███████   | 70/100 [03:23<01:25,  2.87s/it]Fine-tune Epoch 70/100, Loss: 3.689050e-06, LR: 5.00e-06
 71%|███████   | 71/100 [03:26<01:23,  2.89s/it]Fine-tune Epoch 71/100, Loss: 3.203402e-06, LR: 5.00e-06
 72%|███████▏  | 72/100 [03:29<01:21,  2.92s/it]Fine-tune Epoch 72/100, Loss: 3.317277e-06, LR: 5.00e-06
 73%|███████▎  | 73/100 [03:32<01:17,  2.87s/it]Fine-tune Epoch 73/100, Loss: 3.405744e-06, LR: 5.00e-06
 74%|███████▍  | 74/100 [03:35<01:15,  2.89s/it]Fine-tune Epoch 74/100, Loss: 3.283880e-06, LR: 5.00e-06
 75%|███████▌  | 75/100 [03:38<01:12,  2.90s/it]Fine-tune Epoch 75/100, Loss: 3.446733e-06, LR: 5.00e-06
 76%|███████▌  | 76/100 [03:41<01:10,  2.92s/it]Fine-tune Epoch 76/100, Loss: 2.840255e-06, LR: 5.00e-06
 77%|███████▋  | 77/100 [03:44<01:07,  2.91s/it]Fine-tune Epoch 77/100, Loss: 3.696912e-06, LR: 5.00e-06
 78%|███████▊  | 78/100 [03:47<01:03,  2.87s/it]Fine-tune Epoch 78/100, Loss: 3.236978e-06, LR: 5.00e-06
 79%|███████▉  | 79/100 [03:50<01:02,  2.97s/it]Fine-tune Epoch 79/100, Loss: 2.601998e-06, LR: 5.00e-06
 80%|████████  | 80/100 [03:53<00:58,  2.92s/it]Fine-tune Epoch 80/100, Loss: 3.113455e-06, LR: 5.00e-06
 81%|████████  | 81/100 [03:55<00:55,  2.91s/it]Fine-tune Epoch 81/100, Loss: 2.673116e-06, LR: 5.00e-06
 82%|████████▏ | 82/100 [03:58<00:51,  2.86s/it]Fine-tune Epoch 82/100, Loss: 3.235984e-06, LR: 5.00e-06
 83%|████████▎ | 83/100 [04:01<00:48,  2.85s/it]Fine-tune Epoch 83/100, Loss: 2.719799e-06, LR: 5.00e-06
 84%|████████▍ | 84/100 [04:04<00:44,  2.80s/it]Fine-tune Epoch 84/100, Loss: 2.497582e-06, LR: 5.00e-06
 85%|████████▌ | 85/100 [04:07<00:42,  2.82s/it]Fine-tune Epoch 85/100, Loss: 2.977958e-06, LR: 5.00e-06
 86%|████████▌ | 86/100 [04:09<00:39,  2.85s/it]Fine-tune Epoch 86/100, Loss: 2.348062e-06, LR: 5.00e-06
 87%|████████▋ | 87/100 [04:12<00:36,  2.83s/it]Fine-tune Epoch 87/100, Loss: 2.723961e-06, LR: 5.00e-06
 88%|████████▊ | 88/100 [04:15<00:33,  2.81s/it]Fine-tune Epoch 88/100, Loss: 2.548022e-06, LR: 5.00e-06
 89%|████████▉ | 89/100 [04:18<00:30,  2.81s/it]Fine-tune Epoch 89/100, Loss: 2.578719e-06, LR: 5.00e-06
 90%|█████████ | 90/100 [04:21<00:28,  2.82s/it]Fine-tune Epoch 90/100, Loss: 2.486952e-06, LR: 5.00e-06
 91%|█████████ | 91/100 [04:23<00:25,  2.82s/it]Fine-tune Epoch 91/100, Loss: 2.520699e-06, LR: 5.00e-06
 92%|█████████▏| 92/100 [04:26<00:22,  2.83s/it]Fine-tune Epoch 92/100, Loss: 2.583674e-06, LR: 5.00e-06
 93%|█████████▎| 93/100 [04:29<00:20,  2.87s/it]Fine-tune Epoch 93/100, Loss: 2.747888e-06, LR: 5.00e-06
 94%|█████████▍| 94/100 [04:32<00:17,  2.84s/it]Fine-tune Epoch 94/100, Loss: 1.909617e-06, LR: 5.00e-06
 95%|█████████▌| 95/100 [04:35<00:14,  2.81s/it]Fine-tune Epoch 95/100, Loss: 2.119588e-06, LR: 5.00e-06
 96%|█████████▌| 96/100 [04:38<00:11,  2.82s/it]Fine-tune Epoch 96/100, Loss: 2.370806e-06, LR: 5.00e-06
 97%|█████████▋| 97/100 [04:41<00:08,  2.86s/it]Fine-tune Epoch 97/100, Loss: 2.409535e-06, LR: 5.00e-06
 98%|█████████▊| 98/100 [04:43<00:05,  2.81s/it]Fine-tune Epoch 98/100, Loss: 2.149856e-06, LR: 5.00e-06
 99%|█████████▉| 99/100 [04:46<00:02,  2.80s/it]Fine-tune Epoch 99/100, Loss: 2.419507e-06, LR: 5.00e-06
100%|██████████| 100/100 [04:49<00:00,  2.84s/it]100%|██████████| 100/100 [04:49<00:00,  2.90s/it]
Fine-tune Epoch 100/100, Loss: 2.103433e-06, LR: 5.00e-06

Final PSNR after pruning and fine-tuning: 63.0937
Pruning resulted in PSNR 63.09 which is below target 68.00. Consider less aggressive pruning.

Attempting to prune with ratio: 25%
Original hidden neurons: 150, New hidden neurons: 113 (Pruning 37 neurons)
New pruned model architecture:
MyResidualSirenNet(
  (net_layers): ModuleList(
    (0): SineLayer(
      (linear): Linear(in_features=3, out_features=113, bias=True)
    )
    (1-6): 6 x ResidualSineLayer(
      (linear_1): Linear(in_features=113, out_features=113, bias=True)
      (linear_2): Linear(in_features=113, out_features=113, bias=True)
    )
    (7): Linear(in_features=113, out_features=1, bias=True)
  )
)
New pruned model parameters: 155150
Parameter reduction: 43.07%

--- Fine-tuning pruned model for 100 epochs ---
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:02<04:48,  2.91s/it]Fine-tune Epoch 1/100, Loss: 3.872909e-02, LR: 5.00e-06
  2%|▏         | 2/100 [00:05<04:30,  2.76s/it]Fine-tune Epoch 2/100, Loss: 6.481756e-03, LR: 5.00e-06
  3%|▎         | 3/100 [00:08<04:28,  2.77s/it]Fine-tune Epoch 3/100, Loss: 2.483136e-03, LR: 5.00e-06
  4%|▍         | 4/100 [00:11<04:27,  2.78s/it]Fine-tune Epoch 4/100, Loss: 1.372098e-03, LR: 5.00e-06
  5%|▌         | 5/100 [00:13<04:17,  2.72s/it]Fine-tune Epoch 5/100, Loss: 8.934320e-04, LR: 5.00e-06
  6%|▌         | 6/100 [00:16<04:18,  2.75s/it]Fine-tune Epoch 6/100, Loss: 6.379032e-04, LR: 5.00e-06
  7%|▋         | 7/100 [00:19<04:18,  2.77s/it]Fine-tune Epoch 7/100, Loss: 4.822771e-04, LR: 5.00e-06
  8%|▊         | 8/100 [00:22<04:16,  2.78s/it]Fine-tune Epoch 8/100, Loss: 3.784199e-04, LR: 5.00e-06
  9%|▉         | 9/100 [00:24<04:10,  2.76s/it]Fine-tune Epoch 9/100, Loss: 3.064591e-04, LR: 5.00e-06
 10%|█         | 10/100 [00:27<04:06,  2.74s/it]Fine-tune Epoch 10/100, Loss: 2.534513e-04, LR: 5.00e-06
 11%|█         | 11/100 [00:30<04:05,  2.75s/it]Fine-tune Epoch 11/100, Loss: 2.137761e-04, LR: 5.00e-06
 12%|█▏        | 12/100 [00:33<04:01,  2.74s/it]Fine-tune Epoch 12/100, Loss: 1.825840e-04, LR: 5.00e-06
 13%|█▎        | 13/100 [00:35<03:57,  2.74s/it]Fine-tune Epoch 13/100, Loss: 1.586983e-04, LR: 5.00e-06
 14%|█▍        | 14/100 [00:38<04:01,  2.81s/it]Fine-tune Epoch 14/100, Loss: 1.383342e-04, LR: 5.00e-06
 15%|█▌        | 15/100 [00:41<04:03,  2.86s/it]Fine-tune Epoch 15/100, Loss: 1.221654e-04, LR: 5.00e-06
 16%|█▌        | 16/100 [00:44<03:55,  2.80s/it]Fine-tune Epoch 16/100, Loss: 1.081086e-04, LR: 5.00e-06
 17%|█▋        | 17/100 [00:47<03:50,  2.78s/it]Fine-tune Epoch 17/100, Loss: 9.654997e-05, LR: 5.00e-06
 18%|█▊        | 18/100 [00:50<03:50,  2.81s/it]Fine-tune Epoch 18/100, Loss: 8.651853e-05, LR: 5.00e-06
 19%|█▉        | 19/100 [00:52<03:47,  2.81s/it]Fine-tune Epoch 19/100, Loss: 7.793240e-05, LR: 5.00e-06
 20%|██        | 20/100 [00:55<03:47,  2.84s/it]Fine-tune Epoch 20/100, Loss: 7.050060e-05, LR: 5.00e-06
 21%|██        | 21/100 [00:58<03:43,  2.83s/it]Fine-tune Epoch 21/100, Loss: 6.408019e-05, LR: 5.00e-06
 22%|██▏       | 22/100 [01:01<03:37,  2.79s/it]Fine-tune Epoch 22/100, Loss: 5.826669e-05, LR: 5.00e-06
 23%|██▎       | 23/100 [01:04<03:40,  2.86s/it]Fine-tune Epoch 23/100, Loss: 5.343903e-05, LR: 5.00e-06
 24%|██▍       | 24/100 [01:06<03:33,  2.80s/it]Fine-tune Epoch 24/100, Loss: 4.901850e-05, LR: 5.00e-06
 25%|██▌       | 25/100 [01:09<03:26,  2.75s/it]Fine-tune Epoch 25/100, Loss: 4.494469e-05, LR: 5.00e-06
 26%|██▌       | 26/100 [01:12<03:26,  2.80s/it]Fine-tune Epoch 26/100, Loss: 4.103138e-05, LR: 5.00e-06
 27%|██▋       | 27/100 [01:15<03:29,  2.86s/it]Fine-tune Epoch 27/100, Loss: 3.800048e-05, LR: 5.00e-06
 28%|██▊       | 28/100 [01:18<03:31,  2.94s/it]Fine-tune Epoch 28/100, Loss: 3.520707e-05, LR: 5.00e-06
 29%|██▉       | 29/100 [01:21<03:23,  2.86s/it]Fine-tune Epoch 29/100, Loss: 3.250383e-05, LR: 5.00e-06
 30%|███       | 30/100 [01:24<03:20,  2.86s/it]Fine-tune Epoch 30/100, Loss: 3.039977e-05, LR: 5.00e-06
 31%|███       | 31/100 [01:27<03:17,  2.87s/it]Fine-tune Epoch 31/100, Loss: 2.794456e-05, LR: 5.00e-06
 32%|███▏      | 32/100 [01:29<03:13,  2.85s/it]Fine-tune Epoch 32/100, Loss: 2.630004e-05, LR: 5.00e-06
 33%|███▎      | 33/100 [01:32<03:08,  2.81s/it]Fine-tune Epoch 33/100, Loss: 2.420896e-05, LR: 5.00e-06
 34%|███▍      | 34/100 [01:35<03:03,  2.78s/it]Fine-tune Epoch 34/100, Loss: 2.277581e-05, LR: 5.00e-06
 35%|███▌      | 35/100 [01:38<03:03,  2.83s/it]Fine-tune Epoch 35/100, Loss: 2.106818e-05, LR: 5.00e-06
 36%|███▌      | 36/100 [01:41<03:02,  2.86s/it]Fine-tune Epoch 36/100, Loss: 1.996649e-05, LR: 5.00e-06
 37%|███▋      | 37/100 [01:44<03:01,  2.88s/it]Fine-tune Epoch 37/100, Loss: 1.852428e-05, LR: 5.00e-06
 38%|███▊      | 38/100 [01:47<02:59,  2.90s/it]Fine-tune Epoch 38/100, Loss: 1.762410e-05, LR: 5.00e-06
 39%|███▉      | 39/100 [01:49<02:54,  2.86s/it]Fine-tune Epoch 39/100, Loss: 1.667040e-05, LR: 5.00e-06
 40%|████      | 40/100 [01:52<02:47,  2.80s/it]Fine-tune Epoch 40/100, Loss: 1.564102e-05, LR: 5.00e-06
 41%|████      | 41/100 [01:55<02:44,  2.80s/it]Fine-tune Epoch 41/100, Loss: 1.485166e-05, LR: 5.00e-06
 42%|████▏     | 42/100 [01:57<02:41,  2.78s/it]Fine-tune Epoch 42/100, Loss: 1.391411e-05, LR: 5.00e-06
 43%|████▎     | 43/100 [02:00<02:38,  2.78s/it]Fine-tune Epoch 43/100, Loss: 1.401862e-05, LR: 5.00e-06
 44%|████▍     | 44/100 [02:03<02:34,  2.76s/it]Fine-tune Epoch 44/100, Loss: 1.237937e-05, LR: 5.00e-06
 45%|████▌     | 45/100 [02:06<02:33,  2.79s/it]Fine-tune Epoch 45/100, Loss: 1.244141e-05, LR: 5.00e-06
 46%|████▌     | 46/100 [02:09<02:30,  2.78s/it]Fine-tune Epoch 46/100, Loss: 1.162259e-05, LR: 5.00e-06
 47%|████▋     | 47/100 [02:12<02:29,  2.82s/it]Fine-tune Epoch 47/100, Loss: 1.117274e-05, LR: 5.00e-06
 48%|████▊     | 48/100 [02:14<02:26,  2.82s/it]Fine-tune Epoch 48/100, Loss: 1.031740e-05, LR: 5.00e-06
 49%|████▉     | 49/100 [02:17<02:25,  2.86s/it]Fine-tune Epoch 49/100, Loss: 1.021488e-05, LR: 5.00e-06
 50%|█████     | 50/100 [02:20<02:19,  2.79s/it]Fine-tune Epoch 50/100, Loss: 9.529431e-06, LR: 5.00e-06
 51%|█████     | 51/100 [02:23<02:14,  2.75s/it]Fine-tune Epoch 51/100, Loss: 8.825438e-06, LR: 5.00e-06
 52%|█████▏    | 52/100 [02:25<02:14,  2.80s/it]Fine-tune Epoch 52/100, Loss: 9.336404e-06, LR: 5.00e-06
 53%|█████▎    | 53/100 [02:28<02:10,  2.78s/it]Fine-tune Epoch 53/100, Loss: 8.653564e-06, LR: 5.00e-06
 54%|█████▍    | 54/100 [02:31<02:08,  2.78s/it]Fine-tune Epoch 54/100, Loss: 7.786324e-06, LR: 5.00e-06
 55%|█████▌    | 55/100 [02:34<02:06,  2.80s/it]Fine-tune Epoch 55/100, Loss: 8.021671e-06, LR: 5.00e-06
 56%|█████▌    | 56/100 [02:37<02:03,  2.81s/it]Fine-tune Epoch 56/100, Loss: 7.392065e-06, LR: 5.00e-06
 57%|█████▋    | 57/100 [02:40<02:01,  2.83s/it]Fine-tune Epoch 57/100, Loss: 7.587465e-06, LR: 5.00e-06
 58%|█████▊    | 58/100 [02:42<01:57,  2.80s/it]Fine-tune Epoch 58/100, Loss: 6.959866e-06, LR: 5.00e-06
 59%|█████▉    | 59/100 [02:45<01:56,  2.84s/it]Fine-tune Epoch 59/100, Loss: 7.122634e-06, LR: 5.00e-06
 60%|██████    | 60/100 [02:48<01:52,  2.82s/it]Fine-tune Epoch 60/100, Loss: 6.347038e-06, LR: 5.00e-06
 61%|██████    | 61/100 [02:51<01:49,  2.82s/it]Fine-tune Epoch 61/100, Loss: 6.059162e-06, LR: 5.00e-06
 62%|██████▏   | 62/100 [02:54<01:47,  2.84s/it]Fine-tune Epoch 62/100, Loss: 6.244258e-06, LR: 5.00e-06
 63%|██████▎   | 63/100 [02:57<01:45,  2.86s/it]Fine-tune Epoch 63/100, Loss: 6.036237e-06, LR: 5.00e-06
 64%|██████▍   | 64/100 [02:59<01:41,  2.81s/it]Fine-tune Epoch 64/100, Loss: 6.867313e-06, LR: 5.00e-06
 65%|██████▌   | 65/100 [03:02<01:37,  2.80s/it]Fine-tune Epoch 65/100, Loss: 5.207211e-06, LR: 5.00e-06
 66%|██████▌   | 66/100 [03:05<01:33,  2.75s/it]Fine-tune Epoch 66/100, Loss: 5.198282e-06, LR: 5.00e-06
 67%|██████▋   | 67/100 [03:07<01:30,  2.75s/it]Fine-tune Epoch 67/100, Loss: 6.109952e-06, LR: 5.00e-06
 68%|██████▊   | 68/100 [03:10<01:26,  2.70s/it]Fine-tune Epoch 68/100, Loss: 4.740064e-06, LR: 5.00e-06
 69%|██████▉   | 69/100 [03:13<01:25,  2.75s/it]Fine-tune Epoch 69/100, Loss: 4.776887e-06, LR: 5.00e-06
 70%|███████   | 70/100 [03:16<01:21,  2.72s/it]Fine-tune Epoch 70/100, Loss: 4.880578e-06, LR: 5.00e-06
 71%|███████   | 71/100 [03:18<01:19,  2.75s/it]Fine-tune Epoch 71/100, Loss: 5.116779e-06, LR: 5.00e-06
 72%|███████▏  | 72/100 [03:21<01:15,  2.71s/it]Fine-tune Epoch 72/100, Loss: 4.849728e-06, LR: 5.00e-06
 73%|███████▎  | 73/100 [03:24<01:13,  2.71s/it]Fine-tune Epoch 73/100, Loss: 4.097781e-06, LR: 5.00e-06
 74%|███████▍  | 74/100 [03:26<01:10,  2.71s/it]Fine-tune Epoch 74/100, Loss: 4.178543e-06, LR: 5.00e-06
 75%|███████▌  | 75/100 [03:29<01:08,  2.72s/it]Fine-tune Epoch 75/100, Loss: 4.371468e-06, LR: 5.00e-06
 76%|███████▌  | 76/100 [03:32<01:07,  2.81s/it]Fine-tune Epoch 76/100, Loss: 3.914695e-06, LR: 5.00e-06
 77%|███████▋  | 77/100 [03:35<01:04,  2.80s/it]Fine-tune Epoch 77/100, Loss: 4.761031e-06, LR: 5.00e-06
 78%|███████▊  | 78/100 [03:38<01:00,  2.73s/it]Fine-tune Epoch 78/100, Loss: 3.883752e-06, LR: 5.00e-06
 79%|███████▉  | 79/100 [03:40<00:56,  2.71s/it]Fine-tune Epoch 79/100, Loss: 4.342221e-06, LR: 5.00e-06
 80%|████████  | 80/100 [03:43<00:53,  2.69s/it]Fine-tune Epoch 80/100, Loss: 3.442192e-06, LR: 5.00e-06
 81%|████████  | 81/100 [03:46<00:52,  2.74s/it]Fine-tune Epoch 81/100, Loss: 4.135627e-06, LR: 5.00e-06
 82%|████████▏ | 82/100 [03:48<00:49,  2.75s/it]Fine-tune Epoch 82/100, Loss: 3.875599e-06, LR: 5.00e-06
 83%|████████▎ | 83/100 [03:51<00:47,  2.80s/it]Fine-tune Epoch 83/100, Loss: 3.498445e-06, LR: 5.00e-06
 84%|████████▍ | 84/100 [03:54<00:44,  2.79s/it]Fine-tune Epoch 84/100, Loss: 3.725005e-06, LR: 5.00e-06
 85%|████████▌ | 85/100 [03:57<00:41,  2.80s/it]Fine-tune Epoch 85/100, Loss: 3.080912e-06, LR: 5.00e-06
 86%|████████▌ | 86/100 [04:00<00:39,  2.85s/it]Fine-tune Epoch 86/100, Loss: 3.771261e-06, LR: 5.00e-06
 87%|████████▋ | 87/100 [04:03<00:37,  2.89s/it]Fine-tune Epoch 87/100, Loss: 3.273900e-06, LR: 5.00e-06
 88%|████████▊ | 88/100 [04:06<00:34,  2.88s/it]Fine-tune Epoch 88/100, Loss: 3.045493e-06, LR: 5.00e-06
 89%|████████▉ | 89/100 [04:09<00:32,  2.92s/it]Fine-tune Epoch 89/100, Loss: 3.818481e-06, LR: 5.00e-06
 90%|█████████ | 90/100 [04:12<00:28,  2.89s/it]Fine-tune Epoch 90/100, Loss: 2.837812e-06, LR: 5.00e-06
 91%|█████████ | 91/100 [04:14<00:25,  2.87s/it]Fine-tune Epoch 91/100, Loss: 3.363301e-06, LR: 5.00e-06
 92%|█████████▏| 92/100 [04:17<00:22,  2.86s/it]Fine-tune Epoch 92/100, Loss: 2.881110e-06, LR: 5.00e-06
 93%|█████████▎| 93/100 [04:20<00:19,  2.81s/it]Fine-tune Epoch 93/100, Loss: 3.114218e-06, LR: 5.00e-06
 94%|█████████▍| 94/100 [04:23<00:16,  2.83s/it]Fine-tune Epoch 94/100, Loss: 3.267707e-06, LR: 5.00e-06
 95%|█████████▌| 95/100 [04:26<00:14,  2.80s/it]Fine-tune Epoch 95/100, Loss: 2.850399e-06, LR: 5.00e-06
 96%|█████████▌| 96/100 [04:28<00:11,  2.80s/it]Fine-tune Epoch 96/100, Loss: 3.090986e-06, LR: 5.00e-06
 97%|█████████▋| 97/100 [04:31<00:08,  2.76s/it]Fine-tune Epoch 97/100, Loss: 2.637574e-06, LR: 5.00e-06
 98%|█████████▊| 98/100 [04:34<00:05,  2.70s/it]Fine-tune Epoch 98/100, Loss: 3.591543e-06, LR: 5.00e-06
 99%|█████████▉| 99/100 [04:36<00:02,  2.71s/it]Fine-tune Epoch 99/100, Loss: 2.198206e-06, LR: 5.00e-06
100%|██████████| 100/100 [04:39<00:00,  2.69s/it]100%|██████████| 100/100 [04:39<00:00,  2.79s/it]
Fine-tune Epoch 100/100, Loss: 3.111023e-06, LR: 5.00e-06

Final PSNR after pruning and fine-tuning: 60.7741
Pruning resulted in PSNR 60.77 which is below target 68.00. Consider less aggressive pruning.

Attempting to prune with ratio: 30%
Original hidden neurons: 150, New hidden neurons: 105 (Pruning 45 neurons)
New pruned model architecture:
MyResidualSirenNet(
  (net_layers): ModuleList(
    (0): SineLayer(
      (linear): Linear(in_features=3, out_features=105, bias=True)
    )
    (1-6): 6 x ResidualSineLayer(
      (linear_1): Linear(in_features=105, out_features=105, bias=True)
      (linear_2): Linear(in_features=105, out_features=105, bias=True)
    )
    (7): Linear(in_features=105, out_features=1, bias=True)
  )
)
New pruned model parameters: 134086
Parameter reduction: 50.80%

--- Fine-tuning pruned model for 100 epochs ---
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:02<04:23,  2.67s/it]Fine-tune Epoch 1/100, Loss: 4.755725e-02, LR: 5.00e-06
  2%|▏         | 2/100 [00:05<04:27,  2.73s/it]Fine-tune Epoch 2/100, Loss: 9.236701e-03, LR: 5.00e-06
  3%|▎         | 3/100 [00:08<04:23,  2.71s/it]Fine-tune Epoch 3/100, Loss: 3.646286e-03, LR: 5.00e-06
  4%|▍         | 4/100 [00:10<04:25,  2.76s/it]Fine-tune Epoch 4/100, Loss: 1.993373e-03, LR: 5.00e-06
  5%|▌         | 5/100 [00:13<04:19,  2.74s/it]Fine-tune Epoch 5/100, Loss: 1.277160e-03, LR: 5.00e-06
  6%|▌         | 6/100 [00:16<04:16,  2.73s/it]Fine-tune Epoch 6/100, Loss: 8.950621e-04, LR: 5.00e-06
  7%|▋         | 7/100 [00:19<04:14,  2.74s/it]Fine-tune Epoch 7/100, Loss: 6.678382e-04, LR: 5.00e-06
  8%|▊         | 8/100 [00:21<04:09,  2.72s/it]Fine-tune Epoch 8/100, Loss: 5.184973e-04, LR: 5.00e-06
  9%|▉         | 9/100 [00:24<04:07,  2.72s/it]Fine-tune Epoch 9/100, Loss: 4.146775e-04, LR: 5.00e-06
 10%|█         | 10/100 [00:27<04:08,  2.77s/it]Fine-tune Epoch 10/100, Loss: 3.399973e-04, LR: 5.00e-06
 11%|█         | 11/100 [00:30<04:06,  2.77s/it]Fine-tune Epoch 11/100, Loss: 2.835674e-04, LR: 5.00e-06
 12%|█▏        | 12/100 [00:33<04:07,  2.81s/it]Fine-tune Epoch 12/100, Loss: 2.407077e-04, LR: 5.00e-06
 13%|█▎        | 13/100 [00:35<04:05,  2.83s/it]Fine-tune Epoch 13/100, Loss: 2.064586e-04, LR: 5.00e-06
 14%|█▍        | 14/100 [00:38<03:59,  2.79s/it]Fine-tune Epoch 14/100, Loss: 1.797736e-04, LR: 5.00e-06
 15%|█▌        | 15/100 [00:41<03:54,  2.76s/it]Fine-tune Epoch 15/100, Loss: 1.571562e-04, LR: 5.00e-06
 16%|█▌        | 16/100 [00:44<03:53,  2.78s/it]Fine-tune Epoch 16/100, Loss: 1.385847e-04, LR: 5.00e-06
 17%|█▋        | 17/100 [00:46<03:45,  2.72s/it]Fine-tune Epoch 17/100, Loss: 1.232841e-04, LR: 5.00e-06
 18%|█▊        | 18/100 [00:49<03:44,  2.74s/it]Fine-tune Epoch 18/100, Loss: 1.103902e-04, LR: 5.00e-06
 19%|█▉        | 19/100 [00:52<03:38,  2.70s/it]Fine-tune Epoch 19/100, Loss: 9.944174e-05, LR: 5.00e-06
 20%|██        | 20/100 [00:55<03:42,  2.78s/it]Fine-tune Epoch 20/100, Loss: 8.956827e-05, LR: 5.00e-06
 21%|██        | 21/100 [00:57<03:38,  2.77s/it]Fine-tune Epoch 21/100, Loss: 8.110464e-05, LR: 5.00e-06
 22%|██▏       | 22/100 [01:00<03:38,  2.80s/it]Fine-tune Epoch 22/100, Loss: 7.426088e-05, LR: 5.00e-06
 23%|██▎       | 23/100 [01:03<03:35,  2.80s/it]Fine-tune Epoch 23/100, Loss: 6.762554e-05, LR: 5.00e-06
 24%|██▍       | 24/100 [01:06<03:31,  2.79s/it]Fine-tune Epoch 24/100, Loss: 6.189356e-05, LR: 5.00e-06
 25%|██▌       | 25/100 [01:09<03:28,  2.77s/it]Fine-tune Epoch 25/100, Loss: 5.697971e-05, LR: 5.00e-06
 26%|██▌       | 26/100 [01:11<03:23,  2.74s/it]Fine-tune Epoch 26/100, Loss: 5.242361e-05, LR: 5.00e-06
 27%|██▋       | 27/100 [01:14<03:22,  2.77s/it]Fine-tune Epoch 27/100, Loss: 4.828040e-05, LR: 5.00e-06
 28%|██▊       | 28/100 [01:17<03:20,  2.78s/it]Fine-tune Epoch 28/100, Loss: 4.479830e-05, LR: 5.00e-06
 29%|██▉       | 29/100 [01:20<03:18,  2.80s/it]Fine-tune Epoch 29/100, Loss: 4.120617e-05, LR: 5.00e-06
 30%|███       | 30/100 [01:23<03:20,  2.86s/it]Fine-tune Epoch 30/100, Loss: 3.846632e-05, LR: 5.00e-06
 31%|███       | 31/100 [01:25<03:09,  2.75s/it]Fine-tune Epoch 31/100, Loss: 3.570956e-05, LR: 5.00e-06
 32%|███▏      | 32/100 [01:28<03:09,  2.79s/it]Fine-tune Epoch 32/100, Loss: 3.319377e-05, LR: 5.00e-06
 33%|███▎      | 33/100 [01:31<03:01,  2.72s/it]Fine-tune Epoch 33/100, Loss: 3.092409e-05, LR: 5.00e-06
 34%|███▍      | 34/100 [01:33<03:02,  2.77s/it]Fine-tune Epoch 34/100, Loss: 2.933030e-05, LR: 5.00e-06
 35%|███▌      | 35/100 [01:36<02:59,  2.76s/it]Fine-tune Epoch 35/100, Loss: 2.728815e-05, LR: 5.00e-06
 36%|███▌      | 36/100 [01:39<02:54,  2.73s/it]Fine-tune Epoch 36/100, Loss: 2.565849e-05, LR: 5.00e-06
 37%|███▋      | 37/100 [01:42<02:55,  2.78s/it]Fine-tune Epoch 37/100, Loss: 2.383160e-05, LR: 5.00e-06
 38%|███▊      | 38/100 [01:45<02:54,  2.82s/it]Fine-tune Epoch 38/100, Loss: 2.286028e-05, LR: 5.00e-06
 39%|███▉      | 39/100 [01:47<02:49,  2.78s/it]Fine-tune Epoch 39/100, Loss: 2.120501e-05, LR: 5.00e-06
 40%|████      | 40/100 [01:50<02:49,  2.83s/it]Fine-tune Epoch 40/100, Loss: 2.010290e-05, LR: 5.00e-06
 41%|████      | 41/100 [01:53<02:45,  2.80s/it]Fine-tune Epoch 41/100, Loss: 1.907140e-05, LR: 5.00e-06
 42%|████▏     | 42/100 [01:56<02:41,  2.79s/it]Fine-tune Epoch 42/100, Loss: 1.841840e-05, LR: 5.00e-06
 43%|████▎     | 43/100 [01:59<02:40,  2.81s/it]Fine-tune Epoch 43/100, Loss: 1.722234e-05, LR: 5.00e-06
 44%|████▍     | 44/100 [02:02<02:38,  2.83s/it]Fine-tune Epoch 44/100, Loss: 1.626037e-05, LR: 5.00e-06
 45%|████▌     | 45/100 [02:04<02:31,  2.76s/it]Fine-tune Epoch 45/100, Loss: 1.531992e-05, LR: 5.00e-06
 46%|████▌     | 46/100 [02:07<02:29,  2.76s/it]Fine-tune Epoch 46/100, Loss: 1.436303e-05, LR: 5.00e-06
 47%|████▋     | 47/100 [02:10<02:24,  2.73s/it]Fine-tune Epoch 47/100, Loss: 1.396363e-05, LR: 5.00e-06
 48%|████▊     | 48/100 [02:12<02:22,  2.74s/it]Fine-tune Epoch 48/100, Loss: 1.344760e-05, LR: 5.00e-06
 49%|████▉     | 49/100 [02:15<02:19,  2.74s/it]Fine-tune Epoch 49/100, Loss: 1.240547e-05, LR: 5.00e-06
 50%|█████     | 50/100 [02:18<02:17,  2.75s/it]Fine-tune Epoch 50/100, Loss: 1.185287e-05, LR: 5.00e-06
 51%|█████     | 51/100 [02:21<02:13,  2.72s/it]Fine-tune Epoch 51/100, Loss: 1.152486e-05, LR: 5.00e-06
 52%|█████▏    | 52/100 [02:23<02:09,  2.70s/it]Fine-tune Epoch 52/100, Loss: 1.084815e-05, LR: 5.00e-06
 53%|█████▎    | 53/100 [02:26<02:07,  2.71s/it]Fine-tune Epoch 53/100, Loss: 1.049988e-05, LR: 5.00e-06
 54%|█████▍    | 54/100 [02:29<02:07,  2.77s/it]Fine-tune Epoch 54/100, Loss: 1.034091e-05, LR: 5.00e-06
 55%|█████▌    | 55/100 [02:32<02:04,  2.77s/it]Fine-tune Epoch 55/100, Loss: 9.887148e-06, LR: 5.00e-06
 56%|█████▌    | 56/100 [02:34<02:02,  2.79s/it]Fine-tune Epoch 56/100, Loss: 1.013118e-05, LR: 5.00e-06
 57%|█████▋    | 57/100 [02:37<02:00,  2.79s/it]Fine-tune Epoch 57/100, Loss: 8.766832e-06, LR: 5.00e-06
 58%|█████▊    | 58/100 [02:40<01:58,  2.83s/it]Fine-tune Epoch 58/100, Loss: 8.729918e-06, LR: 5.00e-06
 59%|█████▉    | 59/100 [02:43<01:56,  2.84s/it]Fine-tune Epoch 59/100, Loss: 8.233761e-06, LR: 5.00e-06
 60%|██████    | 60/100 [02:46<01:54,  2.87s/it]Fine-tune Epoch 60/100, Loss: 7.799427e-06, LR: 5.00e-06
 61%|██████    | 61/100 [02:49<01:49,  2.82s/it]Fine-tune Epoch 61/100, Loss: 8.254690e-06, LR: 5.00e-06
 62%|██████▏   | 62/100 [02:51<01:47,  2.83s/it]Fine-tune Epoch 62/100, Loss: 7.500114e-06, LR: 5.00e-06
 63%|██████▎   | 63/100 [02:54<01:43,  2.79s/it]Fine-tune Epoch 63/100, Loss: 7.315767e-06, LR: 5.00e-06
 64%|██████▍   | 64/100 [02:57<01:41,  2.81s/it]Fine-tune Epoch 64/100, Loss: 7.664711e-06, LR: 5.00e-06
 65%|██████▌   | 65/100 [03:00<01:36,  2.76s/it]Fine-tune Epoch 65/100, Loss: 6.931596e-06, LR: 5.00e-06
 66%|██████▌   | 66/100 [03:02<01:34,  2.78s/it]Fine-tune Epoch 66/100, Loss: 6.759111e-06, LR: 5.00e-06
 67%|██████▋   | 67/100 [03:05<01:32,  2.79s/it]Fine-tune Epoch 67/100, Loss: 5.971642e-06, LR: 5.00e-06
 68%|██████▊   | 68/100 [03:08<01:30,  2.82s/it]Fine-tune Epoch 68/100, Loss: 6.398429e-06, LR: 5.00e-06
 69%|██████▉   | 69/100 [03:11<01:25,  2.77s/it]Fine-tune Epoch 69/100, Loss: 5.819124e-06, LR: 5.00e-06
 70%|███████   | 70/100 [03:14<01:22,  2.75s/it]Fine-tune Epoch 70/100, Loss: 5.912289e-06, LR: 5.00e-06
 71%|███████   | 71/100 [03:16<01:20,  2.76s/it]Fine-tune Epoch 71/100, Loss: 6.279577e-06, LR: 5.00e-06
 72%|███████▏  | 72/100 [03:19<01:17,  2.77s/it]Fine-tune Epoch 72/100, Loss: 5.211052e-06, LR: 5.00e-06
 73%|███████▎  | 73/100 [03:22<01:14,  2.77s/it]Fine-tune Epoch 73/100, Loss: 5.723633e-06, LR: 5.00e-06
 74%|███████▍  | 74/100 [03:25<01:10,  2.72s/it]Fine-tune Epoch 74/100, Loss: 5.334512e-06, LR: 5.00e-06
 75%|███████▌  | 75/100 [03:27<01:07,  2.68s/it]Fine-tune Epoch 75/100, Loss: 4.724081e-06, LR: 5.00e-06
 76%|███████▌  | 76/100 [03:30<01:05,  2.75s/it]Fine-tune Epoch 76/100, Loss: 5.224721e-06, LR: 5.00e-06
 77%|███████▋  | 77/100 [03:33<01:02,  2.73s/it]Fine-tune Epoch 77/100, Loss: 4.986211e-06, LR: 5.00e-06
 78%|███████▊  | 78/100 [03:36<01:01,  2.79s/it]Fine-tune Epoch 78/100, Loss: 4.946988e-06, LR: 5.00e-06
 79%|███████▉  | 79/100 [03:38<00:57,  2.75s/it]Fine-tune Epoch 79/100, Loss: 4.659315e-06, LR: 5.00e-06
 80%|████████  | 80/100 [03:41<00:55,  2.75s/it]Fine-tune Epoch 80/100, Loss: 4.567541e-06, LR: 5.00e-06
 81%|████████  | 81/100 [03:44<00:51,  2.71s/it]Fine-tune Epoch 81/100, Loss: 4.313555e-06, LR: 5.00e-06
 82%|████████▏ | 82/100 [03:47<00:49,  2.77s/it]Fine-tune Epoch 82/100, Loss: 4.965410e-06, LR: 5.00e-06
 83%|████████▎ | 83/100 [03:49<00:46,  2.74s/it]Fine-tune Epoch 83/100, Loss: 4.279977e-06, LR: 5.00e-06
 84%|████████▍ | 84/100 [03:52<00:43,  2.72s/it]Fine-tune Epoch 84/100, Loss: 4.001031e-06, LR: 5.00e-06
 85%|████████▌ | 85/100 [03:55<00:40,  2.73s/it]Fine-tune Epoch 85/100, Loss: 4.320720e-06, LR: 5.00e-06
 86%|████████▌ | 86/100 [03:58<00:38,  2.77s/it]Fine-tune Epoch 86/100, Loss: 4.083999e-06, LR: 5.00e-06
 87%|████████▋ | 87/100 [04:00<00:35,  2.75s/it]Fine-tune Epoch 87/100, Loss: 3.846917e-06, LR: 5.00e-06
 88%|████████▊ | 88/100 [04:03<00:33,  2.77s/it]Fine-tune Epoch 88/100, Loss: 3.718576e-06, LR: 5.00e-06
 89%|████████▉ | 89/100 [04:06<00:29,  2.72s/it]Fine-tune Epoch 89/100, Loss: 3.976861e-06, LR: 5.00e-06
 90%|█████████ | 90/100 [04:09<00:27,  2.78s/it]Fine-tune Epoch 90/100, Loss: 4.225285e-06, LR: 5.00e-06
 91%|█████████ | 91/100 [04:11<00:25,  2.80s/it]Fine-tune Epoch 91/100, Loss: 4.115038e-06, LR: 5.00e-06
 92%|█████████▏| 92/100 [04:14<00:22,  2.79s/it]Fine-tune Epoch 92/100, Loss: 3.439314e-06, LR: 5.00e-06
 93%|█████████▎| 93/100 [04:17<00:19,  2.85s/it]Fine-tune Epoch 93/100, Loss: 3.417586e-06, LR: 5.00e-06
 94%|█████████▍| 94/100 [04:20<00:17,  2.85s/it]Fine-tune Epoch 94/100, Loss: 3.579381e-06, LR: 5.00e-06
 95%|█████████▌| 95/100 [04:23<00:14,  2.84s/it]Fine-tune Epoch 95/100, Loss: 3.092390e-06, LR: 5.00e-06
 96%|█████████▌| 96/100 [04:26<00:11,  2.85s/it]Fine-tune Epoch 96/100, Loss: 3.904844e-06, LR: 5.00e-06
 97%|█████████▋| 97/100 [04:29<00:08,  2.92s/it]Fine-tune Epoch 97/100, Loss: 3.312925e-06, LR: 5.00e-06
 98%|█████████▊| 98/100 [04:32<00:05,  2.87s/it]Fine-tune Epoch 98/100, Loss: 3.050113e-06, LR: 5.00e-06
 99%|█████████▉| 99/100 [04:35<00:02,  2.90s/it]Fine-tune Epoch 99/100, Loss: 3.220028e-06, LR: 5.00e-06
100%|██████████| 100/100 [04:37<00:00,  2.84s/it]100%|██████████| 100/100 [04:37<00:00,  2.78s/it]
Fine-tune Epoch 100/100, Loss: 3.135094e-06, LR: 5.00e-06

Final PSNR after pruning and fine-tuning: 62.3974
Pruning resulted in PSNR 62.40 which is below target 68.00. Consider less aggressive pruning.

--- Pruning Process Complete ---
Best pruned model found with 150 neurons and PSNR: 72.78
Original model parameters: 272551
Final pruned model parameters: 134086
Total parameter reduction: 50.80%
Loading original model from 150_neurons_mean.pth
Initial PSNR (Mean Model): 72.7811
Original model parameters: 272551

Attempting to prune with ratio: 5%
Calculating gradient-aware importance scores...
/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py:1344: UserWarning: Using a non-full backward hook when the forward contains multiple autograd Nodes is deprecated and will be removed in future versions. This hook will be missing some grad_input. Please use register_full_backward_hook to get the documented behavior.
  warnings.warn("Using a non-full backward hook when the forward contains multiple autograd Nodes "
Original hidden neurons: 150, New hidden neurons: 143 (Pruning 7 neurons)
New pruned model parameters: 0.25M

--- Fine-tuning pruned model for 50 epochs ---
  0%|          | 0/50 [00:00<?, ?it/s]  2%|▏         | 1/50 [00:02<02:12,  2.71s/it]  4%|▍         | 2/50 [00:05<02:11,  2.75s/it]  6%|▌         | 3/50 [00:08<02:07,  2.71s/it]  8%|▊         | 4/50 [00:10<02:04,  2.70s/it] 10%|█         | 5/50 [00:13<02:01,  2.69s/it] 12%|█▏        | 6/50 [00:16<01:59,  2.72s/it] 14%|█▍        | 7/50 [00:19<01:57,  2.74s/it] 16%|█▌        | 8/50 [00:21<01:57,  2.79s/it] 18%|█▊        | 9/50 [00:24<01:55,  2.81s/it] 20%|██        | 10/50 [00:27<01:53,  2.83s/it] 22%|██▏       | 11/50 [00:30<01:54,  2.94s/it] 24%|██▍       | 12/50 [00:33<01:50,  2.92s/it] 26%|██▌       | 13/50 [00:36<01:45,  2.85s/it] 28%|██▊       | 14/50 [00:39<01:42,  2.85s/it] 30%|███       | 15/50 [00:41<01:37,  2.77s/it] 32%|███▏      | 16/50 [00:44<01:34,  2.78s/it] 34%|███▍      | 17/50 [00:47<01:33,  2.84s/it] 36%|███▌      | 18/50 [00:50<01:31,  2.87s/it] 38%|███▊      | 19/50 [00:53<01:30,  2.92s/it] 40%|████      | 20/50 [00:56<01:26,  2.87s/it] 42%|████▏     | 21/50 [00:59<01:22,  2.84s/it] 44%|████▍     | 22/50 [01:02<01:19,  2.85s/it] 46%|████▌     | 23/50 [01:04<01:15,  2.80s/it] 48%|████▊     | 24/50 [01:07<01:14,  2.88s/it] 50%|█████     | 25/50 [01:10<01:10,  2.84s/it] 52%|█████▏    | 26/50 [01:13<01:08,  2.87s/it] 54%|█████▍    | 27/50 [01:16<01:04,  2.81s/it] 56%|█████▌    | 28/50 [01:18<01:00,  2.76s/it] 58%|█████▊    | 29/50 [01:21<00:56,  2.69s/it] 60%|██████    | 30/50 [01:24<00:55,  2.75s/it] 62%|██████▏   | 31/50 [01:26<00:50,  2.68s/it] 64%|██████▍   | 32/50 [01:29<00:48,  2.69s/it] 66%|██████▌   | 33/50 [01:32<00:45,  2.70s/it] 68%|██████▊   | 34/50 [01:34<00:43,  2.74s/it] 70%|███████   | 35/50 [01:37<00:40,  2.72s/it] 72%|███████▏  | 36/50 [01:40<00:38,  2.78s/it] 74%|███████▍  | 37/50 [01:43<00:35,  2.73s/it] 76%|███████▌  | 38/50 [01:45<00:32,  2.75s/it] 78%|███████▊  | 39/50 [01:48<00:29,  2.68s/it] 80%|████████  | 40/50 [01:51<00:26,  2.68s/it] 82%|████████▏ | 41/50 [01:53<00:24,  2.68s/it] 84%|████████▍ | 42/50 [01:56<00:21,  2.72s/it] 86%|████████▌ | 43/50 [01:59<00:19,  2.74s/it] 88%|████████▊ | 44/50 [02:02<00:17,  2.85s/it] 90%|█████████ | 45/50 [02:05<00:14,  2.91s/it] 92%|█████████▏| 46/50 [02:08<00:11,  2.88s/it] 94%|█████████▍| 47/50 [02:11<00:08,  2.82s/it] 96%|█████████▌| 48/50 [02:13<00:05,  2.83s/it] 98%|█████████▊| 49/50 [02:16<00:02,  2.78s/it]100%|██████████| 50/50 [02:19<00:00,  2.79s/it]100%|██████████| 50/50 [02:19<00:00,  2.79s/it]

Final PSNR after pruning and fine-tuning: 66.1818
Pruning failed to meet PSNR target 68.00.

Attempting to prune with ratio: 10%
Calculating gradient-aware importance scores...
Original hidden neurons: 150, New hidden neurons: 135 (Pruning 15 neurons)
New pruned model parameters: 0.22M

--- Fine-tuning pruned model for 50 epochs ---
  0%|          | 0/50 [00:00<?, ?it/s]  2%|▏         | 1/50 [00:02<02:04,  2.55s/it]  4%|▍         | 2/50 [00:05<02:10,  2.71s/it]  6%|▌         | 3/50 [00:08<02:06,  2.70s/it]  8%|▊         | 4/50 [00:10<02:02,  2.67s/it] 10%|█         | 5/50 [00:13<02:02,  2.71s/it] 12%|█▏        | 6/50 [00:16<02:01,  2.76s/it] 14%|█▍        | 7/50 [00:19<02:00,  2.81s/it] 16%|█▌        | 8/50 [00:21<01:56,  2.78s/it] 18%|█▊        | 9/50 [00:24<01:54,  2.80s/it] 20%|██        | 10/50 [00:27<01:51,  2.78s/it] 22%|██▏       | 11/50 [00:30<01:46,  2.73s/it] 24%|██▍       | 12/50 [00:32<01:44,  2.75s/it] 26%|██▌       | 13/50 [00:35<01:40,  2.72s/it] 28%|██▊       | 14/50 [00:38<01:38,  2.73s/it] 30%|███       | 15/50 [00:40<01:34,  2.69s/it] 32%|███▏      | 16/50 [00:43<01:31,  2.68s/it] 34%|███▍      | 17/50 [00:46<01:29,  2.71s/it] 36%|███▌      | 18/50 [00:49<01:27,  2.73s/it] 38%|███▊      | 19/50 [00:52<01:26,  2.78s/it] 40%|████      | 20/50 [00:54<01:22,  2.76s/it] 42%|████▏     | 21/50 [00:57<01:20,  2.77s/it] 44%|████▍     | 22/50 [01:00<01:18,  2.82s/it] 46%|████▌     | 23/50 [01:03<01:14,  2.75s/it] 48%|████▊     | 24/50 [01:06<01:13,  2.81s/it] 50%|█████     | 25/50 [01:08<01:11,  2.85s/it] 52%|█████▏    | 26/50 [01:11<01:07,  2.81s/it] 54%|█████▍    | 27/50 [01:14<01:04,  2.78s/it] 56%|█████▌    | 28/50 [01:17<01:00,  2.75s/it] 58%|█████▊    | 29/50 [01:19<00:57,  2.76s/it] 60%|██████    | 30/50 [01:22<00:55,  2.79s/it] 62%|██████▏   | 31/50 [01:25<00:51,  2.72s/it] 64%|██████▍   | 32/50 [01:28<00:50,  2.79s/it] 66%|██████▌   | 33/50 [01:30<00:46,  2.76s/it] 68%|██████▊   | 34/50 [01:33<00:44,  2.79s/it] 70%|███████   | 35/50 [01:36<00:40,  2.72s/it] 72%|███████▏  | 36/50 [01:39<00:38,  2.77s/it] 74%|███████▍  | 37/50 [01:41<00:35,  2.77s/it] 76%|███████▌  | 38/50 [01:44<00:33,  2.76s/it] 78%|███████▊  | 39/50 [01:47<00:30,  2.78s/it] 80%|████████  | 40/50 [01:50<00:27,  2.79s/it] 82%|████████▏ | 41/50 [01:53<00:24,  2.76s/it] 84%|████████▍ | 42/50 [01:55<00:22,  2.78s/it] 86%|████████▌ | 43/50 [01:58<00:19,  2.72s/it] 88%|████████▊ | 44/50 [02:01<00:16,  2.77s/it] 90%|█████████ | 45/50 [02:03<00:13,  2.72s/it] 92%|█████████▏| 46/50 [02:06<00:10,  2.71s/it] 94%|█████████▍| 47/50 [02:09<00:08,  2.71s/it] 96%|█████████▌| 48/50 [02:12<00:05,  2.78s/it] 98%|█████████▊| 49/50 [02:14<00:02,  2.74s/it]100%|██████████| 50/50 [02:17<00:00,  2.74s/it]100%|██████████| 50/50 [02:17<00:00,  2.75s/it]

Final PSNR after pruning and fine-tuning: 64.3593
Pruning failed to meet PSNR target 68.00.

Attempting to prune with ratio: 15%
Calculating gradient-aware importance scores...
Original hidden neurons: 150, New hidden neurons: 128 (Pruning 22 neurons)
New pruned model parameters: 0.20M

--- Fine-tuning pruned model for 50 epochs ---
  0%|          | 0/50 [00:00<?, ?it/s]  2%|▏         | 1/50 [00:02<02:16,  2.78s/it]  4%|▍         | 2/50 [00:05<02:14,  2.81s/it]  6%|▌         | 3/50 [00:08<02:13,  2.84s/it]  8%|▊         | 4/50 [00:11<02:07,  2.78s/it] 10%|█         | 5/50 [00:13<02:05,  2.79s/it] 12%|█▏        | 6/50 [00:16<02:02,  2.79s/it] 14%|█▍        | 7/50 [00:19<02:01,  2.83s/it] 16%|█▌        | 8/50 [00:22<01:56,  2.77s/it] 18%|█▊        | 9/50 [00:25<01:54,  2.80s/it] 20%|██        | 10/50 [00:27<01:49,  2.74s/it] 22%|██▏       | 11/50 [00:30<01:49,  2.81s/it] 24%|██▍       | 12/50 [00:33<01:45,  2.79s/it] 26%|██▌       | 13/50 [00:36<01:42,  2.76s/it] 28%|██▊       | 14/50 [00:39<01:39,  2.78s/it] 30%|███       | 15/50 [00:41<01:36,  2.75s/it] 32%|███▏      | 16/50 [00:44<01:31,  2.70s/it] 34%|███▍      | 17/50 [00:47<01:29,  2.72s/it] 36%|███▌      | 18/50 [00:49<01:27,  2.73s/it] 38%|███▊      | 19/50 [00:52<01:27,  2.81s/it] 40%|████      | 20/50 [00:55<01:23,  2.80s/it] 42%|████▏     | 21/50 [00:58<01:21,  2.80s/it] 44%|████▍     | 22/50 [01:01<01:17,  2.79s/it] 46%|████▌     | 23/50 [01:04<01:16,  2.84s/it] 48%|████▊     | 24/50 [01:06<01:13,  2.81s/it] 50%|█████     | 25/50 [01:09<01:09,  2.78s/it] 52%|█████▏    | 26/50 [01:12<01:06,  2.76s/it] 54%|█████▍    | 27/50 [01:14<01:03,  2.74s/it] 56%|█████▌    | 28/50 [01:17<00:59,  2.69s/it] 58%|█████▊    | 29/50 [01:20<00:56,  2.69s/it] 60%|██████    | 30/50 [01:22<00:54,  2.72s/it] 62%|██████▏   | 31/50 [01:25<00:52,  2.79s/it] 64%|██████▍   | 32/50 [01:28<00:50,  2.83s/it] 66%|██████▌   | 33/50 [01:31<00:48,  2.82s/it] 68%|██████▊   | 34/50 [01:34<00:44,  2.76s/it] 70%|███████   | 35/50 [01:37<00:41,  2.77s/it] 72%|███████▏  | 36/50 [01:39<00:38,  2.76s/it] 74%|███████▍  | 37/50 [01:42<00:36,  2.83s/it] 76%|███████▌  | 38/50 [01:45<00:34,  2.84s/it] 78%|███████▊  | 39/50 [01:48<00:31,  2.84s/it] 80%|████████  | 40/50 [01:51<00:28,  2.85s/it] 82%|████████▏ | 41/50 [01:54<00:25,  2.87s/it] 84%|████████▍ | 42/50 [01:57<00:23,  2.88s/it] 86%|████████▌ | 43/50 [02:00<00:20,  2.89s/it] 88%|████████▊ | 44/50 [02:02<00:17,  2.87s/it] 90%|█████████ | 45/50 [02:05<00:14,  2.85s/it] 92%|█████████▏| 46/50 [02:08<00:11,  2.76s/it] 94%|█████████▍| 47/50 [02:11<00:08,  2.78s/it] 96%|█████████▌| 48/50 [02:13<00:05,  2.78s/it] 98%|█████████▊| 49/50 [02:16<00:02,  2.76s/it]100%|██████████| 50/50 [02:19<00:00,  2.76s/it]100%|██████████| 50/50 [02:19<00:00,  2.79s/it]

Final PSNR after pruning and fine-tuning: 63.3556
Pruning failed to meet PSNR target 68.00.

Attempting to prune with ratio: 20%
Calculating gradient-aware importance scores...
Original hidden neurons: 150, New hidden neurons: 120 (Pruning 30 neurons)
New pruned model parameters: 0.17M

--- Fine-tuning pruned model for 50 epochs ---
  0%|          | 0/50 [00:00<?, ?it/s]  2%|▏         | 1/50 [00:02<02:16,  2.79s/it]  4%|▍         | 2/50 [00:05<02:14,  2.81s/it]  6%|▌         | 3/50 [00:08<02:13,  2.84s/it]  8%|▊         | 4/50 [00:11<02:12,  2.88s/it] 10%|█         | 5/50 [00:14<02:08,  2.85s/it] 12%|█▏        | 6/50 [00:17<02:05,  2.85s/it] 14%|█▍        | 7/50 [00:20<02:04,  2.90s/it] 16%|█▌        | 8/50 [00:22<02:01,  2.90s/it] 18%|█▊        | 9/50 [00:25<01:58,  2.89s/it] 20%|██        | 10/50 [00:28<01:55,  2.90s/it] 22%|██▏       | 11/50 [00:31<01:53,  2.91s/it] 24%|██▍       | 12/50 [00:34<01:49,  2.88s/it] 26%|██▌       | 13/50 [00:37<01:44,  2.81s/it] 28%|██▊       | 14/50 [00:40<01:43,  2.88s/it] 30%|███       | 15/50 [00:43<01:41,  2.90s/it] 32%|███▏      | 16/50 [00:46<01:38,  2.89s/it] 34%|███▍      | 17/50 [00:48<01:34,  2.87s/it] 36%|███▌      | 18/50 [00:51<01:31,  2.85s/it] 38%|███▊      | 19/50 [00:54<01:28,  2.86s/it] 40%|████      | 20/50 [00:57<01:27,  2.91s/it] 42%|████▏     | 21/50 [01:00<01:24,  2.92s/it] 44%|████▍     | 22/50 [01:03<01:21,  2.90s/it] 46%|████▌     | 23/50 [01:06<01:17,  2.86s/it] 48%|████▊     | 24/50 [01:08<01:13,  2.84s/it] 50%|█████     | 25/50 [01:11<01:11,  2.86s/it] 52%|█████▏    | 26/50 [01:14<01:08,  2.84s/it] 54%|█████▍    | 27/50 [01:17<01:06,  2.90s/it] 56%|█████▌    | 28/50 [01:20<01:03,  2.87s/it] 58%|█████▊    | 29/50 [01:23<01:00,  2.89s/it] 60%|██████    | 30/50 [01:26<00:56,  2.83s/it] 62%|██████▏   | 31/50 [01:28<00:53,  2.82s/it] 64%|██████▍   | 32/50 [01:31<00:51,  2.87s/it] 66%|██████▌   | 33/50 [01:34<00:50,  2.95s/it] 68%|██████▊   | 34/50 [01:37<00:47,  2.94s/it] 70%|███████   | 35/50 [01:40<00:44,  2.95s/it] 72%|███████▏  | 36/50 [01:43<00:39,  2.85s/it] 74%|███████▍  | 37/50 [01:46<00:37,  2.85s/it] 76%|███████▌  | 38/50 [01:49<00:34,  2.88s/it] 78%|███████▊  | 39/50 [01:52<00:32,  2.94s/it] 80%|████████  | 40/50 [01:55<00:29,  2.90s/it] 82%|████████▏ | 41/50 [01:58<00:26,  2.90s/it] 84%|████████▍ | 42/50 [02:00<00:23,  2.89s/it] 86%|████████▌ | 43/50 [02:03<00:19,  2.85s/it] 88%|████████▊ | 44/50 [02:06<00:17,  2.92s/it] 90%|█████████ | 45/50 [02:09<00:14,  2.91s/it] 92%|█████████▏| 46/50 [02:12<00:11,  2.92s/it] 94%|█████████▍| 47/50 [02:15<00:08,  2.90s/it] 96%|█████████▌| 48/50 [02:18<00:05,  2.92s/it] 98%|█████████▊| 49/50 [02:21<00:02,  2.84s/it]100%|██████████| 50/50 [02:23<00:00,  2.83s/it]100%|██████████| 50/50 [02:23<00:00,  2.88s/it]

Final PSNR after pruning and fine-tuning: 62.6691
Pruning failed to meet PSNR target 68.00.

Attempting to prune with ratio: 25%
Calculating gradient-aware importance scores...
Original hidden neurons: 150, New hidden neurons: 113 (Pruning 37 neurons)
New pruned model parameters: 0.16M

--- Fine-tuning pruned model for 50 epochs ---
  0%|          | 0/50 [00:00<?, ?it/s]  2%|▏         | 1/50 [00:02<02:11,  2.69s/it]  4%|▍         | 2/50 [00:05<02:16,  2.84s/it]  6%|▌         | 3/50 [00:08<02:13,  2.85s/it]  8%|▊         | 4/50 [00:11<02:11,  2.86s/it] 10%|█         | 5/50 [00:14<02:09,  2.88s/it] 12%|█▏        | 6/50 [00:17<02:04,  2.84s/it] 14%|█▍        | 7/50 [00:19<02:02,  2.84s/it] 16%|█▌        | 8/50 [00:22<01:59,  2.85s/it] 18%|█▊        | 9/50 [00:25<01:56,  2.83s/it] 20%|██        | 10/50 [00:28<01:53,  2.85s/it] 22%|██▏       | 11/50 [00:31<01:52,  2.89s/it] 24%|██▍       | 12/50 [00:34<01:50,  2.91s/it] 26%|██▌       | 13/50 [00:37<01:48,  2.94s/it] 28%|██▊       | 14/50 [00:40<01:46,  2.95s/it] 30%|███       | 15/50 [00:43<01:42,  2.94s/it] 32%|███▏      | 16/50 [00:46<01:38,  2.91s/it] 34%|███▍      | 17/50 [00:48<01:35,  2.90s/it] 36%|███▌      | 18/50 [00:51<01:29,  2.81s/it] 38%|███▊      | 19/50 [00:54<01:28,  2.85s/it] 40%|████      | 20/50 [00:57<01:27,  2.91s/it] 42%|████▏     | 21/50 [01:00<01:22,  2.83s/it] 44%|████▍     | 22/50 [01:03<01:21,  2.90s/it] 46%|████▌     | 23/50 [01:06<01:17,  2.88s/it] 48%|████▊     | 24/50 [01:09<01:14,  2.88s/it] 50%|█████     | 25/50 [01:11<01:10,  2.83s/it] 52%|█████▏    | 26/50 [01:14<01:08,  2.85s/it] 54%|█████▍    | 27/50 [01:17<01:06,  2.88s/it] 56%|█████▌    | 28/50 [01:20<01:01,  2.80s/it] 58%|█████▊    | 29/50 [01:23<00:59,  2.81s/it] 60%|██████    | 30/50 [01:25<00:56,  2.82s/it] 62%|██████▏   | 31/50 [01:28<00:54,  2.85s/it] 64%|██████▍   | 32/50 [01:31<00:51,  2.87s/it] 66%|██████▌   | 33/50 [01:34<00:48,  2.86s/it] 68%|██████▊   | 34/50 [01:37<00:45,  2.86s/it] 70%|███████   | 35/50 [01:40<00:42,  2.85s/it] 72%|███████▏  | 36/50 [01:42<00:38,  2.76s/it] 74%|███████▍  | 37/50 [01:45<00:35,  2.74s/it] 76%|███████▌  | 38/50 [01:48<00:32,  2.72s/it] 78%|███████▊  | 39/50 [01:50<00:30,  2.75s/it] 80%|████████  | 40/50 [01:53<00:27,  2.72s/it] 82%|████████▏ | 41/50 [01:56<00:24,  2.73s/it] 84%|████████▍ | 42/50 [01:59<00:21,  2.74s/it] 86%|████████▌ | 43/50 [02:02<00:19,  2.80s/it] 88%|████████▊ | 44/50 [02:04<00:16,  2.80s/it] 90%|█████████ | 45/50 [02:07<00:13,  2.74s/it] 92%|█████████▏| 46/50 [02:10<00:11,  2.75s/it] 94%|█████████▍| 47/50 [02:13<00:08,  2.80s/it] 96%|█████████▌| 48/50 [02:15<00:05,  2.75s/it] 98%|█████████▊| 49/50 [02:18<00:02,  2.83s/it]100%|██████████| 50/50 [02:21<00:00,  2.87s/it]100%|██████████| 50/50 [02:21<00:00,  2.84s/it]

Final PSNR after pruning and fine-tuning: 60.9030
Pruning failed to meet PSNR target 68.00.

Attempting to prune with ratio: 30%
Calculating gradient-aware importance scores...
Original hidden neurons: 150, New hidden neurons: 105 (Pruning 45 neurons)
New pruned model parameters: 0.13M

--- Fine-tuning pruned model for 50 epochs ---
  0%|          | 0/50 [00:00<?, ?it/s]  2%|▏         | 1/50 [00:02<02:08,  2.62s/it]  4%|▍         | 2/50 [00:05<02:08,  2.67s/it]  6%|▌         | 3/50 [00:07<02:03,  2.63s/it]  8%|▊         | 4/50 [00:10<02:05,  2.72s/it] 10%|█         | 5/50 [00:13<01:59,  2.64s/it] 12%|█▏        | 6/50 [00:15<01:56,  2.64s/it] 14%|█▍        | 7/50 [00:18<01:53,  2.63s/it] 16%|█▌        | 8/50 [00:21<01:48,  2.59s/it] 18%|█▊        | 9/50 [00:23<01:46,  2.60s/it] 20%|██        | 10/50 [00:26<01:46,  2.66s/it] 22%|██▏       | 11/50 [00:29<01:43,  2.66s/it] 24%|██▍       | 12/50 [00:31<01:42,  2.69s/it] 26%|██▌       | 13/50 [00:34<01:38,  2.65s/it] 28%|██▊       | 14/50 [00:37<01:35,  2.65s/it] 30%|███       | 15/50 [00:39<01:34,  2.70s/it] 32%|███▏      | 16/50 [00:42<01:33,  2.76s/it] 34%|███▍      | 17/50 [00:45<01:30,  2.73s/it] 36%|███▌      | 18/50 [00:48<01:27,  2.74s/it] 38%|███▊      | 19/50 [00:51<01:25,  2.76s/it] 40%|████      | 20/50 [00:53<01:22,  2.74s/it] 42%|████▏     | 21/50 [00:56<01:19,  2.75s/it] 44%|████▍     | 22/50 [00:59<01:16,  2.74s/it] 46%|████▌     | 23/50 [01:01<01:13,  2.74s/it] 48%|████▊     | 24/50 [01:04<01:09,  2.69s/it] 50%|█████     | 25/50 [01:07<01:06,  2.66s/it] 52%|█████▏    | 26/50 [01:09<01:04,  2.71s/it] 54%|█████▍    | 27/50 [01:12<01:02,  2.73s/it] 56%|█████▌    | 28/50 [01:15<01:00,  2.75s/it] 58%|█████▊    | 29/50 [01:18<00:58,  2.79s/it] 60%|██████    | 30/50 [01:21<00:56,  2.82s/it] 62%|██████▏   | 31/50 [01:23<00:52,  2.78s/it] 64%|██████▍   | 32/50 [01:26<00:50,  2.79s/it] 66%|██████▌   | 33/50 [01:29<00:46,  2.76s/it] 68%|██████▊   | 34/50 [01:32<00:44,  2.78s/it] 70%|███████   | 35/50 [01:35<00:41,  2.77s/it] 72%|███████▏  | 36/50 [01:37<00:39,  2.79s/it] 74%|███████▍  | 37/50 [01:40<00:35,  2.73s/it] 76%|███████▌  | 38/50 [01:43<00:33,  2.75s/it] 78%|███████▊  | 39/50 [01:45<00:29,  2.71s/it] 80%|████████  | 40/50 [01:48<00:27,  2.70s/it] 82%|████████▏ | 41/50 [01:51<00:24,  2.71s/it] 84%|████████▍ | 42/50 [01:54<00:21,  2.71s/it] 86%|████████▌ | 43/50 [01:56<00:19,  2.72s/it] 88%|████████▊ | 44/50 [01:59<00:16,  2.72s/it] 90%|█████████ | 45/50 [02:02<00:13,  2.69s/it] 92%|█████████▏| 46/50 [02:04<00:10,  2.69s/it] 94%|█████████▍| 47/50 [02:07<00:08,  2.69s/it] 96%|█████████▌| 48/50 [02:10<00:05,  2.65s/it] 98%|█████████▊| 49/50 [02:12<00:02,  2.69s/it]100%|██████████| 50/50 [02:15<00:00,  2.68s/it]100%|██████████| 50/50 [02:15<00:00,  2.71s/it]

Final PSNR after pruning and fine-tuning: 59.4289
Pruning failed to meet PSNR target 68.00.

--- Pruning Process Complete ---
Best pruned model found with 150 neurons and PSNR: 72.78
Original model parameters: 272551
Final pruned model parameters: 134086
Total parameter reduction: 50.80%
MyResidualSirenNet(
  (net_layers): ModuleList(
    (0): SineLayer(
      (linear): Linear(in_features=3, out_features=150, bias=True)
    )
    (1-6): 6 x ResidualSineLayer(
      (linear_1): Linear(in_features=150, out_features=150, bias=True)
      (linear_2): Linear(in_features=150, out_features=150, bias=True)
    )
    (7): Linear(in_features=150, out_features=1, bias=True)
  )
)
Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 5e-05
    maximize: False
    weight_decay: 0
)
MSELoss()

Learning Rate: 5e-05
Max Epochs: 200
Batch Size: 2048
Number of Hidden Layers: 6
Number of Neurons per Layer: 150
Decay Rate: 0.8
Rate decays every 15 epochs.

(262144, 1)
std 61.88234407254285
RMSE: 0.0016103222439553691
Loading original model from 150_neurons_std.pth
Initial PSNR (std Model): 61.8823
Original model parameters: 272551

--- Starting Iterative Pruning ---

Attempting to prune with ratio: 5%
Original hidden neurons: 150, New hidden neurons: 143 (Pruning 7 neurons)
New pruned model architecture:
MyResidualSirenNet(
  (net_layers): ModuleList(
    (0): SineLayer(
      (linear): Linear(in_features=3, out_features=143, bias=True)
    )
    (1-6): 6 x ResidualSineLayer(
      (linear_1): Linear(in_features=143, out_features=143, bias=True)
      (linear_2): Linear(in_features=143, out_features=143, bias=True)
    )
    (7): Linear(in_features=143, out_features=1, bias=True)
  )
)
New pruned model parameters: 247820
Parameter reduction: 9.07%

--- Fine-tuning pruned model for 100 epochs ---
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:02<04:27,  2.70s/it]Fine-tune Epoch 1/100, Loss: 3.412865e-03, LR: 5.00e-06
  2%|▏         | 2/100 [00:05<04:35,  2.82s/it]Fine-tune Epoch 2/100, Loss: 2.464716e-03, LR: 5.00e-06
  3%|▎         | 3/100 [00:08<04:40,  2.89s/it]Fine-tune Epoch 3/100, Loss: 2.045909e-03, LR: 5.00e-06
  4%|▍         | 4/100 [00:11<04:45,  2.97s/it]Fine-tune Epoch 4/100, Loss: 1.775539e-03, LR: 5.00e-06
  5%|▌         | 5/100 [00:14<04:27,  2.81s/it]Fine-tune Epoch 5/100, Loss: 1.579405e-03, LR: 5.00e-06
  6%|▌         | 6/100 [00:17<04:27,  2.85s/it]Fine-tune Epoch 6/100, Loss: 1.427540e-03, LR: 5.00e-06
  7%|▋         | 7/100 [00:19<04:20,  2.80s/it]Fine-tune Epoch 7/100, Loss: 1.305421e-03, LR: 5.00e-06
  8%|▊         | 8/100 [00:22<04:21,  2.84s/it]Fine-tune Epoch 8/100, Loss: 1.202817e-03, LR: 5.00e-06
  9%|▉         | 9/100 [00:25<04:15,  2.81s/it]Fine-tune Epoch 9/100, Loss: 1.115233e-03, LR: 5.00e-06
 10%|█         | 10/100 [00:28<04:13,  2.81s/it]Fine-tune Epoch 10/100, Loss: 1.039268e-03, LR: 5.00e-06
 11%|█         | 11/100 [00:30<04:06,  2.77s/it]Fine-tune Epoch 11/100, Loss: 9.724090e-04, LR: 5.00e-06
 12%|█▏        | 12/100 [00:33<04:02,  2.75s/it]Fine-tune Epoch 12/100, Loss: 9.128514e-04, LR: 5.00e-06
 13%|█▎        | 13/100 [00:36<03:59,  2.75s/it]Fine-tune Epoch 13/100, Loss: 8.592654e-04, LR: 5.00e-06
 14%|█▍        | 14/100 [00:39<03:57,  2.76s/it]Fine-tune Epoch 14/100, Loss: 8.103175e-04, LR: 5.00e-06
 15%|█▌        | 15/100 [00:41<03:53,  2.75s/it]Fine-tune Epoch 15/100, Loss: 7.664941e-04, LR: 5.00e-06
 16%|█▌        | 16/100 [00:44<03:54,  2.79s/it]Fine-tune Epoch 16/100, Loss: 7.255324e-04, LR: 5.00e-06
 17%|█▋        | 17/100 [00:47<03:48,  2.75s/it]Fine-tune Epoch 17/100, Loss: 6.880490e-04, LR: 5.00e-06
 18%|█▊        | 18/100 [00:50<03:48,  2.79s/it]Fine-tune Epoch 18/100, Loss: 6.534131e-04, LR: 5.00e-06
 19%|█▉        | 19/100 [00:53<03:45,  2.79s/it]Fine-tune Epoch 19/100, Loss: 6.214130e-04, LR: 5.00e-06
 20%|██        | 20/100 [00:56<03:47,  2.84s/it]Fine-tune Epoch 20/100, Loss: 5.913209e-04, LR: 5.00e-06
 21%|██        | 21/100 [00:58<03:37,  2.76s/it]Fine-tune Epoch 21/100, Loss: 5.638623e-04, LR: 5.00e-06
 22%|██▏       | 22/100 [01:01<03:36,  2.78s/it]Fine-tune Epoch 22/100, Loss: 5.378339e-04, LR: 5.00e-06
 23%|██▎       | 23/100 [01:04<03:28,  2.71s/it]Fine-tune Epoch 23/100, Loss: 5.134307e-04, LR: 5.00e-06
 24%|██▍       | 24/100 [01:06<03:27,  2.73s/it]Fine-tune Epoch 24/100, Loss: 4.905285e-04, LR: 5.00e-06
 25%|██▌       | 25/100 [01:09<03:23,  2.71s/it]Fine-tune Epoch 25/100, Loss: 4.695327e-04, LR: 5.00e-06
 26%|██▌       | 26/100 [01:12<03:18,  2.68s/it]Fine-tune Epoch 26/100, Loss: 4.491420e-04, LR: 5.00e-06
 27%|██▋       | 27/100 [01:14<03:18,  2.72s/it]Fine-tune Epoch 27/100, Loss: 4.299960e-04, LR: 5.00e-06
 28%|██▊       | 28/100 [01:17<03:15,  2.71s/it]Fine-tune Epoch 28/100, Loss: 4.119557e-04, LR: 5.00e-06
 29%|██▉       | 29/100 [01:20<03:10,  2.68s/it]Fine-tune Epoch 29/100, Loss: 3.952804e-04, LR: 5.00e-06
 30%|███       | 30/100 [01:23<03:09,  2.71s/it]Fine-tune Epoch 30/100, Loss: 3.793484e-04, LR: 5.00e-06
 31%|███       | 31/100 [01:25<03:07,  2.71s/it]Fine-tune Epoch 31/100, Loss: 3.644230e-04, LR: 5.00e-06
 32%|███▏      | 32/100 [01:28<03:05,  2.72s/it]Fine-tune Epoch 32/100, Loss: 3.499935e-04, LR: 5.00e-06
 33%|███▎      | 33/100 [01:31<03:00,  2.70s/it]Fine-tune Epoch 33/100, Loss: 3.366856e-04, LR: 5.00e-06
 34%|███▍      | 34/100 [01:33<02:59,  2.73s/it]Fine-tune Epoch 34/100, Loss: 3.239416e-04, LR: 5.00e-06
 35%|███▌      | 35/100 [01:36<02:57,  2.73s/it]Fine-tune Epoch 35/100, Loss: 3.117647e-04, LR: 5.00e-06
 36%|███▌      | 36/100 [01:39<02:56,  2.76s/it]Fine-tune Epoch 36/100, Loss: 3.003969e-04, LR: 5.00e-06
 37%|███▋      | 37/100 [01:42<02:51,  2.72s/it]Fine-tune Epoch 37/100, Loss: 2.896740e-04, LR: 5.00e-06
 38%|███▊      | 38/100 [01:44<02:47,  2.70s/it]Fine-tune Epoch 38/100, Loss: 2.793528e-04, LR: 5.00e-06
 39%|███▉      | 39/100 [01:47<02:50,  2.79s/it]Fine-tune Epoch 39/100, Loss: 2.695245e-04, LR: 5.00e-06
 40%|████      | 40/100 [01:50<02:48,  2.81s/it]Fine-tune Epoch 40/100, Loss: 2.602723e-04, LR: 5.00e-06
 41%|████      | 41/100 [01:53<02:42,  2.76s/it]Fine-tune Epoch 41/100, Loss: 2.514263e-04, LR: 5.00e-06
 42%|████▏     | 42/100 [01:56<02:44,  2.84s/it]Fine-tune Epoch 42/100, Loss: 2.428342e-04, LR: 5.00e-06
 43%|████▎     | 43/100 [01:59<02:40,  2.82s/it]Fine-tune Epoch 43/100, Loss: 2.348592e-04, LR: 5.00e-06
 44%|████▍     | 44/100 [02:01<02:38,  2.82s/it]Fine-tune Epoch 44/100, Loss: 2.270991e-04, LR: 5.00e-06
 45%|████▌     | 45/100 [02:04<02:33,  2.80s/it]Fine-tune Epoch 45/100, Loss: 2.198403e-04, LR: 5.00e-06
 46%|████▌     | 46/100 [02:07<02:31,  2.80s/it]Fine-tune Epoch 46/100, Loss: 2.126987e-04, LR: 5.00e-06
 47%|████▋     | 47/100 [02:10<02:28,  2.81s/it]Fine-tune Epoch 47/100, Loss: 2.062235e-04, LR: 5.00e-06
 48%|████▊     | 48/100 [02:13<02:27,  2.84s/it]Fine-tune Epoch 48/100, Loss: 1.996117e-04, LR: 5.00e-06
 49%|████▉     | 49/100 [02:16<02:25,  2.84s/it]Fine-tune Epoch 49/100, Loss: 1.935004e-04, LR: 5.00e-06
 50%|█████     | 50/100 [02:18<02:20,  2.80s/it]Fine-tune Epoch 50/100, Loss: 1.876415e-04, LR: 5.00e-06
 51%|█████     | 51/100 [02:21<02:16,  2.79s/it]Fine-tune Epoch 51/100, Loss: 1.819014e-04, LR: 5.00e-06
 52%|█████▏    | 52/100 [02:24<02:15,  2.81s/it]Fine-tune Epoch 52/100, Loss: 1.766623e-04, LR: 5.00e-06
 53%|█████▎    | 53/100 [02:27<02:10,  2.78s/it]Fine-tune Epoch 53/100, Loss: 1.712553e-04, LR: 5.00e-06
 54%|█████▍    | 54/100 [02:29<02:06,  2.75s/it]Fine-tune Epoch 54/100, Loss: 1.661762e-04, LR: 5.00e-06
 55%|█████▌    | 55/100 [02:32<02:04,  2.77s/it]Fine-tune Epoch 55/100, Loss: 1.613603e-04, LR: 5.00e-06
 56%|█████▌    | 56/100 [02:35<02:02,  2.78s/it]Fine-tune Epoch 56/100, Loss: 1.570377e-04, LR: 5.00e-06
 57%|█████▋    | 57/100 [02:37<01:57,  2.73s/it]Fine-tune Epoch 57/100, Loss: 1.525695e-04, LR: 5.00e-06
 58%|█████▊    | 58/100 [02:40<01:53,  2.70s/it]Fine-tune Epoch 58/100, Loss: 1.485834e-04, LR: 5.00e-06
 59%|█████▉    | 59/100 [02:43<01:50,  2.69s/it]Fine-tune Epoch 59/100, Loss: 1.444640e-04, LR: 5.00e-06
 60%|██████    | 60/100 [02:45<01:47,  2.69s/it]Fine-tune Epoch 60/100, Loss: 1.405270e-04, LR: 5.00e-06
 61%|██████    | 61/100 [02:48<01:45,  2.72s/it]Fine-tune Epoch 61/100, Loss: 1.368757e-04, LR: 5.00e-06
 62%|██████▏   | 62/100 [02:51<01:44,  2.76s/it]Fine-tune Epoch 62/100, Loss: 1.334770e-04, LR: 5.00e-06
 63%|██████▎   | 63/100 [02:54<01:43,  2.80s/it]Fine-tune Epoch 63/100, Loss: 1.298183e-04, LR: 5.00e-06
 64%|██████▍   | 64/100 [02:57<01:39,  2.76s/it]Fine-tune Epoch 64/100, Loss: 1.265551e-04, LR: 5.00e-06
 65%|██████▌   | 65/100 [02:59<01:37,  2.78s/it]Fine-tune Epoch 65/100, Loss: 1.233315e-04, LR: 5.00e-06
 66%|██████▌   | 66/100 [03:02<01:33,  2.75s/it]Fine-tune Epoch 66/100, Loss: 1.201627e-04, LR: 5.00e-06
 67%|██████▋   | 67/100 [03:05<01:29,  2.72s/it]Fine-tune Epoch 67/100, Loss: 1.172522e-04, LR: 5.00e-06
 68%|██████▊   | 68/100 [03:08<01:26,  2.72s/it]Fine-tune Epoch 68/100, Loss: 1.143766e-04, LR: 5.00e-06
 69%|██████▉   | 69/100 [03:10<01:24,  2.73s/it]Fine-tune Epoch 69/100, Loss: 1.116770e-04, LR: 5.00e-06
 70%|███████   | 70/100 [03:13<01:21,  2.72s/it]Fine-tune Epoch 70/100, Loss: 1.089800e-04, LR: 5.00e-06
 71%|███████   | 71/100 [03:15<01:16,  2.65s/it]Fine-tune Epoch 71/100, Loss: 1.067053e-04, LR: 5.00e-06
 72%|███████▏  | 72/100 [03:18<01:13,  2.61s/it]Fine-tune Epoch 72/100, Loss: 1.039118e-04, LR: 5.00e-06
 73%|███████▎  | 73/100 [03:21<01:12,  2.68s/it]Fine-tune Epoch 73/100, Loss: 1.018745e-04, LR: 5.00e-06
 74%|███████▍  | 74/100 [03:24<01:10,  2.69s/it]Fine-tune Epoch 74/100, Loss: 9.949662e-05, LR: 5.00e-06
 75%|███████▌  | 75/100 [03:26<01:08,  2.74s/it]Fine-tune Epoch 75/100, Loss: 9.752932e-05, LR: 5.00e-06
 76%|███████▌  | 76/100 [03:29<01:05,  2.72s/it]Fine-tune Epoch 76/100, Loss: 9.536101e-05, LR: 5.00e-06
 77%|███████▋  | 77/100 [03:32<01:04,  2.81s/it]Fine-tune Epoch 77/100, Loss: 9.340233e-05, LR: 5.00e-06
 78%|███████▊  | 78/100 [03:35<01:02,  2.84s/it]Fine-tune Epoch 78/100, Loss: 9.123036e-05, LR: 5.00e-06
 79%|███████▉  | 79/100 [03:38<00:58,  2.80s/it]Fine-tune Epoch 79/100, Loss: 8.945341e-05, LR: 5.00e-06
 80%|████████  | 80/100 [03:40<00:55,  2.79s/it]Fine-tune Epoch 80/100, Loss: 8.779961e-05, LR: 5.00e-06
 81%|████████  | 81/100 [03:43<00:52,  2.77s/it]Fine-tune Epoch 81/100, Loss: 8.606268e-05, LR: 5.00e-06
 82%|████████▏ | 82/100 [03:46<00:49,  2.75s/it]Fine-tune Epoch 82/100, Loss: 8.430164e-05, LR: 5.00e-06
 83%|████████▎ | 83/100 [03:49<00:46,  2.71s/it]Fine-tune Epoch 83/100, Loss: 8.256487e-05, LR: 5.00e-06
 84%|████████▍ | 84/100 [03:51<00:43,  2.74s/it]Fine-tune Epoch 84/100, Loss: 8.096642e-05, LR: 5.00e-06
 85%|████████▌ | 85/100 [03:54<00:40,  2.70s/it]Fine-tune Epoch 85/100, Loss: 7.935888e-05, LR: 5.00e-06
 86%|████████▌ | 86/100 [03:57<00:38,  2.73s/it]Fine-tune Epoch 86/100, Loss: 7.813003e-05, LR: 5.00e-06
 87%|████████▋ | 87/100 [04:00<00:35,  2.73s/it]Fine-tune Epoch 87/100, Loss: 7.670398e-05, LR: 5.00e-06
 88%|████████▊ | 88/100 [04:02<00:33,  2.77s/it]Fine-tune Epoch 88/100, Loss: 7.503972e-05, LR: 5.00e-06
 89%|████████▉ | 89/100 [04:05<00:30,  2.76s/it]Fine-tune Epoch 89/100, Loss: 7.383991e-05, LR: 5.00e-06
 90%|█████████ | 90/100 [04:08<00:27,  2.71s/it]Fine-tune Epoch 90/100, Loss: 7.259705e-05, LR: 5.00e-06
 91%|█████████ | 91/100 [04:10<00:23,  2.64s/it]Fine-tune Epoch 91/100, Loss: 7.120377e-05, LR: 5.00e-06
 92%|█████████▏| 92/100 [04:13<00:21,  2.70s/it]Fine-tune Epoch 92/100, Loss: 7.001186e-05, LR: 5.00e-06
 93%|█████████▎| 93/100 [04:16<00:18,  2.70s/it]Fine-tune Epoch 93/100, Loss: 6.875798e-05, LR: 5.00e-06
 94%|█████████▍| 94/100 [04:19<00:16,  2.73s/it]Fine-tune Epoch 94/100, Loss: 6.785864e-05, LR: 5.00e-06
 95%|█████████▌| 95/100 [04:21<00:13,  2.72s/it]Fine-tune Epoch 95/100, Loss: 6.664544e-05, LR: 5.00e-06
 96%|█████████▌| 96/100 [04:24<00:10,  2.70s/it]Fine-tune Epoch 96/100, Loss: 6.551293e-05, LR: 5.00e-06
 97%|█████████▋| 97/100 [04:26<00:08,  2.67s/it]Fine-tune Epoch 97/100, Loss: 6.454882e-05, LR: 5.00e-06
 98%|█████████▊| 98/100 [04:29<00:05,  2.67s/it]Fine-tune Epoch 98/100, Loss: 6.354723e-05, LR: 5.00e-06
 99%|█████████▉| 99/100 [04:32<00:02,  2.77s/it]Fine-tune Epoch 99/100, Loss: 6.263467e-05, LR: 5.00e-06
100%|██████████| 100/100 [04:35<00:00,  2.75s/it]100%|██████████| 100/100 [04:35<00:00,  2.75s/it]
Fine-tune Epoch 100/100, Loss: 6.167133e-05, LR: 5.00e-06

Final PSNR after pruning and fine-tuning: 49.0613
Pruning resulted in PSNR 49.06 which is below target 50.00. Consider less aggressive pruning.
Saved best pruned model to ./models/pruned_siren_std_143n.pth

Attempting to prune with ratio: 10%
Original hidden neurons: 150, New hidden neurons: 135 (Pruning 15 neurons)
New pruned model architecture:
MyResidualSirenNet(
  (net_layers): ModuleList(
    (0): SineLayer(
      (linear): Linear(in_features=3, out_features=135, bias=True)
    )
    (1-6): 6 x ResidualSineLayer(
      (linear_1): Linear(in_features=135, out_features=135, bias=True)
      (linear_2): Linear(in_features=135, out_features=135, bias=True)
    )
    (7): Linear(in_features=135, out_features=1, bias=True)
  )
)
New pruned model parameters: 220996
Parameter reduction: 18.92%

--- Fine-tuning pruned model for 100 epochs ---
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:02<04:19,  2.62s/it]Fine-tune Epoch 1/100, Loss: 5.567914e-03, LR: 5.00e-06
  2%|▏         | 2/100 [00:05<04:23,  2.68s/it]Fine-tune Epoch 2/100, Loss: 3.700474e-03, LR: 5.00e-06
  3%|▎         | 3/100 [00:07<04:17,  2.65s/it]Fine-tune Epoch 3/100, Loss: 3.089628e-03, LR: 5.00e-06
  4%|▍         | 4/100 [00:10<04:20,  2.71s/it]Fine-tune Epoch 4/100, Loss: 2.709961e-03, LR: 5.00e-06
  5%|▌         | 5/100 [00:13<04:17,  2.71s/it]Fine-tune Epoch 5/100, Loss: 2.439085e-03, LR: 5.00e-06
  6%|▌         | 6/100 [00:16<04:15,  2.72s/it]Fine-tune Epoch 6/100, Loss: 2.228888e-03, LR: 5.00e-06
  7%|▋         | 7/100 [00:18<04:13,  2.73s/it]Fine-tune Epoch 7/100, Loss: 2.058308e-03, LR: 5.00e-06
  8%|▊         | 8/100 [00:21<04:15,  2.78s/it]Fine-tune Epoch 8/100, Loss: 1.914728e-03, LR: 5.00e-06
  9%|▉         | 9/100 [00:24<04:15,  2.80s/it]Fine-tune Epoch 9/100, Loss: 1.790663e-03, LR: 5.00e-06
 10%|█         | 10/100 [00:27<04:13,  2.82s/it]Fine-tune Epoch 10/100, Loss: 1.681104e-03, LR: 5.00e-06
 11%|█         | 11/100 [00:30<04:11,  2.82s/it]Fine-tune Epoch 11/100, Loss: 1.583555e-03, LR: 5.00e-06
 12%|█▏        | 12/100 [00:33<04:04,  2.77s/it]Fine-tune Epoch 12/100, Loss: 1.495850e-03, LR: 5.00e-06
 13%|█▎        | 13/100 [00:35<04:02,  2.78s/it]Fine-tune Epoch 13/100, Loss: 1.416456e-03, LR: 5.00e-06
 14%|█▍        | 14/100 [00:38<04:01,  2.81s/it]Fine-tune Epoch 14/100, Loss: 1.342585e-03, LR: 5.00e-06
 15%|█▌        | 15/100 [00:41<03:58,  2.80s/it]Fine-tune Epoch 15/100, Loss: 1.276129e-03, LR: 5.00e-06
 16%|█▌        | 16/100 [00:44<03:57,  2.82s/it]Fine-tune Epoch 16/100, Loss: 1.213877e-03, LR: 5.00e-06
 17%|█▋        | 17/100 [00:47<03:50,  2.77s/it]Fine-tune Epoch 17/100, Loss: 1.156129e-03, LR: 5.00e-06
 18%|█▊        | 18/100 [00:50<03:52,  2.83s/it]Fine-tune Epoch 18/100, Loss: 1.102475e-03, LR: 5.00e-06
 19%|█▉        | 19/100 [00:52<03:41,  2.74s/it]Fine-tune Epoch 19/100, Loss: 1.051936e-03, LR: 5.00e-06
 20%|██        | 20/100 [00:55<03:36,  2.71s/it]Fine-tune Epoch 20/100, Loss: 1.004824e-03, LR: 5.00e-06
 21%|██        | 21/100 [00:57<03:33,  2.70s/it]Fine-tune Epoch 21/100, Loss: 9.617326e-04, LR: 5.00e-06
 22%|██▏       | 22/100 [01:00<03:28,  2.68s/it]Fine-tune Epoch 22/100, Loss: 9.201610e-04, LR: 5.00e-06
 23%|██▎       | 23/100 [01:03<03:30,  2.73s/it]Fine-tune Epoch 23/100, Loss: 8.811596e-04, LR: 5.00e-06
 24%|██▍       | 24/100 [01:06<03:28,  2.75s/it]Fine-tune Epoch 24/100, Loss: 8.449258e-04, LR: 5.00e-06
 25%|██▌       | 25/100 [01:08<03:24,  2.72s/it]Fine-tune Epoch 25/100, Loss: 8.101562e-04, LR: 5.00e-06
 26%|██▌       | 26/100 [01:11<03:19,  2.69s/it]Fine-tune Epoch 26/100, Loss: 7.780642e-04, LR: 5.00e-06
 27%|██▋       | 27/100 [01:14<03:15,  2.67s/it]Fine-tune Epoch 27/100, Loss: 7.472956e-04, LR: 5.00e-06
 28%|██▊       | 28/100 [01:16<03:10,  2.65s/it]Fine-tune Epoch 28/100, Loss: 7.180047e-04, LR: 5.00e-06
 29%|██▉       | 29/100 [01:19<03:06,  2.62s/it]Fine-tune Epoch 29/100, Loss: 6.906893e-04, LR: 5.00e-06
 30%|███       | 30/100 [01:22<03:08,  2.69s/it]Fine-tune Epoch 30/100, Loss: 6.644941e-04, LR: 5.00e-06
 31%|███       | 31/100 [01:24<03:02,  2.65s/it]Fine-tune Epoch 31/100, Loss: 6.395219e-04, LR: 5.00e-06
 32%|███▏      | 32/100 [01:27<03:02,  2.68s/it]Fine-tune Epoch 32/100, Loss: 6.163660e-04, LR: 5.00e-06
 33%|███▎      | 33/100 [01:29<02:58,  2.66s/it]Fine-tune Epoch 33/100, Loss: 5.941455e-04, LR: 5.00e-06
 34%|███▍      | 34/100 [01:32<02:54,  2.65s/it]Fine-tune Epoch 34/100, Loss: 5.728447e-04, LR: 5.00e-06
 35%|███▌      | 35/100 [01:35<02:53,  2.66s/it]Fine-tune Epoch 35/100, Loss: 5.532185e-04, LR: 5.00e-06
 36%|███▌      | 36/100 [01:37<02:50,  2.66s/it]Fine-tune Epoch 36/100, Loss: 5.335172e-04, LR: 5.00e-06
 37%|███▋      | 37/100 [01:40<02:48,  2.67s/it]Fine-tune Epoch 37/100, Loss: 5.158049e-04, LR: 5.00e-06
 38%|███▊      | 38/100 [01:43<02:46,  2.69s/it]Fine-tune Epoch 38/100, Loss: 4.984795e-04, LR: 5.00e-06
 39%|███▉      | 39/100 [01:46<02:45,  2.71s/it]Fine-tune Epoch 39/100, Loss: 4.818307e-04, LR: 5.00e-06
 40%|████      | 40/100 [01:48<02:44,  2.75s/it]Fine-tune Epoch 40/100, Loss: 4.656313e-04, LR: 5.00e-06
 41%|████      | 41/100 [01:51<02:41,  2.73s/it]Fine-tune Epoch 41/100, Loss: 4.511963e-04, LR: 5.00e-06
 42%|████▏     | 42/100 [01:54<02:33,  2.65s/it]Fine-tune Epoch 42/100, Loss: 4.368498e-04, LR: 5.00e-06
 43%|████▎     | 43/100 [01:56<02:34,  2.71s/it]Fine-tune Epoch 43/100, Loss: 4.231368e-04, LR: 5.00e-06
 44%|████▍     | 44/100 [01:59<02:34,  2.75s/it]Fine-tune Epoch 44/100, Loss: 4.099910e-04, LR: 5.00e-06
 45%|████▌     | 45/100 [02:02<02:32,  2.78s/it]Fine-tune Epoch 45/100, Loss: 3.980109e-04, LR: 5.00e-06
 46%|████▌     | 46/100 [02:05<02:27,  2.72s/it]Fine-tune Epoch 46/100, Loss: 3.857160e-04, LR: 5.00e-06
 47%|████▋     | 47/100 [02:08<02:26,  2.77s/it]Fine-tune Epoch 47/100, Loss: 3.743717e-04, LR: 5.00e-06
 48%|████▊     | 48/100 [02:10<02:21,  2.72s/it]Fine-tune Epoch 48/100, Loss: 3.640132e-04, LR: 5.00e-06
 49%|████▉     | 49/100 [02:13<02:19,  2.74s/it]Fine-tune Epoch 49/100, Loss: 3.530227e-04, LR: 5.00e-06
 50%|█████     | 50/100 [02:16<02:18,  2.76s/it]Fine-tune Epoch 50/100, Loss: 3.435085e-04, LR: 5.00e-06
 51%|█████     | 51/100 [02:19<02:15,  2.77s/it]Fine-tune Epoch 51/100, Loss: 3.339199e-04, LR: 5.00e-06
 52%|█████▏    | 52/100 [02:22<02:16,  2.84s/it]Fine-tune Epoch 52/100, Loss: 3.248313e-04, LR: 5.00e-06
 53%|█████▎    | 53/100 [02:25<02:15,  2.87s/it]Fine-tune Epoch 53/100, Loss: 3.161172e-04, LR: 5.00e-06
 54%|█████▍    | 54/100 [02:27<02:11,  2.85s/it]Fine-tune Epoch 54/100, Loss: 3.075225e-04, LR: 5.00e-06
 55%|█████▌    | 55/100 [02:30<02:07,  2.83s/it]Fine-tune Epoch 55/100, Loss: 2.995928e-04, LR: 5.00e-06
 56%|█████▌    | 56/100 [02:33<02:04,  2.83s/it]Fine-tune Epoch 56/100, Loss: 2.917621e-04, LR: 5.00e-06
 57%|█████▋    | 57/100 [02:36<01:59,  2.78s/it]Fine-tune Epoch 57/100, Loss: 2.842442e-04, LR: 5.00e-06
 58%|█████▊    | 58/100 [02:38<01:55,  2.76s/it]Fine-tune Epoch 58/100, Loss: 2.774326e-04, LR: 5.00e-06
 59%|█████▉    | 59/100 [02:41<01:52,  2.75s/it]Fine-tune Epoch 59/100, Loss: 2.705652e-04, LR: 5.00e-06
 60%|██████    | 60/100 [02:44<01:47,  2.70s/it]Fine-tune Epoch 60/100, Loss: 2.639822e-04, LR: 5.00e-06
 61%|██████    | 61/100 [02:47<01:47,  2.76s/it]Fine-tune Epoch 61/100, Loss: 2.575158e-04, LR: 5.00e-06
 62%|██████▏   | 62/100 [02:49<01:45,  2.76s/it]Fine-tune Epoch 62/100, Loss: 2.516104e-04, LR: 5.00e-06
 63%|██████▎   | 63/100 [02:52<01:43,  2.79s/it]Fine-tune Epoch 63/100, Loss: 2.454341e-04, LR: 5.00e-06
 64%|██████▍   | 64/100 [02:55<01:38,  2.73s/it]Fine-tune Epoch 64/100, Loss: 2.399958e-04, LR: 5.00e-06
 65%|██████▌   | 65/100 [02:58<01:36,  2.76s/it]Fine-tune Epoch 65/100, Loss: 2.342278e-04, LR: 5.00e-06
 66%|██████▌   | 66/100 [03:00<01:34,  2.78s/it]Fine-tune Epoch 66/100, Loss: 2.290194e-04, LR: 5.00e-06
 67%|██████▋   | 67/100 [03:03<01:30,  2.75s/it]Fine-tune Epoch 67/100, Loss: 2.240205e-04, LR: 5.00e-06
 68%|██████▊   | 68/100 [03:06<01:27,  2.72s/it]Fine-tune Epoch 68/100, Loss: 2.193500e-04, LR: 5.00e-06
 69%|██████▉   | 69/100 [03:09<01:24,  2.74s/it]Fine-tune Epoch 69/100, Loss: 2.147894e-04, LR: 5.00e-06
 70%|███████   | 70/100 [03:11<01:22,  2.73s/it]Fine-tune Epoch 70/100, Loss: 2.098566e-04, LR: 5.00e-06
 71%|███████   | 71/100 [03:14<01:19,  2.73s/it]Fine-tune Epoch 71/100, Loss: 2.055863e-04, LR: 5.00e-06
 72%|███████▏  | 72/100 [03:17<01:18,  2.81s/it]Fine-tune Epoch 72/100, Loss: 2.016398e-04, LR: 5.00e-06
 73%|███████▎  | 73/100 [03:20<01:14,  2.77s/it]Fine-tune Epoch 73/100, Loss: 1.966163e-04, LR: 5.00e-06
 74%|███████▍  | 74/100 [03:22<01:11,  2.74s/it]Fine-tune Epoch 74/100, Loss: 1.933658e-04, LR: 5.00e-06
 75%|███████▌  | 75/100 [03:25<01:08,  2.74s/it]Fine-tune Epoch 75/100, Loss: 1.892178e-04, LR: 5.00e-06
 76%|███████▌  | 76/100 [03:28<01:06,  2.76s/it]Fine-tune Epoch 76/100, Loss: 1.853873e-04, LR: 5.00e-06
 77%|███████▋  | 77/100 [03:30<01:02,  2.72s/it]Fine-tune Epoch 77/100, Loss: 1.819170e-04, LR: 5.00e-06
 78%|███████▊  | 78/100 [03:33<01:00,  2.77s/it]Fine-tune Epoch 78/100, Loss: 1.785852e-04, LR: 5.00e-06
 79%|███████▉  | 79/100 [03:36<00:57,  2.72s/it]Fine-tune Epoch 79/100, Loss: 1.753037e-04, LR: 5.00e-06
 80%|████████  | 80/100 [03:39<00:53,  2.69s/it]Fine-tune Epoch 80/100, Loss: 1.715966e-04, LR: 5.00e-06
 81%|████████  | 81/100 [03:41<00:52,  2.74s/it]Fine-tune Epoch 81/100, Loss: 1.685825e-04, LR: 5.00e-06
 82%|████████▏ | 82/100 [03:44<00:50,  2.78s/it]Fine-tune Epoch 82/100, Loss: 1.657296e-04, LR: 5.00e-06
 83%|████████▎ | 83/100 [03:47<00:46,  2.76s/it]Fine-tune Epoch 83/100, Loss: 1.625796e-04, LR: 5.00e-06
 84%|████████▍ | 84/100 [03:50<00:44,  2.75s/it]Fine-tune Epoch 84/100, Loss: 1.593443e-04, LR: 5.00e-06
 85%|████████▌ | 85/100 [03:52<00:41,  2.74s/it]Fine-tune Epoch 85/100, Loss: 1.568555e-04, LR: 5.00e-06
 86%|████████▌ | 86/100 [03:55<00:38,  2.74s/it]Fine-tune Epoch 86/100, Loss: 1.539572e-04, LR: 5.00e-06
 87%|████████▋ | 87/100 [03:58<00:35,  2.73s/it]Fine-tune Epoch 87/100, Loss: 1.516109e-04, LR: 5.00e-06
 88%|████████▊ | 88/100 [04:01<00:32,  2.74s/it]Fine-tune Epoch 88/100, Loss: 1.487891e-04, LR: 5.00e-06
 89%|████████▉ | 89/100 [04:03<00:30,  2.73s/it]Fine-tune Epoch 89/100, Loss: 1.465704e-04, LR: 5.00e-06
 90%|█████████ | 90/100 [04:06<00:27,  2.72s/it]Fine-tune Epoch 90/100, Loss: 1.439967e-04, LR: 5.00e-06
 91%|█████████ | 91/100 [04:09<00:24,  2.73s/it]Fine-tune Epoch 91/100, Loss: 1.415732e-04, LR: 5.00e-06
 92%|█████████▏| 92/100 [04:12<00:21,  2.73s/it]Fine-tune Epoch 92/100, Loss: 1.392694e-04, LR: 5.00e-06
 93%|█████████▎| 93/100 [04:14<00:19,  2.75s/it]Fine-tune Epoch 93/100, Loss: 1.371440e-04, LR: 5.00e-06
 94%|█████████▍| 94/100 [04:17<00:16,  2.73s/it]Fine-tune Epoch 94/100, Loss: 1.351090e-04, LR: 5.00e-06
 95%|█████████▌| 95/100 [04:20<00:13,  2.71s/it]Fine-tune Epoch 95/100, Loss: 1.327189e-04, LR: 5.00e-06
 96%|█████████▌| 96/100 [04:22<00:10,  2.72s/it]Fine-tune Epoch 96/100, Loss: 1.310052e-04, LR: 5.00e-06
 97%|█████████▋| 97/100 [04:25<00:08,  2.76s/it]Fine-tune Epoch 97/100, Loss: 1.290751e-04, LR: 5.00e-06
 98%|█████████▊| 98/100 [04:28<00:05,  2.76s/it]Fine-tune Epoch 98/100, Loss: 1.271057e-04, LR: 5.00e-06
 99%|█████████▉| 99/100 [04:31<00:02,  2.72s/it]Fine-tune Epoch 99/100, Loss: 1.250949e-04, LR: 5.00e-06
100%|██████████| 100/100 [04:33<00:00,  2.70s/it]100%|██████████| 100/100 [04:33<00:00,  2.74s/it]
Fine-tune Epoch 100/100, Loss: 1.235607e-04, LR: 5.00e-06

Final PSNR after pruning and fine-tuning: 45.9611
Pruning resulted in PSNR 45.96 which is below target 50.00. Consider less aggressive pruning.
Saved best pruned model to ./models/pruned_siren_std_135n.pth

Attempting to prune with ratio: 15%
Original hidden neurons: 150, New hidden neurons: 128 (Pruning 22 neurons)
New pruned model architecture:
MyResidualSirenNet(
  (net_layers): ModuleList(
    (0): SineLayer(
      (linear): Linear(in_features=3, out_features=128, bias=True)
    )
    (1-6): 6 x ResidualSineLayer(
      (linear_1): Linear(in_features=128, out_features=128, bias=True)
      (linear_2): Linear(in_features=128, out_features=128, bias=True)
    )
    (7): Linear(in_features=128, out_features=1, bias=True)
  )
)
New pruned model parameters: 198785
Parameter reduction: 27.07%

--- Fine-tuning pruned model for 100 epochs ---
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:02<04:32,  2.75s/it]Fine-tune Epoch 1/100, Loss: 7.388516e-03, LR: 5.00e-06
  2%|▏         | 2/100 [00:05<04:29,  2.75s/it]Fine-tune Epoch 2/100, Loss: 4.497564e-03, LR: 5.00e-06
  3%|▎         | 3/100 [00:08<04:28,  2.77s/it]Fine-tune Epoch 3/100, Loss: 3.702242e-03, LR: 5.00e-06
  4%|▍         | 4/100 [00:11<04:33,  2.85s/it]Fine-tune Epoch 4/100, Loss: 3.235667e-03, LR: 5.00e-06
  5%|▌         | 5/100 [00:14<04:27,  2.81s/it]Fine-tune Epoch 5/100, Loss: 2.913349e-03, LR: 5.00e-06
  6%|▌         | 6/100 [00:16<04:22,  2.79s/it]Fine-tune Epoch 6/100, Loss: 2.667022e-03, LR: 5.00e-06
  7%|▋         | 7/100 [00:19<04:21,  2.81s/it]Fine-tune Epoch 7/100, Loss: 2.469296e-03, LR: 5.00e-06
  8%|▊         | 8/100 [00:22<04:16,  2.79s/it]Fine-tune Epoch 8/100, Loss: 2.303788e-03, LR: 5.00e-06
  9%|▉         | 9/100 [00:25<04:12,  2.78s/it]Fine-tune Epoch 9/100, Loss: 2.161440e-03, LR: 5.00e-06
 10%|█         | 10/100 [00:27<04:11,  2.80s/it]Fine-tune Epoch 10/100, Loss: 2.036450e-03, LR: 5.00e-06
 11%|█         | 11/100 [00:30<04:05,  2.76s/it]Fine-tune Epoch 11/100, Loss: 1.926025e-03, LR: 5.00e-06
 12%|█▏        | 12/100 [00:33<04:03,  2.77s/it]Fine-tune Epoch 12/100, Loss: 1.826142e-03, LR: 5.00e-06
 13%|█▎        | 13/100 [00:36<04:01,  2.77s/it]Fine-tune Epoch 13/100, Loss: 1.736361e-03, LR: 5.00e-06
 14%|█▍        | 14/100 [00:39<04:00,  2.80s/it]Fine-tune Epoch 14/100, Loss: 1.652852e-03, LR: 5.00e-06
 15%|█▌        | 15/100 [00:41<03:53,  2.75s/it]Fine-tune Epoch 15/100, Loss: 1.576840e-03, LR: 5.00e-06
 16%|█▌        | 16/100 [00:44<03:52,  2.76s/it]Fine-tune Epoch 16/100, Loss: 1.506221e-03, LR: 5.00e-06
 17%|█▋        | 17/100 [00:47<03:47,  2.75s/it]Fine-tune Epoch 17/100, Loss: 1.440863e-03, LR: 5.00e-06
 18%|█▊        | 18/100 [00:49<03:46,  2.76s/it]Fine-tune Epoch 18/100, Loss: 1.379467e-03, LR: 5.00e-06
 19%|█▉        | 19/100 [00:52<03:44,  2.77s/it]Fine-tune Epoch 19/100, Loss: 1.322284e-03, LR: 5.00e-06
 20%|██        | 20/100 [00:55<03:38,  2.73s/it]Fine-tune Epoch 20/100, Loss: 1.269055e-03, LR: 5.00e-06
 21%|██        | 21/100 [00:58<03:36,  2.75s/it]Fine-tune Epoch 21/100, Loss: 1.218674e-03, LR: 5.00e-06
 22%|██▏       | 22/100 [01:00<03:33,  2.73s/it]Fine-tune Epoch 22/100, Loss: 1.171064e-03, LR: 5.00e-06
 23%|██▎       | 23/100 [01:03<03:31,  2.74s/it]Fine-tune Epoch 23/100, Loss: 1.125981e-03, LR: 5.00e-06
 24%|██▍       | 24/100 [01:06<03:30,  2.77s/it]Fine-tune Epoch 24/100, Loss: 1.084288e-03, LR: 5.00e-06
 25%|██▌       | 25/100 [01:09<03:30,  2.80s/it]Fine-tune Epoch 25/100, Loss: 1.044196e-03, LR: 5.00e-06
 26%|██▌       | 26/100 [01:12<03:25,  2.78s/it]Fine-tune Epoch 26/100, Loss: 1.006191e-03, LR: 5.00e-06
 27%|██▋       | 27/100 [01:14<03:19,  2.73s/it]Fine-tune Epoch 27/100, Loss: 9.711755e-04, LR: 5.00e-06
 28%|██▊       | 28/100 [01:17<03:17,  2.74s/it]Fine-tune Epoch 28/100, Loss: 9.373503e-04, LR: 5.00e-06
 29%|██▉       | 29/100 [01:20<03:16,  2.76s/it]Fine-tune Epoch 29/100, Loss: 9.050210e-04, LR: 5.00e-06
 30%|███       | 30/100 [01:23<03:14,  2.78s/it]Fine-tune Epoch 30/100, Loss: 8.733858e-04, LR: 5.00e-06
 31%|███       | 31/100 [01:25<03:11,  2.78s/it]Fine-tune Epoch 31/100, Loss: 8.447273e-04, LR: 5.00e-06
 32%|███▏      | 32/100 [01:28<03:10,  2.80s/it]Fine-tune Epoch 32/100, Loss: 8.167105e-04, LR: 5.00e-06
 33%|███▎      | 33/100 [01:31<03:08,  2.81s/it]Fine-tune Epoch 33/100, Loss: 7.911020e-04, LR: 5.00e-06
 34%|███▍      | 34/100 [01:34<03:06,  2.83s/it]Fine-tune Epoch 34/100, Loss: 7.659609e-04, LR: 5.00e-06
 35%|███▌      | 35/100 [01:37<03:02,  2.80s/it]Fine-tune Epoch 35/100, Loss: 7.420640e-04, LR: 5.00e-06
 36%|███▌      | 36/100 [01:40<03:00,  2.81s/it]Fine-tune Epoch 36/100, Loss: 7.193567e-04, LR: 5.00e-06
 37%|███▋      | 37/100 [01:42<02:56,  2.80s/it]Fine-tune Epoch 37/100, Loss: 6.976745e-04, LR: 5.00e-06
 38%|███▊      | 38/100 [01:45<02:51,  2.77s/it]Fine-tune Epoch 38/100, Loss: 6.770373e-04, LR: 5.00e-06
 39%|███▉      | 39/100 [01:48<02:48,  2.76s/it]Fine-tune Epoch 39/100, Loss: 6.569934e-04, LR: 5.00e-06
 40%|████      | 40/100 [01:51<02:45,  2.76s/it]Fine-tune Epoch 40/100, Loss: 6.382734e-04, LR: 5.00e-06
 41%|████      | 41/100 [01:53<02:42,  2.75s/it]Fine-tune Epoch 41/100, Loss: 6.200024e-04, LR: 5.00e-06
 42%|████▏     | 42/100 [01:56<02:40,  2.77s/it]Fine-tune Epoch 42/100, Loss: 6.021337e-04, LR: 5.00e-06
 43%|████▎     | 43/100 [01:59<02:36,  2.75s/it]Fine-tune Epoch 43/100, Loss: 5.858734e-04, LR: 5.00e-06
 44%|████▍     | 44/100 [02:01<02:33,  2.74s/it]Fine-tune Epoch 44/100, Loss: 5.702458e-04, LR: 5.00e-06
 45%|████▌     | 45/100 [02:04<02:29,  2.71s/it]Fine-tune Epoch 45/100, Loss: 5.542752e-04, LR: 5.00e-06
 46%|████▌     | 46/100 [02:07<02:26,  2.70s/it]Fine-tune Epoch 46/100, Loss: 5.401130e-04, LR: 5.00e-06
 47%|████▋     | 47/100 [02:10<02:24,  2.74s/it]Fine-tune Epoch 47/100, Loss: 5.261393e-04, LR: 5.00e-06
 48%|████▊     | 48/100 [02:12<02:23,  2.75s/it]Fine-tune Epoch 48/100, Loss: 5.122469e-04, LR: 5.00e-06
 49%|████▉     | 49/100 [02:15<02:19,  2.74s/it]Fine-tune Epoch 49/100, Loss: 4.994888e-04, LR: 5.00e-06
 50%|█████     | 50/100 [02:18<02:17,  2.75s/it]Fine-tune Epoch 50/100, Loss: 4.867403e-04, LR: 5.00e-06
 51%|█████     | 51/100 [02:21<02:13,  2.72s/it]Fine-tune Epoch 51/100, Loss: 4.749389e-04, LR: 5.00e-06
 52%|█████▏    | 52/100 [02:23<02:09,  2.70s/it]Fine-tune Epoch 52/100, Loss: 4.636759e-04, LR: 5.00e-06
 53%|█████▎    | 53/100 [02:26<02:09,  2.76s/it]Fine-tune Epoch 53/100, Loss: 4.525819e-04, LR: 5.00e-06
 54%|█████▍    | 54/100 [02:29<02:06,  2.75s/it]Fine-tune Epoch 54/100, Loss: 4.414269e-04, LR: 5.00e-06
 55%|█████▌    | 55/100 [02:32<02:03,  2.75s/it]Fine-tune Epoch 55/100, Loss: 4.311950e-04, LR: 5.00e-06
 56%|█████▌    | 56/100 [02:34<02:00,  2.73s/it]Fine-tune Epoch 56/100, Loss: 4.214862e-04, LR: 5.00e-06
 57%|█████▋    | 57/100 [02:37<01:55,  2.69s/it]Fine-tune Epoch 57/100, Loss: 4.117267e-04, LR: 5.00e-06
 58%|█████▊    | 58/100 [02:39<01:52,  2.67s/it]Fine-tune Epoch 58/100, Loss: 4.029400e-04, LR: 5.00e-06
 59%|█████▉    | 59/100 [02:42<01:50,  2.71s/it]Fine-tune Epoch 59/100, Loss: 3.938571e-04, LR: 5.00e-06
 60%|██████    | 60/100 [02:45<01:48,  2.71s/it]Fine-tune Epoch 60/100, Loss: 3.854734e-04, LR: 5.00e-06
 61%|██████    | 61/100 [02:48<01:48,  2.78s/it]Fine-tune Epoch 61/100, Loss: 3.772723e-04, LR: 5.00e-06
 62%|██████▏   | 62/100 [02:51<01:45,  2.78s/it]Fine-tune Epoch 62/100, Loss: 3.689918e-04, LR: 5.00e-06
 63%|██████▎   | 63/100 [02:53<01:41,  2.75s/it]Fine-tune Epoch 63/100, Loss: 3.610868e-04, LR: 5.00e-06
 64%|██████▍   | 64/100 [02:56<01:38,  2.74s/it]Fine-tune Epoch 64/100, Loss: 3.538496e-04, LR: 5.00e-06
 65%|██████▌   | 65/100 [02:59<01:36,  2.77s/it]Fine-tune Epoch 65/100, Loss: 3.465996e-04, LR: 5.00e-06
 66%|██████▌   | 66/100 [03:02<01:35,  2.82s/it]Fine-tune Epoch 66/100, Loss: 3.401515e-04, LR: 5.00e-06
 67%|██████▋   | 67/100 [03:05<01:33,  2.84s/it]Fine-tune Epoch 67/100, Loss: 3.329086e-04, LR: 5.00e-06
 68%|██████▊   | 68/100 [03:07<01:29,  2.79s/it]Fine-tune Epoch 68/100, Loss: 3.265816e-04, LR: 5.00e-06
 69%|██████▉   | 69/100 [03:10<01:26,  2.79s/it]Fine-tune Epoch 69/100, Loss: 3.204359e-04, LR: 5.00e-06
 70%|███████   | 70/100 [03:13<01:24,  2.80s/it]Fine-tune Epoch 70/100, Loss: 3.141082e-04, LR: 5.00e-06
 71%|███████   | 71/100 [03:16<01:22,  2.84s/it]Fine-tune Epoch 71/100, Loss: 3.086641e-04, LR: 5.00e-06
 72%|███████▏  | 72/100 [03:19<01:18,  2.81s/it]Fine-tune Epoch 72/100, Loss: 3.027703e-04, LR: 5.00e-06
 73%|███████▎  | 73/100 [03:21<01:15,  2.79s/it]Fine-tune Epoch 73/100, Loss: 2.970951e-04, LR: 5.00e-06
 74%|███████▍  | 74/100 [03:24<01:11,  2.76s/it]Fine-tune Epoch 74/100, Loss: 2.912801e-04, LR: 5.00e-06
 75%|███████▌  | 75/100 [03:27<01:09,  2.77s/it]Fine-tune Epoch 75/100, Loss: 2.867546e-04, LR: 5.00e-06
 76%|███████▌  | 76/100 [03:30<01:06,  2.78s/it]Fine-tune Epoch 76/100, Loss: 2.814195e-04, LR: 5.00e-06
 77%|███████▋  | 77/100 [03:32<01:03,  2.74s/it]Fine-tune Epoch 77/100, Loss: 2.768927e-04, LR: 5.00e-06
 78%|███████▊  | 78/100 [03:35<00:59,  2.72s/it]Fine-tune Epoch 78/100, Loss: 2.717584e-04, LR: 5.00e-06
 79%|███████▉  | 79/100 [03:38<00:56,  2.69s/it]Fine-tune Epoch 79/100, Loss: 2.672339e-04, LR: 5.00e-06
 80%|████████  | 80/100 [03:40<00:54,  2.70s/it]Fine-tune Epoch 80/100, Loss: 2.626326e-04, LR: 5.00e-06
 81%|████████  | 81/100 [03:43<00:51,  2.73s/it]Fine-tune Epoch 81/100, Loss: 2.587886e-04, LR: 5.00e-06
 82%|████████▏ | 82/100 [03:46<00:49,  2.73s/it]Fine-tune Epoch 82/100, Loss: 2.539461e-04, LR: 5.00e-06
 83%|████████▎ | 83/100 [03:49<00:47,  2.80s/it]Fine-tune Epoch 83/100, Loss: 2.501358e-04, LR: 5.00e-06
 84%|████████▍ | 84/100 [03:52<00:44,  2.77s/it]Fine-tune Epoch 84/100, Loss: 2.458672e-04, LR: 5.00e-06
 85%|████████▌ | 85/100 [03:54<00:40,  2.70s/it]Fine-tune Epoch 85/100, Loss: 2.420681e-04, LR: 5.00e-06
 86%|████████▌ | 86/100 [03:57<00:37,  2.69s/it]Fine-tune Epoch 86/100, Loss: 2.384213e-04, LR: 5.00e-06
 87%|████████▋ | 87/100 [04:00<00:35,  2.70s/it]Fine-tune Epoch 87/100, Loss: 2.347180e-04, LR: 5.00e-06
 88%|████████▊ | 88/100 [04:02<00:32,  2.69s/it]Fine-tune Epoch 88/100, Loss: 2.310260e-04, LR: 5.00e-06
 89%|████████▉ | 89/100 [04:05<00:30,  2.76s/it]Fine-tune Epoch 89/100, Loss: 2.273734e-04, LR: 5.00e-06
 90%|█████████ | 90/100 [04:08<00:27,  2.80s/it]Fine-tune Epoch 90/100, Loss: 2.242670e-04, LR: 5.00e-06
 91%|█████████ | 91/100 [04:11<00:24,  2.77s/it]Fine-tune Epoch 91/100, Loss: 2.213378e-04, LR: 5.00e-06
 92%|█████████▏| 92/100 [04:13<00:22,  2.75s/it]Fine-tune Epoch 92/100, Loss: 2.180198e-04, LR: 5.00e-06
 93%|█████████▎| 93/100 [04:16<00:19,  2.73s/it]Fine-tune Epoch 93/100, Loss: 2.146419e-04, LR: 5.00e-06
 94%|█████████▍| 94/100 [04:19<00:16,  2.75s/it]Fine-tune Epoch 94/100, Loss: 2.116315e-04, LR: 5.00e-06
 95%|█████████▌| 95/100 [04:22<00:13,  2.77s/it]Fine-tune Epoch 95/100, Loss: 2.087740e-04, LR: 5.00e-06
 96%|█████████▌| 96/100 [04:25<00:11,  2.79s/it]Fine-tune Epoch 96/100, Loss: 2.058674e-04, LR: 5.00e-06
 97%|█████████▋| 97/100 [04:27<00:08,  2.75s/it]Fine-tune Epoch 97/100, Loss: 2.030547e-04, LR: 5.00e-06
 98%|█████████▊| 98/100 [04:30<00:05,  2.74s/it]Fine-tune Epoch 98/100, Loss: 2.004245e-04, LR: 5.00e-06
 99%|█████████▉| 99/100 [04:33<00:02,  2.71s/it]Fine-tune Epoch 99/100, Loss: 1.978329e-04, LR: 5.00e-06
100%|██████████| 100/100 [04:35<00:00,  2.73s/it]100%|██████████| 100/100 [04:35<00:00,  2.76s/it]
Fine-tune Epoch 100/100, Loss: 1.948557e-04, LR: 5.00e-06

Final PSNR after pruning and fine-tuning: 43.8325
Pruning resulted in PSNR 43.83 which is below target 50.00. Consider less aggressive pruning.
Saved best pruned model to ./models/pruned_siren_std_128n.pth

Attempting to prune with ratio: 20%
Original hidden neurons: 150, New hidden neurons: 120 (Pruning 30 neurons)
New pruned model architecture:
MyResidualSirenNet(
  (net_layers): ModuleList(
    (0): SineLayer(
      (linear): Linear(in_features=3, out_features=120, bias=True)
    )
    (1-6): 6 x ResidualSineLayer(
      (linear_1): Linear(in_features=120, out_features=120, bias=True)
      (linear_2): Linear(in_features=120, out_features=120, bias=True)
    )
    (7): Linear(in_features=120, out_features=1, bias=True)
  )
)
New pruned model parameters: 174841
Parameter reduction: 35.85%

--- Fine-tuning pruned model for 100 epochs ---
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:02<04:37,  2.80s/it]Fine-tune Epoch 1/100, Loss: 9.341428e-03, LR: 5.00e-06
  2%|▏         | 2/100 [00:05<04:42,  2.88s/it]Fine-tune Epoch 2/100, Loss: 5.121590e-03, LR: 5.00e-06
  3%|▎         | 3/100 [00:08<04:34,  2.83s/it]Fine-tune Epoch 3/100, Loss: 4.156236e-03, LR: 5.00e-06
  4%|▍         | 4/100 [00:11<04:28,  2.79s/it]Fine-tune Epoch 4/100, Loss: 3.621845e-03, LR: 5.00e-06
  5%|▌         | 5/100 [00:13<04:19,  2.73s/it]Fine-tune Epoch 5/100, Loss: 3.265275e-03, LR: 5.00e-06
  6%|▌         | 6/100 [00:16<04:21,  2.79s/it]Fine-tune Epoch 6/100, Loss: 3.001690e-03, LR: 5.00e-06
  7%|▋         | 7/100 [00:19<04:16,  2.75s/it]Fine-tune Epoch 7/100, Loss: 2.793561e-03, LR: 5.00e-06
  8%|▊         | 8/100 [00:22<04:14,  2.76s/it]Fine-tune Epoch 8/100, Loss: 2.620964e-03, LR: 5.00e-06
  9%|▉         | 9/100 [00:24<04:05,  2.70s/it]Fine-tune Epoch 9/100, Loss: 2.474526e-03, LR: 5.00e-06
 10%|█         | 10/100 [00:27<04:08,  2.76s/it]Fine-tune Epoch 10/100, Loss: 2.347098e-03, LR: 5.00e-06
 11%|█         | 11/100 [00:30<04:05,  2.76s/it]Fine-tune Epoch 11/100, Loss: 2.234540e-03, LR: 5.00e-06
 12%|█▏        | 12/100 [00:33<04:02,  2.76s/it]Fine-tune Epoch 12/100, Loss: 2.132999e-03, LR: 5.00e-06
 13%|█▎        | 13/100 [00:36<04:02,  2.79s/it]Fine-tune Epoch 13/100, Loss: 2.039494e-03, LR: 5.00e-06
 14%|█▍        | 14/100 [00:38<03:58,  2.78s/it]Fine-tune Epoch 14/100, Loss: 1.955736e-03, LR: 5.00e-06
 15%|█▌        | 15/100 [00:41<03:50,  2.72s/it]Fine-tune Epoch 15/100, Loss: 1.877218e-03, LR: 5.00e-06
 16%|█▌        | 16/100 [00:44<03:46,  2.70s/it]Fine-tune Epoch 16/100, Loss: 1.803188e-03, LR: 5.00e-06
 17%|█▋        | 17/100 [00:46<03:45,  2.72s/it]Fine-tune Epoch 17/100, Loss: 1.734666e-03, LR: 5.00e-06
 18%|█▊        | 18/100 [00:49<03:48,  2.79s/it]Fine-tune Epoch 18/100, Loss: 1.670681e-03, LR: 5.00e-06
 19%|█▉        | 19/100 [00:52<03:46,  2.80s/it]Fine-tune Epoch 19/100, Loss: 1.610723e-03, LR: 5.00e-06
 20%|██        | 20/100 [00:55<03:42,  2.78s/it]Fine-tune Epoch 20/100, Loss: 1.553444e-03, LR: 5.00e-06
 21%|██        | 21/100 [00:57<03:35,  2.73s/it]Fine-tune Epoch 21/100, Loss: 1.499992e-03, LR: 5.00e-06
 22%|██▏       | 22/100 [01:00<03:34,  2.75s/it]Fine-tune Epoch 22/100, Loss: 1.447872e-03, LR: 5.00e-06
 23%|██▎       | 23/100 [01:03<03:33,  2.78s/it]Fine-tune Epoch 23/100, Loss: 1.399593e-03, LR: 5.00e-06
 24%|██▍       | 24/100 [01:06<03:25,  2.70s/it]Fine-tune Epoch 24/100, Loss: 1.352416e-03, LR: 5.00e-06
 25%|██▌       | 25/100 [01:08<03:22,  2.70s/it]Fine-tune Epoch 25/100, Loss: 1.308469e-03, LR: 5.00e-06
 26%|██▌       | 26/100 [01:11<03:19,  2.69s/it]Fine-tune Epoch 26/100, Loss: 1.267207e-03, LR: 5.00e-06
 27%|██▋       | 27/100 [01:14<03:19,  2.73s/it]Fine-tune Epoch 27/100, Loss: 1.226352e-03, LR: 5.00e-06
 28%|██▊       | 28/100 [01:17<03:17,  2.74s/it]Fine-tune Epoch 28/100, Loss: 1.188551e-03, LR: 5.00e-06
 29%|██▉       | 29/100 [01:20<03:19,  2.81s/it]Fine-tune Epoch 29/100, Loss: 1.151260e-03, LR: 5.00e-06
 30%|███       | 30/100 [01:23<03:20,  2.86s/it]Fine-tune Epoch 30/100, Loss: 1.117551e-03, LR: 5.00e-06
 31%|███       | 31/100 [01:25<03:18,  2.88s/it]Fine-tune Epoch 31/100, Loss: 1.084090e-03, LR: 5.00e-06
 32%|███▏      | 32/100 [01:28<03:15,  2.88s/it]Fine-tune Epoch 32/100, Loss: 1.052880e-03, LR: 5.00e-06
 33%|███▎      | 33/100 [01:31<03:09,  2.83s/it]Fine-tune Epoch 33/100, Loss: 1.022844e-03, LR: 5.00e-06
 34%|███▍      | 34/100 [01:34<03:01,  2.74s/it]Fine-tune Epoch 34/100, Loss: 9.936371e-04, LR: 5.00e-06
 35%|███▌      | 35/100 [01:36<03:00,  2.77s/it]Fine-tune Epoch 35/100, Loss: 9.662961e-04, LR: 5.00e-06
 36%|███▌      | 36/100 [01:39<02:58,  2.78s/it]Fine-tune Epoch 36/100, Loss: 9.394520e-04, LR: 5.00e-06
 37%|███▋      | 37/100 [01:42<02:56,  2.80s/it]Fine-tune Epoch 37/100, Loss: 9.141034e-04, LR: 5.00e-06
 38%|███▊      | 38/100 [01:45<02:55,  2.83s/it]Fine-tune Epoch 38/100, Loss: 8.898515e-04, LR: 5.00e-06
 39%|███▉      | 39/100 [01:48<02:49,  2.78s/it]Fine-tune Epoch 39/100, Loss: 8.675173e-04, LR: 5.00e-06
 40%|████      | 40/100 [01:50<02:45,  2.75s/it]Fine-tune Epoch 40/100, Loss: 8.443602e-04, LR: 5.00e-06
 41%|████      | 41/100 [01:53<02:42,  2.76s/it]Fine-tune Epoch 41/100, Loss: 8.235170e-04, LR: 5.00e-06
 42%|████▏     | 42/100 [01:56<02:43,  2.81s/it]Fine-tune Epoch 42/100, Loss: 8.026084e-04, LR: 5.00e-06
 43%|████▎     | 43/100 [01:59<02:39,  2.81s/it]Fine-tune Epoch 43/100, Loss: 7.828448e-04, LR: 5.00e-06
 44%|████▍     | 44/100 [02:02<02:39,  2.85s/it]Fine-tune Epoch 44/100, Loss: 7.637417e-04, LR: 5.00e-06
 45%|████▌     | 45/100 [02:04<02:34,  2.82s/it]Fine-tune Epoch 45/100, Loss: 7.453355e-04, LR: 5.00e-06
 46%|████▌     | 46/100 [02:07<02:34,  2.87s/it]Fine-tune Epoch 46/100, Loss: 7.281746e-04, LR: 5.00e-06
 47%|████▋     | 47/100 [02:10<02:29,  2.81s/it]Fine-tune Epoch 47/100, Loss: 7.113040e-04, LR: 5.00e-06
 48%|████▊     | 48/100 [02:13<02:25,  2.81s/it]Fine-tune Epoch 48/100, Loss: 6.947033e-04, LR: 5.00e-06
 49%|████▉     | 49/100 [02:16<02:22,  2.80s/it]Fine-tune Epoch 49/100, Loss: 6.789750e-04, LR: 5.00e-06
 50%|█████     | 50/100 [02:18<02:18,  2.76s/it]Fine-tune Epoch 50/100, Loss: 6.635903e-04, LR: 5.00e-06
 51%|█████     | 51/100 [02:21<02:14,  2.75s/it]Fine-tune Epoch 51/100, Loss: 6.489753e-04, LR: 5.00e-06
 52%|█████▏    | 52/100 [02:24<02:11,  2.74s/it]Fine-tune Epoch 52/100, Loss: 6.353386e-04, LR: 5.00e-06
 53%|█████▎    | 53/100 [02:27<02:10,  2.78s/it]Fine-tune Epoch 53/100, Loss: 6.219071e-04, LR: 5.00e-06
 54%|█████▍    | 54/100 [02:29<02:07,  2.77s/it]Fine-tune Epoch 54/100, Loss: 6.091252e-04, LR: 5.00e-06
 55%|█████▌    | 55/100 [02:32<02:03,  2.74s/it]Fine-tune Epoch 55/100, Loss: 5.959644e-04, LR: 5.00e-06
 56%|█████▌    | 56/100 [02:35<02:00,  2.74s/it]Fine-tune Epoch 56/100, Loss: 5.841700e-04, LR: 5.00e-06
 57%|█████▋    | 57/100 [02:38<01:57,  2.74s/it]Fine-tune Epoch 57/100, Loss: 5.720868e-04, LR: 5.00e-06
 58%|█████▊    | 58/100 [02:40<01:54,  2.73s/it]Fine-tune Epoch 58/100, Loss: 5.610621e-04, LR: 5.00e-06
 59%|█████▉    | 59/100 [02:43<01:54,  2.79s/it]Fine-tune Epoch 59/100, Loss: 5.500176e-04, LR: 5.00e-06
 60%|██████    | 60/100 [02:46<01:52,  2.81s/it]Fine-tune Epoch 60/100, Loss: 5.386869e-04, LR: 5.00e-06
 61%|██████    | 61/100 [02:49<01:48,  2.78s/it]Fine-tune Epoch 61/100, Loss: 5.291627e-04, LR: 5.00e-06
 62%|██████▏   | 62/100 [02:52<01:47,  2.82s/it]Fine-tune Epoch 62/100, Loss: 5.192357e-04, LR: 5.00e-06
 63%|██████▎   | 63/100 [02:55<01:44,  2.82s/it]Fine-tune Epoch 63/100, Loss: 5.089941e-04, LR: 5.00e-06
 64%|██████▍   | 64/100 [02:57<01:40,  2.80s/it]Fine-tune Epoch 64/100, Loss: 4.995805e-04, LR: 5.00e-06
 65%|██████▌   | 65/100 [03:00<01:37,  2.79s/it]Fine-tune Epoch 65/100, Loss: 4.907663e-04, LR: 5.00e-06
 66%|██████▌   | 66/100 [03:03<01:35,  2.80s/it]Fine-tune Epoch 66/100, Loss: 4.814021e-04, LR: 5.00e-06
 67%|██████▋   | 67/100 [03:06<01:33,  2.84s/it]Fine-tune Epoch 67/100, Loss: 4.734709e-04, LR: 5.00e-06
 68%|██████▊   | 68/100 [03:09<01:29,  2.81s/it]Fine-tune Epoch 68/100, Loss: 4.652349e-04, LR: 5.00e-06
 69%|██████▉   | 69/100 [03:11<01:26,  2.79s/it]Fine-tune Epoch 69/100, Loss: 4.576619e-04, LR: 5.00e-06
 70%|███████   | 70/100 [03:14<01:26,  2.87s/it]Fine-tune Epoch 70/100, Loss: 4.491755e-04, LR: 5.00e-06
 71%|███████   | 71/100 [03:17<01:22,  2.85s/it]Fine-tune Epoch 71/100, Loss: 4.416583e-04, LR: 5.00e-06
 72%|███████▏  | 72/100 [03:20<01:20,  2.89s/it]Fine-tune Epoch 72/100, Loss: 4.340702e-04, LR: 5.00e-06
 73%|███████▎  | 73/100 [03:23<01:17,  2.87s/it]Fine-tune Epoch 73/100, Loss: 4.274953e-04, LR: 5.00e-06
 74%|███████▍  | 74/100 [03:26<01:14,  2.86s/it]Fine-tune Epoch 74/100, Loss: 4.202349e-04, LR: 5.00e-06
 75%|███████▌  | 75/100 [03:29<01:10,  2.83s/it]Fine-tune Epoch 75/100, Loss: 4.135164e-04, LR: 5.00e-06
 76%|███████▌  | 76/100 [03:31<01:07,  2.83s/it]Fine-tune Epoch 76/100, Loss: 4.067023e-04, LR: 5.00e-06
 77%|███████▋  | 77/100 [03:34<01:05,  2.87s/it]Fine-tune Epoch 77/100, Loss: 4.005035e-04, LR: 5.00e-06
 78%|███████▊  | 78/100 [03:37<01:03,  2.87s/it]Fine-tune Epoch 78/100, Loss: 3.945125e-04, LR: 5.00e-06
 79%|███████▉  | 79/100 [03:40<01:00,  2.86s/it]Fine-tune Epoch 79/100, Loss: 3.883257e-04, LR: 5.00e-06
 80%|████████  | 80/100 [03:43<00:57,  2.85s/it]Fine-tune Epoch 80/100, Loss: 3.823196e-04, LR: 5.00e-06
 81%|████████  | 81/100 [03:46<00:54,  2.88s/it]Fine-tune Epoch 81/100, Loss: 3.769291e-04, LR: 5.00e-06
 82%|████████▏ | 82/100 [03:49<00:50,  2.83s/it]Fine-tune Epoch 82/100, Loss: 3.707893e-04, LR: 5.00e-06
 83%|████████▎ | 83/100 [03:52<00:48,  2.88s/it]Fine-tune Epoch 83/100, Loss: 3.653242e-04, LR: 5.00e-06
 84%|████████▍ | 84/100 [03:54<00:45,  2.83s/it]Fine-tune Epoch 84/100, Loss: 3.603842e-04, LR: 5.00e-06
 85%|████████▌ | 85/100 [03:57<00:42,  2.80s/it]Fine-tune Epoch 85/100, Loss: 3.551918e-04, LR: 5.00e-06
 86%|████████▌ | 86/100 [04:00<00:38,  2.78s/it]Fine-tune Epoch 86/100, Loss: 3.495671e-04, LR: 5.00e-06
 87%|████████▋ | 87/100 [04:03<00:36,  2.77s/it]Fine-tune Epoch 87/100, Loss: 3.449620e-04, LR: 5.00e-06
 88%|████████▊ | 88/100 [04:05<00:32,  2.74s/it]Fine-tune Epoch 88/100, Loss: 3.400862e-04, LR: 5.00e-06
 89%|████████▉ | 89/100 [04:08<00:31,  2.82s/it]Fine-tune Epoch 89/100, Loss: 3.350415e-04, LR: 5.00e-06
 90%|█████████ | 90/100 [04:11<00:28,  2.84s/it]Fine-tune Epoch 90/100, Loss: 3.312585e-04, LR: 5.00e-06
 91%|█████████ | 91/100 [04:14<00:25,  2.82s/it]Fine-tune Epoch 91/100, Loss: 3.270390e-04, LR: 5.00e-06
 92%|█████████▏| 92/100 [04:17<00:22,  2.78s/it]Fine-tune Epoch 92/100, Loss: 3.222487e-04, LR: 5.00e-06
 93%|█████████▎| 93/100 [04:19<00:19,  2.82s/it]Fine-tune Epoch 93/100, Loss: 3.181558e-04, LR: 5.00e-06
 94%|█████████▍| 94/100 [04:22<00:16,  2.82s/it]Fine-tune Epoch 94/100, Loss: 3.141231e-04, LR: 5.00e-06
 95%|█████████▌| 95/100 [04:25<00:13,  2.79s/it]Fine-tune Epoch 95/100, Loss: 3.097090e-04, LR: 5.00e-06
 96%|█████████▌| 96/100 [04:28<00:11,  2.81s/it]Fine-tune Epoch 96/100, Loss: 3.061845e-04, LR: 5.00e-06
 97%|█████████▋| 97/100 [04:31<00:08,  2.85s/it]Fine-tune Epoch 97/100, Loss: 3.023725e-04, LR: 5.00e-06
 98%|█████████▊| 98/100 [04:33<00:05,  2.77s/it]Fine-tune Epoch 98/100, Loss: 2.984220e-04, LR: 5.00e-06
 99%|█████████▉| 99/100 [04:36<00:02,  2.74s/it]Fine-tune Epoch 99/100, Loss: 2.946947e-04, LR: 5.00e-06
100%|██████████| 100/100 [04:39<00:00,  2.77s/it]100%|██████████| 100/100 [04:39<00:00,  2.79s/it]
Fine-tune Epoch 100/100, Loss: 2.910619e-04, LR: 5.00e-06

Final PSNR after pruning and fine-tuning: 41.9184
Pruning resulted in PSNR 41.92 which is below target 50.00. Consider less aggressive pruning.
Saved best pruned model to ./models/pruned_siren_std_120n.pth

Attempting to prune with ratio: 25%
Original hidden neurons: 150, New hidden neurons: 113 (Pruning 37 neurons)
New pruned model architecture:
MyResidualSirenNet(
  (net_layers): ModuleList(
    (0): SineLayer(
      (linear): Linear(in_features=3, out_features=113, bias=True)
    )
    (1-6): 6 x ResidualSineLayer(
      (linear_1): Linear(in_features=113, out_features=113, bias=True)
      (linear_2): Linear(in_features=113, out_features=113, bias=True)
    )
    (7): Linear(in_features=113, out_features=1, bias=True)
  )
)
New pruned model parameters: 155150
Parameter reduction: 43.07%

--- Fine-tuning pruned model for 100 epochs ---
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:02<04:35,  2.78s/it]Fine-tune Epoch 1/100, Loss: 1.111685e-02, LR: 5.00e-06
  2%|▏         | 2/100 [00:05<04:37,  2.83s/it]Fine-tune Epoch 2/100, Loss: 5.597226e-03, LR: 5.00e-06
  3%|▎         | 3/100 [00:08<04:40,  2.89s/it]Fine-tune Epoch 3/100, Loss: 4.501221e-03, LR: 5.00e-06
  4%|▍         | 4/100 [00:11<04:29,  2.81s/it]Fine-tune Epoch 4/100, Loss: 3.901587e-03, LR: 5.00e-06
  5%|▌         | 5/100 [00:14<04:31,  2.86s/it]Fine-tune Epoch 5/100, Loss: 3.516365e-03, LR: 5.00e-06
  6%|▌         | 6/100 [00:16<04:23,  2.80s/it]Fine-tune Epoch 6/100, Loss: 3.240150e-03, LR: 5.00e-06
  7%|▋         | 7/100 [00:19<04:21,  2.81s/it]Fine-tune Epoch 7/100, Loss: 3.026093e-03, LR: 5.00e-06
  8%|▊         | 8/100 [00:22<04:21,  2.84s/it]Fine-tune Epoch 8/100, Loss: 2.852797e-03, LR: 5.00e-06
  9%|▉         | 9/100 [00:25<04:15,  2.81s/it]Fine-tune Epoch 9/100, Loss: 2.706858e-03, LR: 5.00e-06
 10%|█         | 10/100 [00:28<04:13,  2.81s/it]Fine-tune Epoch 10/100, Loss: 2.579331e-03, LR: 5.00e-06
 11%|█         | 11/100 [00:30<04:06,  2.77s/it]Fine-tune Epoch 11/100, Loss: 2.467446e-03, LR: 5.00e-06
 12%|█▏        | 12/100 [00:33<04:06,  2.80s/it]Fine-tune Epoch 12/100, Loss: 2.367271e-03, LR: 5.00e-06
 13%|█▎        | 13/100 [00:36<04:09,  2.87s/it]Fine-tune Epoch 13/100, Loss: 2.274618e-03, LR: 5.00e-06
 14%|█▍        | 14/100 [00:39<04:08,  2.88s/it]Fine-tune Epoch 14/100, Loss: 2.189431e-03, LR: 5.00e-06
 15%|█▌        | 15/100 [00:42<04:05,  2.89s/it]Fine-tune Epoch 15/100, Loss: 2.111442e-03, LR: 5.00e-06
 16%|█▌        | 16/100 [00:45<04:00,  2.86s/it]Fine-tune Epoch 16/100, Loss: 2.039034e-03, LR: 5.00e-06
 17%|█▋        | 17/100 [00:48<04:00,  2.89s/it]Fine-tune Epoch 17/100, Loss: 1.970872e-03, LR: 5.00e-06
 18%|█▊        | 18/100 [00:51<03:58,  2.91s/it]Fine-tune Epoch 18/100, Loss: 1.907460e-03, LR: 5.00e-06
 19%|█▉        | 19/100 [00:54<03:52,  2.87s/it]Fine-tune Epoch 19/100, Loss: 1.846635e-03, LR: 5.00e-06
 20%|██        | 20/100 [00:57<03:50,  2.88s/it]Fine-tune Epoch 20/100, Loss: 1.790118e-03, LR: 5.00e-06
 21%|██        | 21/100 [00:59<03:43,  2.83s/it]Fine-tune Epoch 21/100, Loss: 1.736539e-03, LR: 5.00e-06
 22%|██▏       | 22/100 [01:02<03:40,  2.83s/it]Fine-tune Epoch 22/100, Loss: 1.684084e-03, LR: 5.00e-06
 23%|██▎       | 23/100 [01:05<03:33,  2.77s/it]Fine-tune Epoch 23/100, Loss: 1.635641e-03, LR: 5.00e-06
 24%|██▍       | 24/100 [01:07<03:30,  2.77s/it]Fine-tune Epoch 24/100, Loss: 1.589000e-03, LR: 5.00e-06
 25%|██▌       | 25/100 [01:10<03:31,  2.82s/it]Fine-tune Epoch 25/100, Loss: 1.544543e-03, LR: 5.00e-06
 26%|██▌       | 26/100 [01:13<03:27,  2.81s/it]Fine-tune Epoch 26/100, Loss: 1.502122e-03, LR: 5.00e-06
 27%|██▋       | 27/100 [01:16<03:31,  2.90s/it]Fine-tune Epoch 27/100, Loss: 1.460525e-03, LR: 5.00e-06
 28%|██▊       | 28/100 [01:20<03:38,  3.04s/it]Fine-tune Epoch 28/100, Loss: 1.422137e-03, LR: 5.00e-06
 29%|██▉       | 29/100 [01:23<03:32,  2.99s/it]Fine-tune Epoch 29/100, Loss: 1.384158e-03, LR: 5.00e-06
 30%|███       | 30/100 [01:25<03:24,  2.92s/it]Fine-tune Epoch 30/100, Loss: 1.347825e-03, LR: 5.00e-06
 31%|███       | 31/100 [01:28<03:17,  2.86s/it]Fine-tune Epoch 31/100, Loss: 1.312614e-03, LR: 5.00e-06
 32%|███▏      | 32/100 [01:31<03:13,  2.85s/it]Fine-tune Epoch 32/100, Loss: 1.280935e-03, LR: 5.00e-06
 33%|███▎      | 33/100 [01:34<03:09,  2.82s/it]Fine-tune Epoch 33/100, Loss: 1.248923e-03, LR: 5.00e-06
 34%|███▍      | 34/100 [01:36<03:04,  2.79s/it]Fine-tune Epoch 34/100, Loss: 1.218575e-03, LR: 5.00e-06
 35%|███▌      | 35/100 [01:39<02:58,  2.74s/it]Fine-tune Epoch 35/100, Loss: 1.189420e-03, LR: 5.00e-06
 36%|███▌      | 36/100 [01:42<03:01,  2.84s/it]Fine-tune Epoch 36/100, Loss: 1.161366e-03, LR: 5.00e-06
 37%|███▋      | 37/100 [01:45<02:57,  2.81s/it]Fine-tune Epoch 37/100, Loss: 1.133613e-03, LR: 5.00e-06
 38%|███▊      | 38/100 [01:47<02:52,  2.78s/it]Fine-tune Epoch 38/100, Loss: 1.107777e-03, LR: 5.00e-06
 39%|███▉      | 39/100 [01:50<02:48,  2.76s/it]Fine-tune Epoch 39/100, Loss: 1.082326e-03, LR: 5.00e-06
 40%|████      | 40/100 [01:53<02:51,  2.86s/it]Fine-tune Epoch 40/100, Loss: 1.058847e-03, LR: 5.00e-06
 41%|████      | 41/100 [01:56<02:47,  2.84s/it]Fine-tune Epoch 41/100, Loss: 1.034222e-03, LR: 5.00e-06
 42%|████▏     | 42/100 [01:59<02:44,  2.84s/it]Fine-tune Epoch 42/100, Loss: 1.012088e-03, LR: 5.00e-06
 43%|████▎     | 43/100 [02:02<02:39,  2.80s/it]Fine-tune Epoch 43/100, Loss: 9.904965e-04, LR: 5.00e-06
 44%|████▍     | 44/100 [02:04<02:36,  2.79s/it]Fine-tune Epoch 44/100, Loss: 9.690985e-04, LR: 5.00e-06
 45%|████▌     | 45/100 [02:07<02:34,  2.81s/it]Fine-tune Epoch 45/100, Loss: 9.488842e-04, LR: 5.00e-06
 46%|████▌     | 46/100 [02:10<02:31,  2.81s/it]Fine-tune Epoch 46/100, Loss: 9.297389e-04, LR: 5.00e-06
 47%|████▋     | 47/100 [02:13<02:30,  2.84s/it]Fine-tune Epoch 47/100, Loss: 9.116475e-04, LR: 5.00e-06
 48%|████▊     | 48/100 [02:16<02:30,  2.89s/it]Fine-tune Epoch 48/100, Loss: 8.925055e-04, LR: 5.00e-06
 49%|████▉     | 49/100 [02:19<02:29,  2.94s/it]Fine-tune Epoch 49/100, Loss: 8.743491e-04, LR: 5.00e-06
 50%|█████     | 50/100 [02:22<02:26,  2.92s/it]Fine-tune Epoch 50/100, Loss: 8.583580e-04, LR: 5.00e-06
 51%|█████     | 51/100 [02:25<02:26,  2.99s/it]Fine-tune Epoch 51/100, Loss: 8.416979e-04, LR: 5.00e-06
 52%|█████▏    | 52/100 [02:28<02:20,  2.92s/it]Fine-tune Epoch 52/100, Loss: 8.259771e-04, LR: 5.00e-06
 53%|█████▎    | 53/100 [02:31<02:21,  3.02s/it]Fine-tune Epoch 53/100, Loss: 8.105715e-04, LR: 5.00e-06
 54%|█████▍    | 54/100 [02:34<02:16,  2.97s/it]Fine-tune Epoch 54/100, Loss: 7.956817e-04, LR: 5.00e-06
 55%|█████▌    | 55/100 [02:37<02:11,  2.93s/it]Fine-tune Epoch 55/100, Loss: 7.804722e-04, LR: 5.00e-06
 56%|█████▌    | 56/100 [02:40<02:07,  2.90s/it]Fine-tune Epoch 56/100, Loss: 7.672677e-04, LR: 5.00e-06
 57%|█████▋    | 57/100 [02:43<02:07,  2.95s/it]Fine-tune Epoch 57/100, Loss: 7.535372e-04, LR: 5.00e-06
 58%|█████▊    | 58/100 [02:45<02:01,  2.90s/it]Fine-tune Epoch 58/100, Loss: 7.404869e-04, LR: 5.00e-06
 59%|█████▉    | 59/100 [02:48<01:58,  2.89s/it]Fine-tune Epoch 59/100, Loss: 7.275859e-04, LR: 5.00e-06
 60%|██████    | 60/100 [02:51<01:57,  2.93s/it]Fine-tune Epoch 60/100, Loss: 7.152426e-04, LR: 5.00e-06
 61%|██████    | 61/100 [02:54<01:54,  2.95s/it]Fine-tune Epoch 61/100, Loss: 7.034147e-04, LR: 5.00e-06
 62%|██████▏   | 62/100 [02:57<01:50,  2.90s/it]Fine-tune Epoch 62/100, Loss: 6.918367e-04, LR: 5.00e-06
 63%|██████▎   | 63/100 [03:00<01:52,  3.04s/it]Fine-tune Epoch 63/100, Loss: 6.800692e-04, LR: 5.00e-06
 64%|██████▍   | 64/100 [03:03<01:48,  3.01s/it]Fine-tune Epoch 64/100, Loss: 6.693047e-04, LR: 5.00e-06
 65%|██████▌   | 65/100 [03:06<01:43,  2.97s/it]Fine-tune Epoch 65/100, Loss: 6.589269e-04, LR: 5.00e-06
 66%|██████▌   | 66/100 [03:09<01:40,  2.97s/it]Fine-tune Epoch 66/100, Loss: 6.485471e-04, LR: 5.00e-06
 67%|██████▋   | 67/100 [03:12<01:35,  2.89s/it]Fine-tune Epoch 67/100, Loss: 6.386916e-04, LR: 5.00e-06
 68%|██████▊   | 68/100 [03:15<01:31,  2.87s/it]Fine-tune Epoch 68/100, Loss: 6.292440e-04, LR: 5.00e-06
 69%|██████▉   | 69/100 [03:18<01:28,  2.86s/it]Fine-tune Epoch 69/100, Loss: 6.196550e-04, LR: 5.00e-06
 70%|███████   | 70/100 [03:20<01:25,  2.84s/it]Fine-tune Epoch 70/100, Loss: 6.103125e-04, LR: 5.00e-06
 71%|███████   | 71/100 [03:23<01:21,  2.82s/it]Fine-tune Epoch 71/100, Loss: 6.018750e-04, LR: 5.00e-06
 72%|███████▏  | 72/100 [03:26<01:20,  2.86s/it]Fine-tune Epoch 72/100, Loss: 5.929595e-04, LR: 5.00e-06
 73%|███████▎  | 73/100 [03:29<01:18,  2.90s/it]Fine-tune Epoch 73/100, Loss: 5.839964e-04, LR: 5.00e-06
 74%|███████▍  | 74/100 [03:32<01:15,  2.90s/it]Fine-tune Epoch 74/100, Loss: 5.757003e-04, LR: 5.00e-06
 75%|███████▌  | 75/100 [03:35<01:14,  2.97s/it]Fine-tune Epoch 75/100, Loss: 5.677961e-04, LR: 5.00e-06
 76%|███████▌  | 76/100 [03:38<01:12,  3.00s/it]Fine-tune Epoch 76/100, Loss: 5.593681e-04, LR: 5.00e-06
 77%|███████▋  | 77/100 [03:41<01:08,  2.98s/it]Fine-tune Epoch 77/100, Loss: 5.522325e-04, LR: 5.00e-06
 78%|███████▊  | 78/100 [03:44<01:05,  3.00s/it]Fine-tune Epoch 78/100, Loss: 5.441678e-04, LR: 5.00e-06
 79%|███████▉  | 79/100 [03:47<01:01,  2.92s/it]Fine-tune Epoch 79/100, Loss: 5.370252e-04, LR: 5.00e-06
 80%|████████  | 80/100 [03:50<00:57,  2.87s/it]Fine-tune Epoch 80/100, Loss: 5.305264e-04, LR: 5.00e-06
 81%|████████  | 81/100 [03:53<00:55,  2.90s/it]Fine-tune Epoch 81/100, Loss: 5.236674e-04, LR: 5.00e-06
 82%|████████▏ | 82/100 [03:56<00:52,  2.91s/it]Fine-tune Epoch 82/100, Loss: 5.162479e-04, LR: 5.00e-06
 83%|████████▎ | 83/100 [03:58<00:49,  2.90s/it]Fine-tune Epoch 83/100, Loss: 5.097648e-04, LR: 5.00e-06
 84%|████████▍ | 84/100 [04:01<00:46,  2.91s/it]Fine-tune Epoch 84/100, Loss: 5.039517e-04, LR: 5.00e-06
 85%|████████▌ | 85/100 [04:05<00:44,  2.98s/it]Fine-tune Epoch 85/100, Loss: 4.973229e-04, LR: 5.00e-06
 86%|████████▌ | 86/100 [04:07<00:41,  2.95s/it]Fine-tune Epoch 86/100, Loss: 4.908346e-04, LR: 5.00e-06
 87%|████████▋ | 87/100 [04:10<00:38,  2.96s/it]Fine-tune Epoch 87/100, Loss: 4.849306e-04, LR: 5.00e-06
 88%|████████▊ | 88/100 [04:13<00:35,  2.99s/it]Fine-tune Epoch 88/100, Loss: 4.796417e-04, LR: 5.00e-06
 89%|████████▉ | 89/100 [04:17<00:33,  3.07s/it]Fine-tune Epoch 89/100, Loss: 4.735665e-04, LR: 5.00e-06
 90%|█████████ | 90/100 [04:20<00:30,  3.10s/it]Fine-tune Epoch 90/100, Loss: 4.674316e-04, LR: 5.00e-06
 91%|█████████ | 91/100 [04:23<00:27,  3.05s/it]Fine-tune Epoch 91/100, Loss: 4.621302e-04, LR: 5.00e-06
 92%|█████████▏| 92/100 [04:26<00:23,  2.99s/it]Fine-tune Epoch 92/100, Loss: 4.570642e-04, LR: 5.00e-06
 93%|█████████▎| 93/100 [04:29<00:20,  2.96s/it]Fine-tune Epoch 93/100, Loss: 4.518932e-04, LR: 5.00e-06
 94%|█████████▍| 94/100 [04:31<00:17,  2.92s/it]Fine-tune Epoch 94/100, Loss: 4.461955e-04, LR: 5.00e-06
 95%|█████████▌| 95/100 [04:34<00:14,  2.88s/it]Fine-tune Epoch 95/100, Loss: 4.417007e-04, LR: 5.00e-06
 96%|█████████▌| 96/100 [04:37<00:11,  2.84s/it]Fine-tune Epoch 96/100, Loss: 4.361807e-04, LR: 5.00e-06
 97%|█████████▋| 97/100 [04:40<00:08,  2.83s/it]Fine-tune Epoch 97/100, Loss: 4.319191e-04, LR: 5.00e-06
 98%|█████████▊| 98/100 [04:43<00:05,  2.83s/it]Fine-tune Epoch 98/100, Loss: 4.267826e-04, LR: 5.00e-06
 99%|█████████▉| 99/100 [04:45<00:02,  2.80s/it]Fine-tune Epoch 99/100, Loss: 4.222771e-04, LR: 5.00e-06
100%|██████████| 100/100 [04:48<00:00,  2.89s/it]100%|██████████| 100/100 [04:48<00:00,  2.89s/it]
Fine-tune Epoch 100/100, Loss: 4.174553e-04, LR: 5.00e-06

Final PSNR after pruning and fine-tuning: 40.2599
Pruning resulted in PSNR 40.26 which is below target 50.00. Consider less aggressive pruning.
Saved best pruned model to ./models/pruned_siren_std_113n.pth

Attempting to prune with ratio: 30%
Original hidden neurons: 150, New hidden neurons: 105 (Pruning 45 neurons)
New pruned model architecture:
MyResidualSirenNet(
  (net_layers): ModuleList(
    (0): SineLayer(
      (linear): Linear(in_features=3, out_features=105, bias=True)
    )
    (1-6): 6 x ResidualSineLayer(
      (linear_1): Linear(in_features=105, out_features=105, bias=True)
      (linear_2): Linear(in_features=105, out_features=105, bias=True)
    )
    (7): Linear(in_features=105, out_features=1, bias=True)
  )
)
New pruned model parameters: 134086
Parameter reduction: 50.80%

--- Fine-tuning pruned model for 100 epochs ---
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:02<04:32,  2.75s/it]Fine-tune Epoch 1/100, Loss: 1.410982e-02, LR: 5.00e-06
  2%|▏         | 2/100 [00:05<04:27,  2.73s/it]Fine-tune Epoch 2/100, Loss: 6.245416e-03, LR: 5.00e-06
  3%|▎         | 3/100 [00:08<04:54,  3.04s/it]Fine-tune Epoch 3/100, Loss: 4.993440e-03, LR: 5.00e-06
  4%|▍         | 4/100 [00:11<04:41,  2.93s/it]Fine-tune Epoch 4/100, Loss: 4.299347e-03, LR: 5.00e-06
  5%|▌         | 5/100 [00:14<04:32,  2.87s/it]Fine-tune Epoch 5/100, Loss: 3.862871e-03, LR: 5.00e-06
  6%|▌         | 6/100 [00:17<04:26,  2.84s/it]Fine-tune Epoch 6/100, Loss: 3.560652e-03, LR: 5.00e-06
  7%|▋         | 7/100 [00:20<04:36,  2.97s/it]Fine-tune Epoch 7/100, Loss: 3.334919e-03, LR: 5.00e-06
  8%|▊         | 8/100 [00:23<04:35,  2.99s/it]Fine-tune Epoch 8/100, Loss: 3.156564e-03, LR: 5.00e-06
  9%|▉         | 9/100 [00:26<04:29,  2.96s/it]Fine-tune Epoch 9/100, Loss: 3.007427e-03, LR: 5.00e-06
 10%|█         | 10/100 [00:29<04:27,  2.97s/it]Fine-tune Epoch 10/100, Loss: 2.882093e-03, LR: 5.00e-06
 11%|█         | 11/100 [00:32<04:19,  2.91s/it]Fine-tune Epoch 11/100, Loss: 2.771818e-03, LR: 5.00e-06
 12%|█▏        | 12/100 [00:35<04:17,  2.93s/it]Fine-tune Epoch 12/100, Loss: 2.672871e-03, LR: 5.00e-06
 13%|█▎        | 13/100 [00:38<04:14,  2.93s/it]Fine-tune Epoch 13/100, Loss: 2.584974e-03, LR: 5.00e-06
 14%|█▍        | 14/100 [00:40<04:10,  2.91s/it]Fine-tune Epoch 14/100, Loss: 2.503618e-03, LR: 5.00e-06
 15%|█▌        | 15/100 [00:43<04:03,  2.87s/it]Fine-tune Epoch 15/100, Loss: 2.428711e-03, LR: 5.00e-06
 16%|█▌        | 16/100 [00:46<04:04,  2.91s/it]Fine-tune Epoch 16/100, Loss: 2.359415e-03, LR: 5.00e-06
 17%|█▋        | 17/100 [00:49<04:01,  2.91s/it]Fine-tune Epoch 17/100, Loss: 2.295232e-03, LR: 5.00e-06
 18%|█▊        | 18/100 [00:52<03:55,  2.87s/it]Fine-tune Epoch 18/100, Loss: 2.233326e-03, LR: 5.00e-06
 19%|█▉        | 19/100 [00:55<03:58,  2.94s/it]Fine-tune Epoch 19/100, Loss: 2.174698e-03, LR: 5.00e-06
 20%|██        | 20/100 [00:58<03:55,  2.94s/it]Fine-tune Epoch 20/100, Loss: 2.119512e-03, LR: 5.00e-06
 21%|██        | 21/100 [01:01<03:50,  2.92s/it]Fine-tune Epoch 21/100, Loss: 2.067372e-03, LR: 5.00e-06
 22%|██▏       | 22/100 [01:04<03:48,  2.93s/it]Fine-tune Epoch 22/100, Loss: 2.016516e-03, LR: 5.00e-06
 23%|██▎       | 23/100 [01:07<03:43,  2.90s/it]Fine-tune Epoch 23/100, Loss: 1.969691e-03, LR: 5.00e-06
 24%|██▍       | 24/100 [01:09<03:39,  2.89s/it]Fine-tune Epoch 24/100, Loss: 1.923498e-03, LR: 5.00e-06
 25%|██▌       | 25/100 [01:12<03:36,  2.89s/it]Fine-tune Epoch 25/100, Loss: 1.877594e-03, LR: 5.00e-06
 26%|██▌       | 26/100 [01:15<03:39,  2.96s/it]Fine-tune Epoch 26/100, Loss: 1.835968e-03, LR: 5.00e-06
 27%|██▋       | 27/100 [01:19<03:38,  2.99s/it]Fine-tune Epoch 27/100, Loss: 1.794363e-03, LR: 5.00e-06
 28%|██▊       | 28/100 [01:22<03:37,  3.01s/it]Fine-tune Epoch 28/100, Loss: 1.754641e-03, LR: 5.00e-06
 29%|██▉       | 29/100 [01:25<03:31,  2.98s/it]Fine-tune Epoch 29/100, Loss: 1.715942e-03, LR: 5.00e-06
 30%|███       | 30/100 [01:27<03:27,  2.96s/it]Fine-tune Epoch 30/100, Loss: 1.679117e-03, LR: 5.00e-06
 31%|███       | 31/100 [01:30<03:25,  2.98s/it]Fine-tune Epoch 31/100, Loss: 1.644764e-03, LR: 5.00e-06
 32%|███▏      | 32/100 [01:33<03:24,  3.00s/it]Fine-tune Epoch 32/100, Loss: 1.608872e-03, LR: 5.00e-06
 33%|███▎      | 33/100 [01:37<03:22,  3.02s/it]Fine-tune Epoch 33/100, Loss: 1.576602e-03, LR: 5.00e-06
 34%|███▍      | 34/100 [01:40<03:19,  3.03s/it]Fine-tune Epoch 34/100, Loss: 1.543561e-03, LR: 5.00e-06
 35%|███▌      | 35/100 [01:42<03:13,  2.97s/it]Fine-tune Epoch 35/100, Loss: 1.512344e-03, LR: 5.00e-06
 36%|███▌      | 36/100 [01:45<03:09,  2.96s/it]Fine-tune Epoch 36/100, Loss: 1.482268e-03, LR: 5.00e-06
 37%|███▋      | 37/100 [01:48<03:06,  2.97s/it]Fine-tune Epoch 37/100, Loss: 1.453587e-03, LR: 5.00e-06
 38%|███▊      | 38/100 [01:51<03:00,  2.92s/it]Fine-tune Epoch 38/100, Loss: 1.425446e-03, LR: 5.00e-06
 39%|███▉      | 39/100 [01:54<03:02,  2.99s/it]Fine-tune Epoch 39/100, Loss: 1.397508e-03, LR: 5.00e-06
 40%|████      | 40/100 [01:57<03:00,  3.01s/it]Fine-tune Epoch 40/100, Loss: 1.370810e-03, LR: 5.00e-06
 41%|████      | 41/100 [02:01<03:01,  3.07s/it]Fine-tune Epoch 41/100, Loss: 1.344587e-03, LR: 5.00e-06
 42%|████▏     | 42/100 [02:03<02:54,  3.01s/it]Fine-tune Epoch 42/100, Loss: 1.320387e-03, LR: 5.00e-06
 43%|████▎     | 43/100 [02:07<02:54,  3.06s/it]Fine-tune Epoch 43/100, Loss: 1.296079e-03, LR: 5.00e-06
 44%|████▍     | 44/100 [02:10<02:50,  3.04s/it]Fine-tune Epoch 44/100, Loss: 1.272321e-03, LR: 5.00e-06
 45%|████▌     | 45/100 [02:13<02:48,  3.06s/it]Fine-tune Epoch 45/100, Loss: 1.249524e-03, LR: 5.00e-06
 46%|████▌     | 46/100 [02:16<02:43,  3.03s/it]Fine-tune Epoch 46/100, Loss: 1.228270e-03, LR: 5.00e-06
 47%|████▋     | 47/100 [02:19<02:37,  2.98s/it]Fine-tune Epoch 47/100, Loss: 1.206586e-03, LR: 5.00e-06
 48%|████▊     | 48/100 [02:21<02:33,  2.96s/it]Fine-tune Epoch 48/100, Loss: 1.186607e-03, LR: 5.00e-06
 49%|████▉     | 49/100 [02:24<02:31,  2.98s/it]Fine-tune Epoch 49/100, Loss: 1.165950e-03, LR: 5.00e-06
 50%|█████     | 50/100 [02:27<02:29,  2.98s/it]Fine-tune Epoch 50/100, Loss: 1.147126e-03, LR: 5.00e-06
 51%|█████     | 51/100 [02:30<02:25,  2.96s/it]Fine-tune Epoch 51/100, Loss: 1.127145e-03, LR: 5.00e-06
 52%|█████▏    | 52/100 [02:34<02:27,  3.07s/it]Fine-tune Epoch 52/100, Loss: 1.109272e-03, LR: 5.00e-06
 53%|█████▎    | 53/100 [02:37<02:26,  3.11s/it]Fine-tune Epoch 53/100, Loss: 1.092182e-03, LR: 5.00e-06
 54%|█████▍    | 54/100 [02:40<02:21,  3.09s/it]Fine-tune Epoch 54/100, Loss: 1.072992e-03, LR: 5.00e-06
 55%|█████▌    | 55/100 [02:43<02:18,  3.08s/it]Fine-tune Epoch 55/100, Loss: 1.056829e-03, LR: 5.00e-06
 56%|█████▌    | 56/100 [02:46<02:15,  3.07s/it]Fine-tune Epoch 56/100, Loss: 1.039768e-03, LR: 5.00e-06
 57%|█████▋    | 57/100 [02:49<02:12,  3.07s/it]Fine-tune Epoch 57/100, Loss: 1.024964e-03, LR: 5.00e-06
 58%|█████▊    | 58/100 [02:52<02:07,  3.05s/it]Fine-tune Epoch 58/100, Loss: 1.007629e-03, LR: 5.00e-06
 59%|█████▉    | 59/100 [02:55<02:04,  3.04s/it]Fine-tune Epoch 59/100, Loss: 9.930424e-04, LR: 5.00e-06
 60%|██████    | 60/100 [02:58<02:00,  3.01s/it]Fine-tune Epoch 60/100, Loss: 9.788251e-04, LR: 5.00e-06
 61%|██████    | 61/100 [03:01<01:58,  3.03s/it]Fine-tune Epoch 61/100, Loss: 9.643615e-04, LR: 5.00e-06
 62%|██████▏   | 62/100 [03:04<01:54,  3.01s/it]Fine-tune Epoch 62/100, Loss: 9.505277e-04, LR: 5.00e-06
 63%|██████▎   | 63/100 [03:07<01:49,  2.97s/it]Fine-tune Epoch 63/100, Loss: 9.365098e-04, LR: 5.00e-06
 64%|██████▍   | 64/100 [03:10<01:46,  2.96s/it]Fine-tune Epoch 64/100, Loss: 9.233146e-04, LR: 5.00e-06
 65%|██████▌   | 65/100 [03:13<01:41,  2.89s/it]Fine-tune Epoch 65/100, Loss: 9.096481e-04, LR: 5.00e-06
 66%|██████▌   | 66/100 [03:16<01:41,  2.98s/it]Fine-tune Epoch 66/100, Loss: 8.985552e-04, LR: 5.00e-06
 67%|██████▋   | 67/100 [03:19<01:39,  3.03s/it]Fine-tune Epoch 67/100, Loss: 8.847071e-04, LR: 5.00e-06
 68%|██████▊   | 68/100 [03:22<01:35,  3.00s/it]Fine-tune Epoch 68/100, Loss: 8.726090e-04, LR: 5.00e-06
 69%|██████▉   | 69/100 [03:25<01:32,  3.00s/it]Fine-tune Epoch 69/100, Loss: 8.599929e-04, LR: 5.00e-06
 70%|███████   | 70/100 [03:28<01:29,  2.97s/it]Fine-tune Epoch 70/100, Loss: 8.492519e-04, LR: 5.00e-06
 71%|███████   | 71/100 [03:31<01:26,  3.00s/it]Fine-tune Epoch 71/100, Loss: 8.382174e-04, LR: 5.00e-06
 72%|███████▏  | 72/100 [03:34<01:22,  2.95s/it]Fine-tune Epoch 72/100, Loss: 8.271281e-04, LR: 5.00e-06
 73%|███████▎  | 73/100 [03:37<01:19,  2.94s/it]Fine-tune Epoch 73/100, Loss: 8.167700e-04, LR: 5.00e-06
 74%|███████▍  | 74/100 [03:39<01:14,  2.87s/it]Fine-tune Epoch 74/100, Loss: 8.052565e-04, LR: 5.00e-06
 75%|███████▌  | 75/100 [03:42<01:12,  2.89s/it]Fine-tune Epoch 75/100, Loss: 7.951895e-04, LR: 5.00e-06
 76%|███████▌  | 76/100 [03:45<01:09,  2.90s/it]Fine-tune Epoch 76/100, Loss: 7.853489e-04, LR: 5.00e-06
 77%|███████▋  | 77/100 [03:48<01:07,  2.94s/it]Fine-tune Epoch 77/100, Loss: 7.755802e-04, LR: 5.00e-06
 78%|███████▊  | 78/100 [03:51<01:04,  2.92s/it]Fine-tune Epoch 78/100, Loss: 7.662905e-04, LR: 5.00e-06
 79%|███████▉  | 79/100 [03:54<01:00,  2.90s/it]Fine-tune Epoch 79/100, Loss: 7.565307e-04, LR: 5.00e-06
 80%|████████  | 80/100 [03:57<00:58,  2.91s/it]Fine-tune Epoch 80/100, Loss: 7.472913e-04, LR: 5.00e-06
 81%|████████  | 81/100 [04:00<00:54,  2.87s/it]Fine-tune Epoch 81/100, Loss: 7.390475e-04, LR: 5.00e-06
 82%|████████▏ | 82/100 [04:03<00:51,  2.88s/it]Fine-tune Epoch 82/100, Loss: 7.295461e-04, LR: 5.00e-06
 83%|████████▎ | 83/100 [04:05<00:48,  2.83s/it]Fine-tune Epoch 83/100, Loss: 7.211539e-04, LR: 5.00e-06
 84%|████████▍ | 84/100 [04:08<00:45,  2.85s/it]Fine-tune Epoch 84/100, Loss: 7.136856e-04, LR: 5.00e-06
 85%|████████▌ | 85/100 [04:11<00:41,  2.80s/it]Fine-tune Epoch 85/100, Loss: 7.050503e-04, LR: 5.00e-06
 86%|████████▌ | 86/100 [04:14<00:38,  2.78s/it]Fine-tune Epoch 86/100, Loss: 6.966394e-04, LR: 5.00e-06
 87%|████████▋ | 87/100 [04:16<00:35,  2.76s/it]Fine-tune Epoch 87/100, Loss: 6.887646e-04, LR: 5.00e-06
 88%|████████▊ | 88/100 [04:19<00:33,  2.80s/it]Fine-tune Epoch 88/100, Loss: 6.814451e-04, LR: 5.00e-06
 89%|████████▉ | 89/100 [04:22<00:31,  2.84s/it]Fine-tune Epoch 89/100, Loss: 6.744841e-04, LR: 5.00e-06
 90%|█████████ | 90/100 [04:25<00:28,  2.89s/it]Fine-tune Epoch 90/100, Loss: 6.666776e-04, LR: 5.00e-06
 91%|█████████ | 91/100 [04:28<00:25,  2.85s/it]Fine-tune Epoch 91/100, Loss: 6.600041e-04, LR: 5.00e-06
 92%|█████████▏| 92/100 [04:31<00:23,  2.91s/it]Fine-tune Epoch 92/100, Loss: 6.536680e-04, LR: 5.00e-06
 93%|█████████▎| 93/100 [04:34<00:19,  2.85s/it]Fine-tune Epoch 93/100, Loss: 6.456483e-04, LR: 5.00e-06
 94%|█████████▍| 94/100 [04:37<00:17,  2.88s/it]Fine-tune Epoch 94/100, Loss: 6.390621e-04, LR: 5.00e-06
 95%|█████████▌| 95/100 [04:39<00:14,  2.87s/it]Fine-tune Epoch 95/100, Loss: 6.328286e-04, LR: 5.00e-06
 96%|█████████▌| 96/100 [04:42<00:11,  2.83s/it]Fine-tune Epoch 96/100, Loss: 6.259001e-04, LR: 5.00e-06
 97%|█████████▋| 97/100 [04:45<00:08,  2.80s/it]Fine-tune Epoch 97/100, Loss: 6.195587e-04, LR: 5.00e-06
 98%|█████████▊| 98/100 [04:48<00:05,  2.78s/it]Fine-tune Epoch 98/100, Loss: 6.142488e-04, LR: 5.00e-06
 99%|█████████▉| 99/100 [04:50<00:02,  2.74s/it]Fine-tune Epoch 99/100, Loss: 6.081731e-04, LR: 5.00e-06
100%|██████████| 100/100 [04:53<00:00,  2.76s/it]100%|██████████| 100/100 [04:53<00:00,  2.94s/it]
Fine-tune Epoch 100/100, Loss: 6.018121e-04, LR: 5.00e-06

Final PSNR after pruning and fine-tuning: 38.5533
Pruning resulted in PSNR 38.55 which is below target 50.00. Consider less aggressive pruning.
Saved best pruned model to ./models/pruned_siren_std_105n.pth

--- Pruning Process Complete ---
Best pruned model found with 150 neurons and PSNR: 61.88
Original model parameters: 272551
Final pruned model parameters: 134086
Total parameter reduction: 50.80%
Loading original model from 150_neurons_std.pth
Initial PSNR (Mean Model): 61.8823
Original model parameters: 272551

Attempting to prune with ratio: 5%
Calculating gradient-aware importance scores...
Original hidden neurons: 150, New hidden neurons: 143 (Pruning 7 neurons)
New pruned model parameters: 0.25M

--- Fine-tuning pruned model for 100 epochs ---
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:02<04:28,  2.71s/it]  2%|▏         | 2/100 [00:05<04:25,  2.71s/it]  3%|▎         | 3/100 [00:08<04:25,  2.74s/it]  4%|▍         | 4/100 [00:10<04:25,  2.77s/it]  5%|▌         | 5/100 [00:13<04:28,  2.83s/it]  6%|▌         | 6/100 [00:16<04:26,  2.83s/it]  7%|▋         | 7/100 [00:19<04:20,  2.80s/it]  8%|▊         | 8/100 [00:22<04:20,  2.84s/it]  9%|▉         | 9/100 [00:25<04:16,  2.82s/it] 10%|█         | 10/100 [00:27<04:09,  2.78s/it] 11%|█         | 11/100 [00:30<04:07,  2.78s/it] 12%|█▏        | 12/100 [00:33<04:04,  2.78s/it] 13%|█▎        | 13/100 [00:36<04:03,  2.79s/it] 14%|█▍        | 14/100 [00:39<04:03,  2.83s/it] 15%|█▌        | 15/100 [00:41<03:53,  2.75s/it] 16%|█▌        | 16/100 [00:44<03:50,  2.74s/it] 17%|█▋        | 17/100 [00:47<03:50,  2.78s/it] 18%|█▊        | 18/100 [00:50<03:46,  2.76s/it] 19%|█▉        | 19/100 [00:52<03:41,  2.73s/it] 20%|██        | 20/100 [00:55<03:38,  2.74s/it] 21%|██        | 21/100 [00:58<03:37,  2.75s/it] 22%|██▏       | 22/100 [01:01<03:37,  2.79s/it] 23%|██▎       | 23/100 [01:04<03:41,  2.88s/it] 24%|██▍       | 24/100 [01:06<03:34,  2.82s/it] 25%|██▌       | 25/100 [01:09<03:33,  2.85s/it] 26%|██▌       | 26/100 [01:12<03:27,  2.81s/it] 27%|██▋       | 27/100 [01:15<03:28,  2.86s/it] 28%|██▊       | 28/100 [01:18<03:23,  2.82s/it] 29%|██▉       | 29/100 [01:20<03:18,  2.79s/it] 30%|███       | 30/100 [01:23<03:13,  2.76s/it] 31%|███       | 31/100 [01:26<03:12,  2.79s/it] 32%|███▏      | 32/100 [01:29<03:06,  2.75s/it] 33%|███▎      | 33/100 [01:31<03:05,  2.76s/it] 34%|███▍      | 34/100 [01:34<03:02,  2.76s/it] 35%|███▌      | 35/100 [01:37<03:01,  2.80s/it] 36%|███▌      | 36/100 [01:40<02:58,  2.78s/it] 37%|███▋      | 37/100 [01:43<02:54,  2.78s/it] 38%|███▊      | 38/100 [01:45<02:51,  2.77s/it] 39%|███▉      | 39/100 [01:48<02:51,  2.82s/it] 40%|████      | 40/100 [01:51<02:47,  2.79s/it] 41%|████      | 41/100 [01:54<02:46,  2.81s/it] 42%|████▏     | 42/100 [01:57<02:46,  2.88s/it] 43%|████▎     | 43/100 [02:00<02:47,  2.93s/it] 44%|████▍     | 44/100 [02:03<02:40,  2.87s/it] 45%|████▌     | 45/100 [02:05<02:36,  2.84s/it] 46%|████▌     | 46/100 [02:08<02:31,  2.80s/it] 47%|████▋     | 47/100 [02:11<02:30,  2.83s/it] 48%|████▊     | 48/100 [02:14<02:28,  2.85s/it] 49%|████▉     | 49/100 [02:17<02:22,  2.80s/it] 50%|█████     | 50/100 [02:20<02:20,  2.81s/it] 51%|█████     | 51/100 [02:22<02:17,  2.80s/it] 52%|█████▏    | 52/100 [02:25<02:15,  2.82s/it] 53%|█████▎    | 53/100 [02:28<02:12,  2.82s/it] 54%|█████▍    | 54/100 [02:31<02:11,  2.86s/it] 55%|█████▌    | 55/100 [02:34<02:07,  2.83s/it] 56%|█████▌    | 56/100 [02:36<02:04,  2.83s/it] 57%|█████▋    | 57/100 [02:39<02:02,  2.86s/it] 58%|█████▊    | 58/100 [02:42<01:59,  2.85s/it] 59%|█████▉    | 59/100 [02:45<01:55,  2.81s/it] 60%|██████    | 60/100 [02:48<01:52,  2.82s/it] 61%|██████    | 61/100 [02:50<01:48,  2.78s/it] 62%|██████▏   | 62/100 [02:53<01:45,  2.78s/it] 63%|██████▎   | 63/100 [02:56<01:42,  2.76s/it] 64%|██████▍   | 64/100 [02:59<01:41,  2.81s/it] 65%|██████▌   | 65/100 [03:02<01:37,  2.77s/it] 66%|██████▌   | 66/100 [03:04<01:33,  2.76s/it] 67%|██████▋   | 67/100 [03:07<01:30,  2.73s/it] 68%|██████▊   | 68/100 [03:10<01:27,  2.74s/it] 69%|██████▉   | 69/100 [03:12<01:24,  2.72s/it] 70%|███████   | 70/100 [03:15<01:23,  2.79s/it] 71%|███████   | 71/100 [03:18<01:21,  2.81s/it] 72%|███████▏  | 72/100 [03:21<01:17,  2.78s/it] 73%|███████▎  | 73/100 [03:24<01:13,  2.73s/it] 74%|███████▍  | 74/100 [03:26<01:11,  2.75s/it] 75%|███████▌  | 75/100 [03:29<01:08,  2.75s/it] 76%|███████▌  | 76/100 [03:32<01:06,  2.76s/it] 77%|███████▋  | 77/100 [03:35<01:03,  2.75s/it] 78%|███████▊  | 78/100 [03:38<01:01,  2.81s/it] 79%|███████▉  | 79/100 [03:40<00:57,  2.76s/it] 80%|████████  | 80/100 [03:43<00:55,  2.78s/it] 81%|████████  | 81/100 [03:46<00:53,  2.79s/it] 82%|████████▏ | 82/100 [03:49<00:50,  2.80s/it] 83%|████████▎ | 83/100 [03:51<00:47,  2.78s/it] 84%|████████▍ | 84/100 [03:54<00:44,  2.79s/it] 85%|████████▌ | 85/100 [03:57<00:41,  2.79s/it] 86%|████████▌ | 86/100 [04:00<00:39,  2.82s/it] 87%|████████▋ | 87/100 [04:03<00:35,  2.76s/it] 88%|████████▊ | 88/100 [04:05<00:33,  2.78s/it] 89%|████████▉ | 89/100 [04:08<00:30,  2.76s/it] 90%|█████████ | 90/100 [04:11<00:27,  2.78s/it] 91%|█████████ | 91/100 [04:14<00:25,  2.79s/it] 92%|█████████▏| 92/100 [04:17<00:22,  2.87s/it] 93%|█████████▎| 93/100 [04:19<00:19,  2.82s/it] 94%|█████████▍| 94/100 [04:22<00:16,  2.81s/it] 95%|█████████▌| 95/100 [04:25<00:13,  2.79s/it] 96%|█████████▌| 96/100 [04:28<00:10,  2.74s/it] 97%|█████████▋| 97/100 [04:30<00:08,  2.70s/it] 98%|█████████▊| 98/100 [04:33<00:05,  2.71s/it] 99%|█████████▉| 99/100 [04:36<00:02,  2.74s/it]100%|██████████| 100/100 [04:39<00:00,  2.77s/it]100%|██████████| 100/100 [04:39<00:00,  2.79s/it]

Final PSNR after pruning and fine-tuning: 49.2228
Pruning failed to meet PSNR target 50.00.
Saved best pruned model to ./models/pruned_siren_std_143n.pth

Attempting to prune with ratio: 10%
Calculating gradient-aware importance scores...
Original hidden neurons: 150, New hidden neurons: 135 (Pruning 15 neurons)
New pruned model parameters: 0.22M

--- Fine-tuning pruned model for 100 epochs ---
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:02<04:22,  2.65s/it]  2%|▏         | 2/100 [00:05<04:20,  2.66s/it]  3%|▎         | 3/100 [00:08<04:19,  2.68s/it]  4%|▍         | 4/100 [00:10<04:21,  2.73s/it]  5%|▌         | 5/100 [00:13<04:26,  2.81s/it]  6%|▌         | 6/100 [00:16<04:24,  2.82s/it]  7%|▋         | 7/100 [00:19<04:24,  2.85s/it]  8%|▊         | 8/100 [00:22<04:17,  2.80s/it]  9%|▉         | 9/100 [00:24<04:08,  2.73s/it] 10%|█         | 10/100 [00:27<04:02,  2.70s/it] 11%|█         | 11/100 [00:30<04:06,  2.77s/it] 12%|█▏        | 12/100 [00:32<04:00,  2.73s/it] 13%|█▎        | 13/100 [00:35<03:59,  2.75s/it] 14%|█▍        | 14/100 [00:38<03:54,  2.73s/it] 15%|█▌        | 15/100 [00:41<03:49,  2.70s/it] 16%|█▌        | 16/100 [00:43<03:44,  2.68s/it] 17%|█▋        | 17/100 [00:46<03:39,  2.65s/it] 18%|█▊        | 18/100 [00:49<03:40,  2.69s/it] 19%|█▉        | 19/100 [00:51<03:34,  2.65s/it] 20%|██        | 20/100 [00:54<03:36,  2.70s/it] 21%|██        | 21/100 [00:57<03:35,  2.72s/it] 22%|██▏       | 22/100 [00:59<03:32,  2.72s/it] 23%|██▎       | 23/100 [01:02<03:27,  2.69s/it] 24%|██▍       | 24/100 [01:05<03:22,  2.66s/it] 25%|██▌       | 25/100 [01:07<03:19,  2.66s/it] 26%|██▌       | 26/100 [01:10<03:22,  2.74s/it] 27%|██▋       | 27/100 [01:13<03:10,  2.62s/it] 28%|██▊       | 28/100 [01:15<03:08,  2.62s/it] 29%|██▉       | 29/100 [01:18<03:05,  2.61s/it] 30%|███       | 30/100 [01:20<03:04,  2.64s/it] 31%|███       | 31/100 [01:23<03:02,  2.65s/it] 32%|███▏      | 32/100 [01:26<03:00,  2.65s/it] 33%|███▎      | 33/100 [01:28<02:55,  2.62s/it] 34%|███▍      | 34/100 [01:31<02:53,  2.63s/it] 35%|███▌      | 35/100 [01:34<02:51,  2.64s/it] 36%|███▌      | 36/100 [01:36<02:49,  2.65s/it] 37%|███▋      | 37/100 [01:39<02:47,  2.65s/it] 38%|███▊      | 38/100 [01:42<02:47,  2.70s/it] 39%|███▉      | 39/100 [01:44<02:41,  2.64s/it] 40%|████      | 40/100 [01:47<02:39,  2.66s/it] 41%|████      | 41/100 [01:50<02:37,  2.67s/it] 42%|████▏     | 42/100 [01:52<02:36,  2.69s/it] 43%|████▎     | 43/100 [01:55<02:32,  2.67s/it] 44%|████▍     | 44/100 [01:58<02:31,  2.70s/it] 45%|████▌     | 45/100 [02:01<02:27,  2.68s/it] 46%|████▌     | 46/100 [02:03<02:25,  2.69s/it] 47%|████▋     | 47/100 [02:06<02:20,  2.65s/it] 48%|████▊     | 48/100 [02:08<02:17,  2.65s/it] 49%|████▉     | 49/100 [02:11<02:17,  2.69s/it] 50%|█████     | 50/100 [02:14<02:15,  2.71s/it] 51%|█████     | 51/100 [02:17<02:11,  2.69s/it] 52%|█████▏    | 52/100 [02:19<02:08,  2.67s/it] 53%|█████▎    | 53/100 [02:22<02:05,  2.67s/it] 54%|█████▍    | 54/100 [02:25<02:03,  2.68s/it] 55%|█████▌    | 55/100 [02:27<02:03,  2.74s/it] 56%|█████▌    | 56/100 [02:30<01:59,  2.71s/it] 57%|█████▋    | 57/100 [02:33<01:55,  2.70s/it] 58%|█████▊    | 58/100 [02:35<01:50,  2.64s/it] 59%|█████▉    | 59/100 [02:38<01:49,  2.66s/it] 60%|██████    | 60/100 [02:41<01:45,  2.64s/it] 61%|██████    | 61/100 [02:43<01:43,  2.66s/it] 62%|██████▏   | 62/100 [02:46<01:39,  2.62s/it] 63%|██████▎   | 63/100 [02:48<01:36,  2.62s/it] 64%|██████▍   | 64/100 [02:51<01:35,  2.65s/it] 65%|██████▌   | 65/100 [02:54<01:32,  2.64s/it] 66%|██████▌   | 66/100 [02:56<01:29,  2.63s/it] 67%|██████▋   | 67/100 [02:59<01:27,  2.65s/it] 68%|██████▊   | 68/100 [03:02<01:25,  2.66s/it] 69%|██████▉   | 69/100 [03:04<01:20,  2.59s/it] 70%|███████   | 70/100 [03:07<01:17,  2.58s/it] 71%|███████   | 71/100 [03:09<01:15,  2.60s/it] 72%|███████▏  | 72/100 [03:12<01:13,  2.63s/it] 73%|███████▎  | 73/100 [03:15<01:11,  2.66s/it] 74%|███████▍  | 74/100 [03:17<01:09,  2.66s/it] 75%|███████▌  | 75/100 [03:20<01:08,  2.73s/it] 76%|███████▌  | 76/100 [03:23<01:03,  2.65s/it] 77%|███████▋  | 77/100 [03:25<01:00,  2.63s/it] 78%|███████▊  | 78/100 [03:28<00:57,  2.63s/it] 79%|███████▉  | 79/100 [03:31<00:55,  2.65s/it] 80%|████████  | 80/100 [03:34<00:53,  2.69s/it] 81%|████████  | 81/100 [03:36<00:50,  2.67s/it] 82%|████████▏ | 82/100 [03:39<00:48,  2.68s/it] 83%|████████▎ | 83/100 [03:41<00:44,  2.62s/it] 84%|████████▍ | 84/100 [03:44<00:42,  2.65s/it] 85%|████████▌ | 85/100 [03:47<00:39,  2.62s/it] 86%|████████▌ | 86/100 [03:49<00:36,  2.63s/it] 87%|████████▋ | 87/100 [03:52<00:34,  2.64s/it] 88%|████████▊ | 88/100 [03:55<00:32,  2.68s/it] 89%|████████▉ | 89/100 [03:57<00:29,  2.68s/it] 90%|█████████ | 90/100 [04:00<00:27,  2.73s/it] 91%|█████████ | 91/100 [04:03<00:23,  2.65s/it] 92%|█████████▏| 92/100 [04:05<00:20,  2.61s/it] 93%|█████████▎| 93/100 [04:08<00:17,  2.57s/it] 94%|█████████▍| 94/100 [04:10<00:15,  2.59s/it] 95%|█████████▌| 95/100 [04:13<00:12,  2.59s/it] 96%|█████████▌| 96/100 [04:16<00:10,  2.64s/it] 97%|█████████▋| 97/100 [04:18<00:07,  2.60s/it] 98%|█████████▊| 98/100 [04:21<00:05,  2.62s/it] 99%|█████████▉| 99/100 [04:23<00:02,  2.63s/it]100%|██████████| 100/100 [04:26<00:00,  2.62s/it]100%|██████████| 100/100 [04:26<00:00,  2.67s/it]

Final PSNR after pruning and fine-tuning: 46.3143
Pruning failed to meet PSNR target 50.00.
Saved best pruned model to ./models/pruned_siren_std_135n.pth

Attempting to prune with ratio: 15%
Calculating gradient-aware importance scores...
Original hidden neurons: 150, New hidden neurons: 128 (Pruning 22 neurons)
New pruned model parameters: 0.20M

--- Fine-tuning pruned model for 100 epochs ---
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:02<04:10,  2.54s/it]  2%|▏         | 2/100 [00:05<04:17,  2.62s/it]  3%|▎         | 3/100 [00:07<04:15,  2.63s/it]  4%|▍         | 4/100 [00:10<04:11,  2.62s/it]  5%|▌         | 5/100 [00:13<04:10,  2.63s/it]  6%|▌         | 6/100 [00:15<04:12,  2.68s/it]  7%|▋         | 7/100 [00:18<04:10,  2.69s/it]  8%|▊         | 8/100 [00:21<04:08,  2.70s/it]  9%|▉         | 9/100 [00:24<04:10,  2.75s/it] 10%|█         | 10/100 [00:26<04:09,  2.77s/it] 11%|█         | 11/100 [00:29<04:08,  2.79s/it] 12%|█▏        | 12/100 [00:32<04:01,  2.74s/it] 13%|█▎        | 13/100 [00:35<03:55,  2.71s/it] 14%|█▍        | 14/100 [00:37<03:50,  2.67s/it] 15%|█▌        | 15/100 [00:40<03:47,  2.68s/it] 16%|█▌        | 16/100 [00:42<03:42,  2.64s/it] 17%|█▋        | 17/100 [00:45<03:37,  2.62s/it] 18%|█▊        | 18/100 [00:48<03:34,  2.62s/it] 19%|█▉        | 19/100 [00:50<03:32,  2.62s/it] 20%|██        | 20/100 [00:53<03:32,  2.65s/it] 21%|██        | 21/100 [00:56<03:31,  2.68s/it] 22%|██▏       | 22/100 [00:58<03:23,  2.61s/it] 23%|██▎       | 23/100 [01:01<03:24,  2.66s/it] 24%|██▍       | 24/100 [01:04<03:22,  2.66s/it] 25%|██▌       | 25/100 [01:06<03:18,  2.64s/it] 26%|██▌       | 26/100 [01:09<03:17,  2.66s/it] 27%|██▋       | 27/100 [01:12<03:13,  2.66s/it] 28%|██▊       | 28/100 [01:14<03:12,  2.67s/it] 29%|██▉       | 29/100 [01:17<03:09,  2.67s/it] 30%|███       | 30/100 [01:20<03:07,  2.68s/it] 31%|███       | 31/100 [01:22<03:07,  2.72s/it] 32%|███▏      | 32/100 [01:25<03:03,  2.70s/it] 33%|███▎      | 33/100 [01:28<03:01,  2.70s/it] 34%|███▍      | 34/100 [01:30<02:56,  2.68s/it] 35%|███▌      | 35/100 [01:33<02:57,  2.72s/it] 36%|███▌      | 36/100 [01:36<02:58,  2.78s/it] 37%|███▋      | 37/100 [01:39<02:54,  2.77s/it] 38%|███▊      | 38/100 [01:42<02:48,  2.72s/it] 39%|███▉      | 39/100 [01:44<02:44,  2.69s/it] 40%|████      | 40/100 [01:47<02:37,  2.63s/it] 41%|████      | 41/100 [01:49<02:36,  2.65s/it] 42%|████▏     | 42/100 [01:52<02:33,  2.64s/it] 43%|████▎     | 43/100 [01:55<02:31,  2.66s/it] 44%|████▍     | 44/100 [01:57<02:30,  2.69s/it] 45%|████▌     | 45/100 [02:00<02:27,  2.68s/it] 46%|████▌     | 46/100 [02:03<02:22,  2.63s/it] 47%|████▋     | 47/100 [02:05<02:18,  2.62s/it] 48%|████▊     | 48/100 [02:08<02:16,  2.63s/it] 49%|████▉     | 49/100 [02:11<02:16,  2.67s/it] 50%|█████     | 50/100 [02:13<02:13,  2.68s/it] 51%|█████     | 51/100 [02:16<02:07,  2.60s/it] 52%|█████▏    | 52/100 [02:19<02:07,  2.66s/it] 53%|█████▎    | 53/100 [02:21<02:04,  2.64s/it] 54%|█████▍    | 54/100 [02:24<02:02,  2.66s/it] 55%|█████▌    | 55/100 [02:26<01:58,  2.63s/it] 56%|█████▌    | 56/100 [02:29<01:58,  2.69s/it] 57%|█████▋    | 57/100 [02:32<01:55,  2.69s/it] 58%|█████▊    | 58/100 [02:34<01:51,  2.67s/it] 59%|█████▉    | 59/100 [02:37<01:47,  2.62s/it] 60%|██████    | 60/100 [02:40<01:43,  2.60s/it] 61%|██████    | 61/100 [02:42<01:41,  2.60s/it] 62%|██████▏   | 62/100 [02:45<01:39,  2.61s/it] 63%|██████▎   | 63/100 [02:48<01:39,  2.68s/it] 64%|██████▍   | 64/100 [02:51<01:38,  2.75s/it] 65%|██████▌   | 65/100 [02:53<01:35,  2.74s/it] 66%|██████▌   | 66/100 [02:56<01:32,  2.72s/it] 67%|██████▋   | 67/100 [02:59<01:28,  2.68s/it] 68%|██████▊   | 68/100 [03:01<01:26,  2.69s/it] 69%|██████▉   | 69/100 [03:04<01:25,  2.74s/it] 70%|███████   | 70/100 [03:07<01:20,  2.68s/it] 71%|███████   | 71/100 [03:09<01:16,  2.65s/it] 72%|███████▏  | 72/100 [03:12<01:14,  2.67s/it] 73%|███████▎  | 73/100 [03:15<01:11,  2.66s/it] 74%|███████▍  | 74/100 [03:17<01:10,  2.73s/it] 75%|███████▌  | 75/100 [03:20<01:06,  2.68s/it] 76%|███████▌  | 76/100 [03:23<01:03,  2.66s/it] 77%|███████▋  | 77/100 [03:25<01:01,  2.68s/it] 78%|███████▊  | 78/100 [03:28<00:59,  2.68s/it] 79%|███████▉  | 79/100 [03:31<00:55,  2.64s/it] 80%|████████  | 80/100 [03:33<00:52,  2.64s/it] 81%|████████  | 81/100 [03:36<00:50,  2.67s/it] 82%|████████▏ | 82/100 [03:39<00:47,  2.66s/it] 83%|████████▎ | 83/100 [03:41<00:44,  2.64s/it] 84%|████████▍ | 84/100 [03:44<00:41,  2.62s/it] 85%|████████▌ | 85/100 [03:46<00:38,  2.59s/it] 86%|████████▌ | 86/100 [03:49<00:37,  2.66s/it] 87%|████████▋ | 87/100 [03:52<00:34,  2.68s/it] 88%|████████▊ | 88/100 [03:54<00:31,  2.65s/it] 89%|████████▉ | 89/100 [03:57<00:29,  2.65s/it] 90%|█████████ | 90/100 [04:00<00:26,  2.66s/it] 91%|█████████ | 91/100 [04:02<00:24,  2.67s/it] 92%|█████████▏| 92/100 [04:05<00:21,  2.65s/it] 93%|█████████▎| 93/100 [04:08<00:18,  2.64s/it] 94%|█████████▍| 94/100 [04:10<00:15,  2.64s/it] 95%|█████████▌| 95/100 [04:13<00:13,  2.64s/it] 96%|█████████▌| 96/100 [04:16<00:10,  2.66s/it] 97%|█████████▋| 97/100 [04:18<00:07,  2.66s/it] 98%|█████████▊| 98/100 [04:21<00:05,  2.65s/it] 99%|█████████▉| 99/100 [04:24<00:02,  2.67s/it]100%|██████████| 100/100 [04:26<00:00,  2.62s/it]100%|██████████| 100/100 [04:26<00:00,  2.67s/it]

Final PSNR after pruning and fine-tuning: 44.3299
Pruning failed to meet PSNR target 50.00.
Saved best pruned model to ./models/pruned_siren_std_128n.pth

Attempting to prune with ratio: 20%
Calculating gradient-aware importance scores...
Original hidden neurons: 150, New hidden neurons: 120 (Pruning 30 neurons)
New pruned model parameters: 0.17M

--- Fine-tuning pruned model for 100 epochs ---
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:02<04:15,  2.58s/it]  2%|▏         | 2/100 [00:05<04:16,  2.62s/it]  3%|▎         | 3/100 [00:07<04:19,  2.67s/it]  4%|▍         | 4/100 [00:10<04:14,  2.65s/it]  5%|▌         | 5/100 [00:13<04:16,  2.70s/it]  6%|▌         | 6/100 [00:16<04:14,  2.71s/it]  7%|▋         | 7/100 [00:19<04:19,  2.79s/it]  8%|▊         | 8/100 [00:21<04:10,  2.73s/it]  9%|▉         | 9/100 [00:24<04:10,  2.76s/it] 10%|█         | 10/100 [00:27<04:02,  2.70s/it] 11%|█         | 11/100 [00:29<03:57,  2.66s/it] 12%|█▏        | 12/100 [00:32<03:57,  2.70s/it] 13%|█▎        | 13/100 [00:35<03:54,  2.70s/it] 14%|█▍        | 14/100 [00:37<03:54,  2.72s/it] 15%|█▌        | 15/100 [00:40<03:49,  2.69s/it] 16%|█▌        | 16/100 [00:43<03:44,  2.68s/it] 17%|█▋        | 17/100 [00:45<03:44,  2.71s/it] 18%|█▊        | 18/100 [00:48<03:37,  2.66s/it] 19%|█▉        | 19/100 [00:51<03:36,  2.67s/it] 20%|██        | 20/100 [00:53<03:32,  2.66s/it] 21%|██        | 21/100 [00:56<03:29,  2.65s/it] 22%|██▏       | 22/100 [00:59<03:27,  2.66s/it] 23%|██▎       | 23/100 [01:01<03:28,  2.71s/it] 24%|██▍       | 24/100 [01:04<03:25,  2.70s/it] 25%|██▌       | 25/100 [01:07<03:24,  2.72s/it] 26%|██▌       | 26/100 [01:10<03:20,  2.71s/it] 27%|██▋       | 27/100 [01:12<03:16,  2.69s/it] 28%|██▊       | 28/100 [01:15<03:13,  2.69s/it] 29%|██▉       | 29/100 [01:18<03:12,  2.71s/it] 30%|███       | 30/100 [01:20<03:05,  2.64s/it] 31%|███       | 31/100 [01:23<03:00,  2.62s/it] 32%|███▏      | 32/100 [01:25<03:00,  2.65s/it] 33%|███▎      | 33/100 [01:28<02:55,  2.62s/it] 34%|███▍      | 34/100 [01:31<02:56,  2.68s/it] 35%|███▌      | 35/100 [01:33<02:52,  2.66s/it] 36%|███▌      | 36/100 [01:36<02:52,  2.70s/it] 37%|███▋      | 37/100 [01:39<02:50,  2.70s/it] 38%|███▊      | 38/100 [01:42<02:47,  2.69s/it] 39%|███▉      | 39/100 [01:44<02:41,  2.65s/it] 40%|████      | 40/100 [01:47<02:40,  2.68s/it] 41%|████      | 41/100 [01:50<02:37,  2.67s/it] 42%|████▏     | 42/100 [01:52<02:34,  2.67s/it] 43%|████▎     | 43/100 [01:55<02:31,  2.65s/it] 44%|████▍     | 44/100 [01:58<02:29,  2.67s/it] 45%|████▌     | 45/100 [02:00<02:26,  2.66s/it] 46%|████▌     | 46/100 [02:03<02:23,  2.66s/it] 47%|████▋     | 47/100 [02:05<02:20,  2.64s/it] 48%|████▊     | 48/100 [02:08<02:18,  2.67s/it] 49%|████▉     | 49/100 [02:11<02:15,  2.67s/it] 50%|█████     | 50/100 [02:13<02:12,  2.66s/it] 51%|█████     | 51/100 [02:16<02:10,  2.66s/it] 52%|█████▏    | 52/100 [02:19<02:07,  2.66s/it] 53%|█████▎    | 53/100 [02:21<02:05,  2.68s/it] 54%|█████▍    | 54/100 [02:24<02:02,  2.67s/it] 55%|█████▌    | 55/100 [02:27<02:01,  2.71s/it] 56%|█████▌    | 56/100 [02:30<01:58,  2.70s/it] 57%|█████▋    | 57/100 [02:32<01:56,  2.70s/it] 58%|█████▊    | 58/100 [02:35<01:51,  2.66s/it] 59%|█████▉    | 59/100 [02:38<01:50,  2.70s/it] 60%|██████    | 60/100 [02:40<01:46,  2.66s/it] 61%|██████    | 61/100 [02:43<01:44,  2.67s/it] 62%|██████▏   | 62/100 [02:45<01:39,  2.63s/it] 63%|██████▎   | 63/100 [02:48<01:39,  2.69s/it] 64%|██████▍   | 64/100 [02:51<01:34,  2.64s/it] 65%|██████▌   | 65/100 [02:53<01:32,  2.65s/it] 66%|██████▌   | 66/100 [02:56<01:29,  2.63s/it] 67%|██████▋   | 67/100 [02:59<01:27,  2.66s/it] 68%|██████▊   | 68/100 [03:01<01:25,  2.66s/it] 69%|██████▉   | 69/100 [03:04<01:23,  2.70s/it] 70%|███████   | 70/100 [03:07<01:20,  2.69s/it] 71%|███████   | 71/100 [03:10<01:18,  2.70s/it] 72%|███████▏  | 72/100 [03:12<01:14,  2.65s/it] 73%|███████▎  | 73/100 [03:15<01:11,  2.64s/it] 74%|███████▍  | 74/100 [03:18<01:10,  2.69s/it] 75%|███████▌  | 75/100 [03:20<01:08,  2.73s/it] 76%|███████▌  | 76/100 [03:23<01:04,  2.70s/it] 77%|███████▋  | 77/100 [03:26<01:01,  2.68s/it] 78%|███████▊  | 78/100 [03:28<00:58,  2.66s/it] 79%|███████▉  | 79/100 [03:31<00:56,  2.68s/it] 80%|████████  | 80/100 [03:34<00:52,  2.63s/it] 81%|████████  | 81/100 [03:36<00:50,  2.68s/it] 82%|████████▏ | 82/100 [03:39<00:47,  2.65s/it] 83%|████████▎ | 83/100 [03:42<00:45,  2.66s/it] 84%|████████▍ | 84/100 [03:44<00:42,  2.66s/it] 85%|████████▌ | 85/100 [03:47<00:40,  2.72s/it] 86%|████████▌ | 86/100 [03:50<00:38,  2.75s/it] 87%|████████▋ | 87/100 [03:53<00:35,  2.73s/it] 88%|████████▊ | 88/100 [03:55<00:32,  2.75s/it] 89%|████████▉ | 89/100 [03:58<00:29,  2.72s/it] 90%|█████████ | 90/100 [04:01<00:27,  2.73s/it] 91%|█████████ | 91/100 [04:04<00:24,  2.76s/it] 92%|█████████▏| 92/100 [04:06<00:21,  2.75s/it] 93%|█████████▎| 93/100 [04:09<00:19,  2.76s/it] 94%|█████████▍| 94/100 [04:12<00:16,  2.72s/it] 95%|█████████▌| 95/100 [04:14<00:13,  2.71s/it] 96%|█████████▌| 96/100 [04:17<00:10,  2.70s/it] 97%|█████████▋| 97/100 [04:20<00:08,  2.68s/it] 98%|█████████▊| 98/100 [04:22<00:05,  2.65s/it] 99%|█████████▉| 99/100 [04:25<00:02,  2.67s/it]100%|██████████| 100/100 [04:28<00:00,  2.67s/it]100%|██████████| 100/100 [04:28<00:00,  2.68s/it]

Final PSNR after pruning and fine-tuning: 42.4216
Pruning failed to meet PSNR target 50.00.
Saved best pruned model to ./models/pruned_siren_std_120n.pth

Attempting to prune with ratio: 25%
Calculating gradient-aware importance scores...
Original hidden neurons: 150, New hidden neurons: 113 (Pruning 37 neurons)
New pruned model parameters: 0.16M

--- Fine-tuning pruned model for 100 epochs ---
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:02<04:23,  2.66s/it]  2%|▏         | 2/100 [00:05<04:12,  2.58s/it]  3%|▎         | 3/100 [00:07<04:15,  2.63s/it]  4%|▍         | 4/100 [00:10<04:15,  2.66s/it]  5%|▌         | 5/100 [00:13<04:08,  2.61s/it]  6%|▌         | 6/100 [00:15<04:07,  2.63s/it]  7%|▋         | 7/100 [00:18<04:07,  2.66s/it]  8%|▊         | 8/100 [00:21<04:04,  2.66s/it]  9%|▉         | 9/100 [00:23<03:58,  2.62s/it] 10%|█         | 10/100 [00:26<03:56,  2.63s/it] 11%|█         | 11/100 [00:28<03:54,  2.63s/it] 12%|█▏        | 12/100 [00:31<03:52,  2.65s/it] 13%|█▎        | 13/100 [00:34<03:51,  2.66s/it] 14%|█▍        | 14/100 [00:36<03:48,  2.66s/it] 15%|█▌        | 15/100 [00:39<03:40,  2.59s/it] 16%|█▌        | 16/100 [00:42<03:40,  2.63s/it] 17%|█▋        | 17/100 [00:44<03:40,  2.65s/it] 18%|█▊        | 18/100 [00:47<03:43,  2.72s/it] 19%|█▉        | 19/100 [00:50<03:37,  2.69s/it] 20%|██        | 20/100 [00:52<03:33,  2.67s/it] 21%|██        | 21/100 [00:55<03:31,  2.67s/it] 22%|██▏       | 22/100 [00:58<03:27,  2.66s/it] 23%|██▎       | 23/100 [01:00<03:21,  2.61s/it] 24%|██▍       | 24/100 [01:03<03:18,  2.61s/it] 25%|██▌       | 25/100 [01:06<03:15,  2.61s/it] 26%|██▌       | 26/100 [01:08<03:10,  2.57s/it] 27%|██▋       | 27/100 [01:11<03:09,  2.59s/it] 28%|██▊       | 28/100 [01:13<03:08,  2.62s/it] 29%|██▉       | 29/100 [01:16<03:05,  2.61s/it] 30%|███       | 30/100 [01:19<03:03,  2.63s/it] 31%|███       | 31/100 [01:21<03:04,  2.67s/it] 32%|███▏      | 32/100 [01:24<03:00,  2.66s/it] 33%|███▎      | 33/100 [01:27<02:58,  2.66s/it] 34%|███▍      | 34/100 [01:29<02:53,  2.62s/it] 35%|███▌      | 35/100 [01:32<02:48,  2.60s/it] 36%|███▌      | 36/100 [01:34<02:43,  2.55s/it] 37%|███▋      | 37/100 [01:37<02:42,  2.58s/it] 38%|███▊      | 38/100 [01:39<02:41,  2.61s/it] 39%|███▉      | 39/100 [01:42<02:38,  2.60s/it] 40%|████      | 40/100 [01:45<02:34,  2.57s/it] 41%|████      | 41/100 [01:47<02:34,  2.62s/it] 42%|████▏     | 42/100 [01:50<02:36,  2.70s/it] 43%|████▎     | 43/100 [01:53<02:31,  2.66s/it] 44%|████▍     | 44/100 [01:55<02:27,  2.63s/it] 45%|████▌     | 45/100 [01:58<02:25,  2.65s/it] 46%|████▌     | 46/100 [02:01<02:21,  2.62s/it] 47%|████▋     | 47/100 [02:03<02:18,  2.60s/it] 48%|████▊     | 48/100 [02:06<02:15,  2.61s/it] 49%|████▉     | 49/100 [02:09<02:18,  2.72s/it] 50%|█████     | 50/100 [02:11<02:15,  2.72s/it] 51%|█████     | 51/100 [02:14<02:15,  2.76s/it] 52%|█████▏    | 52/100 [02:17<02:11,  2.74s/it] 53%|█████▎    | 53/100 [02:20<02:06,  2.69s/it] 54%|█████▍    | 54/100 [02:22<02:05,  2.72s/it] 55%|█████▌    | 55/100 [02:25<02:03,  2.75s/it] 56%|█████▌    | 56/100 [02:28<02:00,  2.74s/it] 57%|█████▋    | 57/100 [02:31<01:57,  2.73s/it] 58%|█████▊    | 58/100 [02:33<01:52,  2.68s/it] 59%|█████▉    | 59/100 [02:36<01:48,  2.65s/it] 60%|██████    | 60/100 [02:38<01:47,  2.68s/it] 61%|██████    | 61/100 [02:41<01:45,  2.69s/it] 62%|██████▏   | 62/100 [02:44<01:41,  2.68s/it] 63%|██████▎   | 63/100 [02:47<01:39,  2.69s/it] 64%|██████▍   | 64/100 [02:49<01:35,  2.65s/it] 65%|██████▌   | 65/100 [02:52<01:31,  2.62s/it] 66%|██████▌   | 66/100 [02:54<01:30,  2.67s/it] 67%|██████▋   | 67/100 [02:57<01:27,  2.65s/it] 68%|██████▊   | 68/100 [03:00<01:23,  2.59s/it] 69%|██████▉   | 69/100 [03:02<01:20,  2.59s/it] 70%|███████   | 70/100 [03:05<01:17,  2.58s/it] 71%|███████   | 71/100 [03:07<01:15,  2.60s/it] 72%|███████▏  | 72/100 [03:10<01:13,  2.63s/it] 73%|███████▎  | 73/100 [03:13<01:10,  2.62s/it] 74%|███████▍  | 74/100 [03:15<01:08,  2.63s/it] 75%|███████▌  | 75/100 [03:18<01:04,  2.58s/it] 76%|███████▌  | 76/100 [03:20<01:03,  2.63s/it] 77%|███████▋  | 77/100 [03:23<01:00,  2.62s/it] 78%|███████▊  | 78/100 [03:26<00:58,  2.68s/it] 79%|███████▉  | 79/100 [03:29<00:56,  2.67s/it] 80%|████████  | 80/100 [03:31<00:53,  2.69s/it] 81%|████████  | 81/100 [03:34<00:51,  2.69s/it] 82%|████████▏ | 82/100 [03:37<00:48,  2.68s/it] 83%|████████▎ | 83/100 [03:39<00:45,  2.67s/it] 84%|████████▍ | 84/100 [03:42<00:42,  2.64s/it] 85%|████████▌ | 85/100 [03:45<00:39,  2.66s/it] 86%|████████▌ | 86/100 [03:47<00:37,  2.65s/it] 87%|████████▋ | 87/100 [03:50<00:34,  2.67s/it] 88%|████████▊ | 88/100 [03:53<00:32,  2.70s/it] 89%|████████▉ | 89/100 [03:55<00:29,  2.72s/it] 90%|█████████ | 90/100 [03:58<00:26,  2.67s/it] 91%|█████████ | 91/100 [04:01<00:23,  2.65s/it] 92%|█████████▏| 92/100 [04:03<00:21,  2.63s/it] 93%|█████████▎| 93/100 [04:06<00:18,  2.66s/it] 94%|█████████▍| 94/100 [04:09<00:15,  2.64s/it] 95%|█████████▌| 95/100 [04:11<00:13,  2.69s/it] 96%|█████████▌| 96/100 [04:14<00:10,  2.64s/it] 97%|█████████▋| 97/100 [04:17<00:07,  2.66s/it] 98%|█████████▊| 98/100 [04:19<00:05,  2.65s/it] 99%|█████████▉| 99/100 [04:22<00:02,  2.63s/it]100%|██████████| 100/100 [04:24<00:00,  2.61s/it]100%|██████████| 100/100 [04:24<00:00,  2.65s/it]

Final PSNR after pruning and fine-tuning: 40.9053
Pruning failed to meet PSNR target 50.00.
Saved best pruned model to ./models/pruned_siren_std_113n.pth

Attempting to prune with ratio: 30%
Calculating gradient-aware importance scores...
Original hidden neurons: 150, New hidden neurons: 105 (Pruning 45 neurons)
New pruned model parameters: 0.13M

--- Fine-tuning pruned model for 100 epochs ---
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:02<04:19,  2.62s/it]  2%|▏         | 2/100 [00:05<04:19,  2.65s/it]  3%|▎         | 3/100 [00:08<04:20,  2.69s/it]  4%|▍         | 4/100 [00:10<04:13,  2.64s/it]  5%|▌         | 5/100 [00:13<04:13,  2.67s/it]  6%|▌         | 6/100 [00:15<04:08,  2.64s/it]  7%|▋         | 7/100 [00:18<04:03,  2.62s/it]  8%|▊         | 8/100 [00:21<03:58,  2.59s/it]  9%|▉         | 9/100 [00:23<03:53,  2.56s/it] 10%|█         | 10/100 [00:26<03:51,  2.57s/it] 11%|█         | 11/100 [00:28<03:52,  2.61s/it] 12%|█▏        | 12/100 [00:31<03:46,  2.58s/it] 13%|█▎        | 13/100 [00:33<03:47,  2.61s/it] 14%|█▍        | 14/100 [00:36<03:47,  2.65s/it] 15%|█▌        | 15/100 [00:39<03:44,  2.64s/it] 16%|█▌        | 16/100 [00:41<03:39,  2.62s/it] 17%|█▋        | 17/100 [00:44<03:34,  2.59s/it] 18%|█▊        | 18/100 [00:47<03:33,  2.61s/it] 19%|█▉        | 19/100 [00:49<03:28,  2.57s/it] 20%|██        | 20/100 [00:52<03:24,  2.56s/it] 21%|██        | 21/100 [00:54<03:22,  2.57s/it] 22%|██▏       | 22/100 [00:57<03:21,  2.58s/it] 23%|██▎       | 23/100 [00:59<03:17,  2.56s/it] 24%|██▍       | 24/100 [01:02<03:17,  2.60s/it] 25%|██▌       | 25/100 [01:04<03:12,  2.56s/it] 26%|██▌       | 26/100 [01:07<03:13,  2.61s/it] 27%|██▋       | 27/100 [01:10<03:11,  2.63s/it] 28%|██▊       | 28/100 [01:13<03:11,  2.66s/it] 29%|██▉       | 29/100 [01:15<03:08,  2.66s/it] 30%|███       | 30/100 [01:18<03:06,  2.67s/it] 31%|███       | 31/100 [01:21<03:04,  2.68s/it] 32%|███▏      | 32/100 [01:23<03:00,  2.65s/it] 33%|███▎      | 33/100 [01:26<02:55,  2.63s/it] 34%|███▍      | 34/100 [01:28<02:54,  2.64s/it] 35%|███▌      | 35/100 [01:31<02:49,  2.60s/it] 36%|███▌      | 36/100 [01:34<02:47,  2.62s/it] 37%|███▋      | 37/100 [01:36<02:49,  2.69s/it] 38%|███▊      | 38/100 [01:39<02:46,  2.68s/it] 39%|███▉      | 39/100 [01:42<02:45,  2.71s/it] 40%|████      | 40/100 [01:45<02:41,  2.68s/it] 41%|████      | 41/100 [01:47<02:40,  2.73s/it] 42%|████▏     | 42/100 [01:50<02:34,  2.66s/it] 43%|████▎     | 43/100 [01:53<02:31,  2.66s/it] 44%|████▍     | 44/100 [01:55<02:27,  2.64s/it] 45%|████▌     | 45/100 [01:58<02:25,  2.65s/it] 46%|████▌     | 46/100 [02:00<02:21,  2.62s/it] 47%|████▋     | 47/100 [02:03<02:16,  2.58s/it] 48%|████▊     | 48/100 [02:06<02:15,  2.61s/it] 49%|████▉     | 49/100 [02:08<02:17,  2.70s/it] 50%|█████     | 50/100 [02:11<02:11,  2.62s/it] 51%|█████     | 51/100 [02:14<02:09,  2.64s/it] 52%|█████▏    | 52/100 [02:16<02:05,  2.62s/it] 53%|█████▎    | 53/100 [02:19<02:04,  2.65s/it] 54%|█████▍    | 54/100 [02:21<02:00,  2.62s/it] 55%|█████▌    | 55/100 [02:24<01:58,  2.63s/it] 56%|█████▌    | 56/100 [02:27<01:55,  2.61s/it] 57%|█████▋    | 57/100 [02:29<01:52,  2.61s/it] 58%|█████▊    | 58/100 [02:32<01:51,  2.65s/it] 59%|█████▉    | 59/100 [02:35<01:51,  2.71s/it] 60%|██████    | 60/100 [02:37<01:47,  2.69s/it] 61%|██████    | 61/100 [02:40<01:47,  2.76s/it] 62%|██████▏   | 62/100 [02:43<01:43,  2.72s/it] 63%|██████▎   | 63/100 [02:46<01:40,  2.70s/it] 64%|██████▍   | 64/100 [02:48<01:36,  2.67s/it] 65%|██████▌   | 65/100 [02:51<01:32,  2.65s/it] 66%|██████▌   | 66/100 [02:54<01:30,  2.65s/it] 67%|██████▋   | 67/100 [02:56<01:27,  2.65s/it] 68%|██████▊   | 68/100 [02:59<01:27,  2.72s/it] 69%|██████▉   | 69/100 [03:02<01:24,  2.73s/it] 70%|███████   | 70/100 [03:05<01:21,  2.71s/it] 71%|███████   | 71/100 [03:07<01:17,  2.69s/it] 72%|███████▏  | 72/100 [03:10<01:16,  2.74s/it] 73%|███████▎  | 73/100 [03:13<01:12,  2.68s/it] 74%|███████▍  | 74/100 [03:15<01:08,  2.65s/it] 75%|███████▌  | 75/100 [03:18<01:04,  2.59s/it] 76%|███████▌  | 76/100 [03:20<01:02,  2.62s/it] 77%|███████▋  | 77/100 [03:23<01:00,  2.62s/it] 78%|███████▊  | 78/100 [03:26<00:58,  2.67s/it] 79%|███████▉  | 79/100 [03:28<00:55,  2.63s/it] 80%|████████  | 80/100 [03:31<00:52,  2.63s/it] 81%|████████  | 81/100 [03:33<00:49,  2.59s/it] 82%|████████▏ | 82/100 [03:36<00:46,  2.61s/it] 83%|████████▎ | 83/100 [03:39<00:44,  2.62s/it] 84%|████████▍ | 84/100 [03:41<00:41,  2.60s/it] 85%|████████▌ | 85/100 [03:44<00:39,  2.62s/it] 86%|████████▌ | 86/100 [03:47<00:37,  2.66s/it] 87%|████████▋ | 87/100 [03:49<00:34,  2.66s/it] 88%|████████▊ | 88/100 [03:52<00:32,  2.74s/it] 89%|████████▉ | 89/100 [03:55<00:29,  2.71s/it] 90%|█████████ | 90/100 [03:57<00:26,  2.67s/it] 91%|█████████ | 91/100 [04:00<00:24,  2.68s/it] 92%|█████████▏| 92/100 [04:03<00:21,  2.71s/it] 93%|█████████▎| 93/100 [04:06<00:18,  2.70s/it] 94%|█████████▍| 94/100 [04:08<00:15,  2.66s/it] 95%|█████████▌| 95/100 [04:11<00:13,  2.67s/it] 96%|█████████▌| 96/100 [04:13<00:10,  2.65s/it] 97%|█████████▋| 97/100 [04:16<00:07,  2.65s/it] 98%|█████████▊| 98/100 [04:19<00:05,  2.60s/it] 99%|█████████▉| 99/100 [04:21<00:02,  2.60s/it]100%|██████████| 100/100 [04:24<00:00,  2.61s/it]100%|██████████| 100/100 [04:24<00:00,  2.64s/it]

Final PSNR after pruning and fine-tuning: 39.1282
Pruning failed to meet PSNR target 50.00.
Saved best pruned model to ./models/pruned_siren_std_105n.pth

--- Pruning Process Complete ---
Best pruned model found with 150 neurons and PSNR: 61.88
Original model parameters: 272551
Final pruned model parameters: 134086
Total parameter reduction: 50.80%
